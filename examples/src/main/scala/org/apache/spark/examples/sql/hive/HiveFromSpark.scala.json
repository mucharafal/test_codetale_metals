[{
  "comments": [{
    "author": {
      "login": "andrewor14"
    },
    "body": "github won't let me comment down there, but in L78 please replace `sc.stop` with `spark.stop`\n",
    "commit": "5e464ad766535061d568bc10d6904d1c96857ef1",
    "createdAt": "2016-05-05T17:21:38Z",
    "diffHunk": "@@ -36,13 +36,14 @@ object HiveFromSpark {\n \n   def main(args: Array[String]) {\n     val sparkConf = new SparkConf().setAppName(\"HiveFromSpark\")\n-    val sc = new SparkContext(sparkConf)\n \n     // A hive context adds support for finding tables in the MetaStore and writing queries\n     // using HiveQL. Users who do not have an existing Hive deployment can still create a\n     // HiveContext. When not configured by the hive-site.xml, the context automatically\n     // creates metastore_db and warehouse in the current directory.\n-    val sparkSession = SparkSession.withHiveSupport(sc)\n+    val sparkSession = SparkSession.builder.config(sparkConf).enableHiveSupport().getOrCreate()\n+    val sc = sparkSession.sparkContext"
  }],
  "prId": 12851
}]