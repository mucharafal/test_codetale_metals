[{
  "comments": [{
    "author": {
      "login": "marmbrus"
    },
    "body": "Is this just `Literal.create(null, a.dataType)`?\n",
    "commit": "ad52183193aee624952f961f831a0c569818b0e2",
    "createdAt": "2015-11-17T19:27:27Z",
    "diffHunk": "@@ -72,11 +78,17 @@ class PostgresIntegrationSuite extends DockerJDBCIntegrationSuite {\n     assert(rows(0).getBoolean(7) == true)\n     assert(rows(0).getString(8) == \"172.16.0.42\")\n     assert(rows(0).getString(9) == \"192.168.0.0/16\")\n+    assert(rows(0).getSeq(10) == Seq(1, 2))\n+    assert(rows(0).getSeq(11) == Seq(\"a\", null, \"b\"))\n   }\n \n   test(\"Basic write test\") {\n     val df = sqlContext.read.jdbc(jdbcUrl, \"bar\", new Properties)\n-    df.write.jdbc(jdbcUrl, \"public.barcopy\", new Properties)\n     // Test only that it doesn't crash.\n+    df.write.jdbc(jdbcUrl, \"public.barcopy\", new Properties)\n+    // Test write null values.\n+    df.select(df.queryExecution.analyzed.output.map { a =>\n+      Column(If(Literal(true), Literal(null), a)).as(a.name)",
    "line": 72
  }, {
    "author": {
      "login": "cloud-fan"
    },
    "body": "ah yea, we can simply this.\n",
    "commit": "ad52183193aee624952f961f831a0c569818b0e2",
    "createdAt": "2015-11-18T00:20:15Z",
    "diffHunk": "@@ -72,11 +78,17 @@ class PostgresIntegrationSuite extends DockerJDBCIntegrationSuite {\n     assert(rows(0).getBoolean(7) == true)\n     assert(rows(0).getString(8) == \"172.16.0.42\")\n     assert(rows(0).getString(9) == \"192.168.0.0/16\")\n+    assert(rows(0).getSeq(10) == Seq(1, 2))\n+    assert(rows(0).getSeq(11) == Seq(\"a\", null, \"b\"))\n   }\n \n   test(\"Basic write test\") {\n     val df = sqlContext.read.jdbc(jdbcUrl, \"bar\", new Properties)\n-    df.write.jdbc(jdbcUrl, \"public.barcopy\", new Properties)\n     // Test only that it doesn't crash.\n+    df.write.jdbc(jdbcUrl, \"public.barcopy\", new Properties)\n+    // Test write null values.\n+    df.select(df.queryExecution.analyzed.output.map { a =>\n+      Column(If(Literal(true), Literal(null), a)).as(a.name)",
    "line": 72
  }],
  "prId": 9662
}]