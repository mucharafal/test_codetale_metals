[{
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "nit: we can just collect and compare the value without `toPandas` but not a bit deal.",
    "commit": "2c6cd2013d0a737b7ea0d4a338082489a833790d",
    "createdAt": "2019-08-13T15:34:18Z",
    "diffHunk": "@@ -474,6 +474,21 @@ def test_grouped_with_empty_partition(self):\n         result = df.groupBy('id').agg(f(df['x']).alias('sum')).collect()\n         self.assertEqual(result, expected)\n \n+    def test_grouped_without_group_by_clause(self):\n+        @pandas_udf('double', PandasUDFType.GROUPED_AGG)\n+        def max_udf(v):\n+            return v.max()\n+\n+        df = self.spark.range(0, 100)\n+        self.spark.udf.register('max_udf', max_udf)\n+\n+        with self.tempView(\"table\"):\n+            df.createTempView('table')\n+\n+            agg1 = df.agg(max_udf(df['id']))\n+            agg2 = self.spark.sql(\"select max_udf(id) from table\")\n+            assert_frame_equal(agg1.toPandas(), agg2.toPandas())",
    "line": 17
  }],
  "prId": 25352
}]