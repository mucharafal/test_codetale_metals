[{
  "comments": [{
    "author": {
      "login": "machielg"
    },
    "body": "I was expecting the schemaExpected to be string, not a result of calling the method under test.",
    "commit": "e0cc923d5f3f4efd5cacf3d0bf030dd5426eda13",
    "createdAt": "2019-11-12T11:02:16Z",
    "diffHunk": "@@ -713,6 +713,27 @@ def assertCollectSuccess(typecode, value):\n                 a = array.array(t)\n                 self.spark.createDataFrame([Row(myarray=a)]).collect()\n \n+    def test_to_ddl(self):\n+        schemaExpected=StructType([\n+            StructField(\"string\",StringType(),True),\n+            StructField(\"long\",LongType(),True),\n+            StructField(\"decimal\",DecimalType(10,2),True),\n+            StructField(\"timestamp\",TimestampType(),True),\n+            StructField(\"array1\",ArrayType(StructType([\n+                StructField(\"item1\",LongType(),True),\n+                StructField(\"array2\",ArrayType(StructType([\n+                    StructField(\"item2\",LongType(),True),\n+                    StructField(\"array2\",ArrayType(StructType([\n+                        StructField(\"item3\",LongType(),True),\n+                        StructField(\"item4\",StringType(),True),\n+                    ]),True),True),\n+                ]),True),True),\n+            ]),True),True)\n+        ])\n+        ddl=schemaExpected.toDDL()\n+        schemaActual=_parse_datatype_string(ddl)\n+        self.assertEqual(schemaExpected, schemaActual)",
    "line": 23
  }],
  "prId": 25496
}]