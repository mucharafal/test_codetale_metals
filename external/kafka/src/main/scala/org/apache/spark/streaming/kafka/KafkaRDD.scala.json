[{
  "comments": [{
    "author": {
      "login": "jerryshao"
    },
    "body": "As I remembered, return `None` will lead to errors for some streaming operations, you'd better return a empty RDD. Also I think this change cannot be compilable, right? Since you changed the return value of KafkaRDD, whereas you didn't change the related APIs in `KafkaUtils`. \n",
    "commit": "4e4764d0a007160ae93a9c5b5910043ab406c02b",
    "createdAt": "2015-08-18T01:17:45Z",
    "diffHunk": "@@ -253,16 +253,19 @@ object KafkaRDD {\n       fromOffsets: Map[TopicAndPartition, Long],\n       untilOffsets: Map[TopicAndPartition, LeaderOffset],\n       messageHandler: MessageAndMetadata[K, V] => R\n-    ): KafkaRDD[K, V, U, T, R] = {\n+    ): Option[KafkaRDD[K, V, U, T, R]] = {\n     val leaders = untilOffsets.map { case (tp, lo) =>\n         tp -> (lo.host, lo.port)\n     }.toMap\n \n-    val offsetRanges = fromOffsets.map { case (tp, fo) =>\n-        val uo = untilOffsets(tp)\n-        OffsetRange(tp.topic, tp.partition, fo, uo.offset)\n-    }.toArray\n+    val offsetRanges = fromOffsets.map { case (tp, fo) => (tp, fo, untilOffsets(tp).offset) }\n+      .filter {case (_, fo, uo) => fo < uo }\n+      .map { case (tp, fo, uo) => OffsetRange(tp, fo, uo) }.toArray\n \n-    new KafkaRDD[K, V, U, T, R](sc, kafkaParams, offsetRanges, leaders, messageHandler)\n+    if (offsetRanges.isEmpty) {\n+      None",
    "line": 20
  }],
  "prId": 8237
}]