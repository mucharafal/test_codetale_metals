[{
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "Better to name it as \"useReliableReceiver\"\n",
    "commit": "5461f1c43b0e98aa7b583f14569eefd833b19df0",
    "createdAt": "2014-11-11T02:21:29Z",
    "diffHunk": "@@ -53,112 +46,17 @@ class KafkaInputDStream[\n     @transient ssc_ : StreamingContext,\n     kafkaParams: Map[String, String],\n     topics: Map[String, Int],\n+    reliableReceiveEnabled: Boolean,"
  }],
  "prId": 2991
}, {
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "If you make the ReliableKafkaReceiver extend Receiver[(K, V)], then this `asInstanceOf` is not necessary.\n",
    "commit": "5461f1c43b0e98aa7b583f14569eefd833b19df0",
    "createdAt": "2014-11-12T01:46:30Z",
    "diffHunk": "@@ -53,112 +46,17 @@ class KafkaInputDStream[\n     @transient ssc_ : StreamingContext,\n     kafkaParams: Map[String, String],\n     topics: Map[String, Int],\n+    reliableReceiveEnabled: Boolean,\n     storageLevel: StorageLevel\n   ) extends ReceiverInputDStream[(K, V)](ssc_) with Logging {\n \n   def getReceiver(): Receiver[(K, V)] = {\n-    new KafkaReceiver[K, V, U, T](kafkaParams, topics, storageLevel)\n+    if (!reliableReceiveEnabled) {\n+      new KafkaReceiver[K, V, U, T](kafkaParams, topics, storageLevel)\n+        .asInstanceOf[Receiver[(K, V)]]\n+    } else {\n+      new ReliableKafkaReceiver[K, V, U, T](kafkaParams, topics, storageLevel)\n         .asInstanceOf[Receiver[(K, V)]]"
  }],
  "prId": 2991
}]