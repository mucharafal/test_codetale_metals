[{
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "`currentNumRecords` sounds like \"current number of records to be processed\". That is not what this is. Also the way you are calculating this is not very intuitive. A better way would be \n\n```\nrdd.offsetRanges.map(range => range.untilOffset - range.fromOffset).sum\n```\n\nThat is, map each range to the number of record and add them.\n",
    "commit": "b0b506c363968b1f0ef27d71986618bb514f0f3c",
    "createdAt": "2015-05-05T02:34:28Z",
    "diffHunk": "@@ -117,6 +116,12 @@ class DirectKafkaInputDStream[\n     val rdd = KafkaRDD[K, V, U, T, R](\n       context.sparkContext, kafkaParams, currentOffsets, untilOffsets, messageHandler)\n \n+    // Report the number of records of the batch interval to InputInfoTracker.\n+    val currentNumRecords = currentOffsets.map(_._2).sum"
  }],
  "prId": 5879
}]