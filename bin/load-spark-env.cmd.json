[{
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "@gengliangwang this was the update I was talking about to the .cmd script. You can follow up with this change, uncommented, if you like, separately from this PR.",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-20T22:49:18Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12\n+rem if [%SPARK_SCALA_VERSION%] == [] (",
    "line": 39
  }],
  "prId": 23098
}, {
  "comments": [{
    "author": {
      "login": "gengliangwang"
    },
    "body": "I am not familiar with .cmd script. Should we keep the quote here, `\"2.12\"`?",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-21T09:50:59Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Nope, the string became as is including quotes if it's quoted on Windows ... haha odd (to me).",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-21T10:04:53Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "Oh I see, so we shouldn't add quotes to values like SPARK_ENV_CMD above, but use them in if conditions, call, etc?",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-21T14:54:48Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Yea, I think we shouldn't quote if I remember this correctly. Let me test and get back to you today or tomorrow. I'll have to fly to Korea for my one week vacation from tomorrow :D.",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-22T00:21:03Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "but at least that's what I remember when I tested https://github.com/apache/spark/blob/master/bin/spark-sql2.cmd#L23 line.",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-22T00:23:46Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "For `call`, it's a bit different (it can be quoted IIRC)(https://ss64.com/nt/call.html)",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-22T00:25:24Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Here, I ran some of simple commands:\r\n\r\n```cmd\r\nC:\\>set A=aa\r\n\r\nC:\\>ECHO %A%\r\naa\r\n\r\nC:\\>set A=\"aa\"\r\n\r\nC:\\>ECHO %A%\r\n\"aa\"\r\n\r\nC:\\>call \"python.exe\"\r\nPython 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:54:40) [MSC v.1900 64 bit (AMD64)] on win32\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> exit(0)\r\n\r\nC:\\>call python.exe\r\nPython 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:54:40) [MSC v.1900 64 bit (AMD64)] on win32\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> exit(0)\r\n```",
    "commit": "7372853a57d7f166d2104d3ac0b13ccf41715dd7",
    "createdAt": "2018-11-22T23:54:35Z",
    "diffHunk": "@@ -21,37 +21,42 @@ rem This script loads spark-env.cmd if it exists, and ensures it is only loaded\n rem spark-env.cmd is loaded from SPARK_CONF_DIR if set, or within the current directory's\n rem conf\\ subdirectory.\n \n+set SPARK_ENV_CMD=\"spark-env.cmd\"\n if [%SPARK_ENV_LOADED%] == [] (\n   set SPARK_ENV_LOADED=1\n \n   if [%SPARK_CONF_DIR%] == [] (\n     set SPARK_CONF_DIR=%~dp0..\\conf\n   )\n \n-  call :LoadSparkEnv\n+  set SPARK_ENV_CMD=\"%SPARK_CONF_DIR%/%SPARK_ENV_CMD%\"\n+  if exist \"%SPARK_ENV_CMD%\" (\n+    call \"%SPARK_ENV_CMD%\"\n+  )\n )\n \n rem Setting SPARK_SCALA_VERSION if not already set.\n \n-set ASSEMBLY_DIR2=\"%SPARK_HOME%\\assembly\\target\\scala-2.11\"\n-set ASSEMBLY_DIR1=\"%SPARK_HOME%\\assembly\\target\\scala-2.12\"\n-\n-if [%SPARK_SCALA_VERSION%] == [] (\n-\n-  if exist %ASSEMBLY_DIR2% if exist %ASSEMBLY_DIR1% (\n-    echo \"Presence of build for multiple Scala versions detected.\"\n-    echo \"Either clean one of them or, set SPARK_SCALA_VERSION in spark-env.cmd.\"\n-    exit 1\n-  )\n-  if exist %ASSEMBLY_DIR2% (\n-    set SPARK_SCALA_VERSION=2.11\n-  ) else (\n-    set SPARK_SCALA_VERSION=2.12\n-  )\n-)\n+rem TODO: revisit for Scala 2.13 support\n+set SPARK_SCALA_VERSION=2.12",
    "line": 38
  }],
  "prId": 23098
}]