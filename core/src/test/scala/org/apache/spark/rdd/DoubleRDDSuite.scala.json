[{
  "comments": [{
    "author": {
      "login": "mengxr"
    },
    "body": "We should tolerate small numerical difference for the middle splits, e.g., `16.33333333333335` is also valid as the second split, but assert exactly equal on the boundaries (6 and 99 in this case).\n",
    "commit": "a76bbf67dbe562e32ddcfa21f53b4914d1f520ff",
    "createdAt": "2014-08-16T22:45:48Z",
    "diffHunk": "@@ -245,6 +245,19 @@ class DoubleRDDSuite extends FunSuite with SharedSparkContext {\n     assert(histogramBuckets === expectedHistogramBuckets)\n   }\n \n+  test(\"WorksWithoutBucketsWithIrrationalBucketEdges\") {\n+    // Verify the case of buckets with irrational edges. See #SPARK-2862.\n+    val rdd = sc.parallelize(6 to 99)\n+    val (histogramBuckets, histogramResults) = rdd.histogram(9)\n+    val expectedHistogramResults =\n+      Array(11, 10, 11, 10, 10, 11, 10, 10, 11)\n+    val expectedHistogramBuckets =\n+      Array(6.0, 16.333333333333336, 26.666666666666668, 37.0, 47.333333333333336,\n+            57.666666666666664, 68.0, 78.33333333333333, 88.66666666666667, 99.0)\n+    assert(histogramResults === expectedHistogramResults)\n+    assert(histogramBuckets === expectedHistogramBuckets)"
  }],
  "prId": 1787
}]