[{
  "comments": [{
    "author": {
      "login": "felixcheung"
    },
    "body": "we might not be able to set this here - we need to have it working with multiple versions of scala",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-26T20:17:27Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_SCALA_VERSION\" -> \"2.11\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "In this case it's just a name, I could change it in order to make it clear!",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-27T08:34:39Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_SCALA_VERSION\" -> \"2.11\")"
  }],
  "prId": 19793
}, {
  "comments": [{
    "author": {
      "login": "susanxhuynh"
    },
    "body": "There should be a check at the end of this test to make sure these fields show up in the `newMessage` object. (around L.125)",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-27T23:14:16Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "felixcheung"
    },
    "body": "and probably don't want to set SPARK_HOME either? :)\r\n",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-28T07:42:24Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "@felixcheung okay done :)",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-28T07:48:19Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "@susanxhuynh I've checked what you said but those variables are overwritten below, so I can't actually check it, right?",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-28T07:51:24Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "susanxhuynh"
    },
    "body": "@Gschiavon You're right, I didn't see those variables were already set below. But, I do have a question now about whether these fields are optional or not. In the original test, (L.93), there's a comment about \"optional fields\", and the app args and env vars are tested there (L.105-106). Since this test was added with Standalone mode in mind, I wonder if these fields are considered optional there? There's no documentation as you said so we can't know for sure. I just want to make sure the extra validation doesn't break any existing applications (in Standalone cluster mode).",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-28T15:41:32Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "@susanxhuynh Yes we have to make sure we don't break the Standalone mode.\r\nI've reviewed StandaloneSubmitRequestServlet class and i think we might be facing the same problem here, (L.126-131) You can find checks for 'appResource' and 'mainClass' but not for 'appArgs'(L.140) or 'environmentVariables'(L.143) when they could be null as they are initialised as null.\r\n\r\nI think is the same case, let me know what you think.",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-29T07:31:55Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "susanxhuynh"
    },
    "body": "OK, I was looking at RestSubmissionClient (used by Mesos and Standalone) - the client does always set 'appArgs' and 'envrionmentVariables': https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/deploy/rest/RestSubmissionClient.scala#L427 So, it's only a bug when the user does not use the RestSubmissionClient (by using 'curl' directly to the server, for example). So, that addresses my concern about Standalone mode. As to whether to add a similar check in the Standalone class, I don't have a strong opinion about it (fix it here or fix in another PR).",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-29T15:41:57Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "Perfect then @susanxhuynh . Fix it maybe in another PR? \r\n\r\n",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-29T20:10:19Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "susanxhuynh"
    },
    "body": "Yeah, that's fine with me.",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-29T20:28:03Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "Gschiavon"
    },
    "body": "Cool, I can do it when I have some time.\r\n\r\nLet me know if I have to something else here! @felixcheung \r\n\r\nThanks @susanxhuynh ",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-30T13:23:55Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }, {
    "author": {
      "login": "susanxhuynh"
    },
    "body": "LGTM",
    "commit": "ba221bd412c8bec2c6b7f16719556c17b819f2a7",
    "createdAt": "2017-11-30T15:13:09Z",
    "diffHunk": "@@ -86,6 +86,8 @@ class SubmitRestProtocolSuite extends SparkFunSuite {\n     message.clientSparkVersion = \"1.2.3\"\n     message.appResource = \"honey-walnut-cherry.jar\"\n     message.mainClass = \"org.apache.spark.examples.SparkPie\"\n+    message.appArgs = Array(\"hdfs://tmp/auth\")\n+    message.environmentVariables = Map(\"SPARK_HOME\" -> \"/test\")"
  }],
  "prId": 19793
}]