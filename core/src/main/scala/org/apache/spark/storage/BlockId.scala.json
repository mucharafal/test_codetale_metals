[{
  "comments": [{
    "author": {
      "login": "xuanyuanking"
    },
    "body": "The default parameter just for less change of existing tests, if we don't agree, I'll change all tests and delete the default value.",
    "commit": "b8bc6119ee468f1e0371ac946f07f6362cd16f47",
    "createdAt": "2019-03-28T14:26:17Z",
    "diffHunk": "@@ -51,19 +51,39 @@ case class RDDBlockId(rddId: Int, splitIndex: Int) extends BlockId {\n \n // Format of the shuffle block ids (including data and index) should be kept in sync with\n // org.apache.spark.network.shuffle.ExternalShuffleBlockResolver#getBlockData().\n+// IndeterminateAttemptId is only set when the ShuffleMapStage's [[DeterministicLevel]] is\n+// INDETERMINATE and fetch fail triggered whole map stage rerun.\n @DeveloperApi\n-case class ShuffleBlockId(shuffleId: Int, mapId: Int, reduceId: Int) extends BlockId {\n-  override def name: String = \"shuffle_\" + shuffleId + \"_\" + mapId + \"_\" + reduceId\n+case class ShuffleBlockId(\n+    shuffleId: Int,\n+    mapId: Int,\n+    reduceId: Int,\n+    stageAttemptId: Int = 0)"
  }],
  "prId": 24110
}, {
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "please comment and explain what EXTEND_SHUFFLE means.",
    "commit": "b8bc6119ee468f1e0371ac946f07f6362cd16f47",
    "createdAt": "2019-04-09T04:56:52Z",
    "diffHunk": "@@ -98,14 +128,18 @@ private[spark] case class TestBlockId(id: String) extends BlockId {\n \n @DeveloperApi\n class UnrecognizedBlockId(name: String)\n-    extends SparkException(s\"Failed to parse $name into a block ID\")\n+  extends SparkException(s\"Failed to parse $name into a block ID\")\n \n @DeveloperApi\n object BlockId {\n   val RDD = \"rdd_([0-9]+)_([0-9]+)\".r\n   val SHUFFLE = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+)\".r\n   val SHUFFLE_DATA = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+).data\".r\n   val SHUFFLE_INDEX = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+).index\".r\n+  // the extend shuffle/data/index is only used when INDETERMINATE stage rerun\n+  val EXTEND_SHUFFLE = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+)_([0-9]+)\".r",
    "line": 71
  }, {
    "author": {
      "login": "xuanyuanking"
    },
    "body": "Copy that, done in a1e6d0c.",
    "commit": "b8bc6119ee468f1e0371ac946f07f6362cd16f47",
    "createdAt": "2019-04-09T14:40:50Z",
    "diffHunk": "@@ -98,14 +128,18 @@ private[spark] case class TestBlockId(id: String) extends BlockId {\n \n @DeveloperApi\n class UnrecognizedBlockId(name: String)\n-    extends SparkException(s\"Failed to parse $name into a block ID\")\n+  extends SparkException(s\"Failed to parse $name into a block ID\")\n \n @DeveloperApi\n object BlockId {\n   val RDD = \"rdd_([0-9]+)_([0-9]+)\".r\n   val SHUFFLE = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+)\".r\n   val SHUFFLE_DATA = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+).data\".r\n   val SHUFFLE_INDEX = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+).index\".r\n+  // the extend shuffle/data/index is only used when INDETERMINATE stage rerun\n+  val EXTEND_SHUFFLE = \"shuffle_([0-9]+)_([0-9]+)_([0-9]+)_([0-9]+)\".r",
    "line": 71
  }],
  "prId": 24110
}]