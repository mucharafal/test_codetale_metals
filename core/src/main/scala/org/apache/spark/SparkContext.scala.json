[{
  "comments": [{
    "author": {
      "login": "ArtRand"
    },
    "body": "FWIW, I _believe_ that when we submit a job with the dispatcher `deployMode` is actually set to `client`, so this logic may not be invoked as expected. ",
    "commit": "06999177331b7323813eca3c06d6a9a55e054f7d",
    "createdAt": "2017-10-14T01:27:39Z",
    "diffHunk": "@@ -373,10 +374,16 @@ class SparkContext(config: SparkConf) extends Logging {\n     // log out spark.app.name in the Spark driver logs\n     logInfo(s\"Submitted application: $appName\")\n \n-    // System property spark.yarn.app.id must be set if user code ran by AM on a YARN cluster\n-    if (master == \"yarn\" && deployMode == \"cluster\" && !_conf.contains(\"spark.yarn.app.id\")) {\n-      throw new SparkException(\"Detected yarn cluster mode, but isn't running on a cluster. \" +\n-        \"Deployment to YARN is not supported directly by SparkContext. Please use spark-submit.\")\n+    // System property spark.yarn.app.id must be set if user code ran by AM on a YARN cluster or\n+    // System property spark.mesos.driver.frameworkId must be set if user code ran by\n+    // Mesos Dispatcher on a MESOS cluster\n+    if (deployMode == \"cluster\") {"
  }, {
    "author": {
      "login": "skonto"
    },
    "body": "Ok  you are right we do a spark submit again. I will remove this part.",
    "commit": "06999177331b7323813eca3c06d6a9a55e054f7d",
    "createdAt": "2017-10-16T19:40:49Z",
    "diffHunk": "@@ -373,10 +374,16 @@ class SparkContext(config: SparkConf) extends Logging {\n     // log out spark.app.name in the Spark driver logs\n     logInfo(s\"Submitted application: $appName\")\n \n-    // System property spark.yarn.app.id must be set if user code ran by AM on a YARN cluster\n-    if (master == \"yarn\" && deployMode == \"cluster\" && !_conf.contains(\"spark.yarn.app.id\")) {\n-      throw new SparkException(\"Detected yarn cluster mode, but isn't running on a cluster. \" +\n-        \"Deployment to YARN is not supported directly by SparkContext. Please use spark-submit.\")\n+    // System property spark.yarn.app.id must be set if user code ran by AM on a YARN cluster or\n+    // System property spark.mesos.driver.frameworkId must be set if user code ran by\n+    // Mesos Dispatcher on a MESOS cluster\n+    if (deployMode == \"cluster\") {"
  }],
  "prId": 19374
}]