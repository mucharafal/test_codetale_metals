[{
  "comments": [{
    "author": {
      "login": "squito"
    },
    "body": "I'm trying to wrap my head around what happens if you create an `IsolatedRpcEndpoint` with threadCount() > 1, given the code in `Inbox` which checks for inheritance from `ThreadSafeRpcEndpoint`: https://github.com/apache/spark/blob/2b3c3793c97dc0e48f1e098c6f1038f51607b716/core/src/main/scala/org/apache/spark/rpc/netty/Inbox.scala#L123\r\n\r\nI guess if you expect one endpoint to be served by multiple threads, it makes sense you'd want `Inbox.enableConcurrent = false` and you'd have to make your endpoint safe for that -- but worth a comment here at least.",
    "commit": "b674b4c251ecc897e50504bf999257dc0e6d8354",
    "createdAt": "2019-10-10T18:55:24Z",
    "diffHunk": "@@ -146,3 +146,13 @@ private[spark] trait RpcEndpoint {\n  * [[ThreadSafeRpcEndpoint]] for different messages.\n  */\n private[spark] trait ThreadSafeRpcEndpoint extends RpcEndpoint\n+\n+/**\n+ * An endpoint that uses a dedicated thread pool for delivering messages.\n+ */\n+private[spark] trait IsolatedRpcEndpoint extends RpcEndpoint {\n+\n+  /** How many threads to use for delivering messages. By default, use a single thread. */\n+  def threadCount(): Int = 1",
    "line": 17
  }, {
    "author": {
      "login": "Ngone51"
    },
    "body": "I have the same question with @squito . How do you deal with `ThreadSafeRpcEndpoint` ?\r\n\r\nThough we could set `Inbox.enableConcurrent = false` with `threadCount() > 0`, but multiple threads would be wasted.",
    "commit": "b674b4c251ecc897e50504bf999257dc0e6d8354",
    "createdAt": "2019-10-17T13:15:04Z",
    "diffHunk": "@@ -146,3 +146,13 @@ private[spark] trait RpcEndpoint {\n  * [[ThreadSafeRpcEndpoint]] for different messages.\n  */\n private[spark] trait ThreadSafeRpcEndpoint extends RpcEndpoint\n+\n+/**\n+ * An endpoint that uses a dedicated thread pool for delivering messages.\n+ */\n+private[spark] trait IsolatedRpcEndpoint extends RpcEndpoint {\n+\n+  /** How many threads to use for delivering messages. By default, use a single thread. */\n+  def threadCount(): Int = 1",
    "line": 17
  }, {
    "author": {
      "login": "vanzin"
    },
    "body": "I already updated the comment. `ThreadSafeRpcEndpoint` is irrelevant here. You may even extend both if you want; but if you do that, either it does nothing (because the thread pool has a single thread), or you're doing it wrong (because the thread pool has multiple thread but you just want one).\r\n\r\nSo it's pointless to mix in both traits.",
    "commit": "b674b4c251ecc897e50504bf999257dc0e6d8354",
    "createdAt": "2019-10-17T15:42:56Z",
    "diffHunk": "@@ -146,3 +146,13 @@ private[spark] trait RpcEndpoint {\n  * [[ThreadSafeRpcEndpoint]] for different messages.\n  */\n private[spark] trait ThreadSafeRpcEndpoint extends RpcEndpoint\n+\n+/**\n+ * An endpoint that uses a dedicated thread pool for delivering messages.\n+ */\n+private[spark] trait IsolatedRpcEndpoint extends RpcEndpoint {\n+\n+  /** How many threads to use for delivering messages. By default, use a single thread. */\n+  def threadCount(): Int = 1",
    "line": 17
  }],
  "prId": 26059
}]