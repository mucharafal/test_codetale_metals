[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "Looks like the internal and external shuffle read metrics don't match, the `localBytesRead` is missing.\n",
    "commit": "27110758fc2b90f40117ba514991c8922fb1b07e",
    "createdAt": "2016-04-15T13:08:27Z",
    "diffHunk": "@@ -250,44 +266,62 @@ private[v1] object AllStagesResource {\n       resultSerializationTime = internal.resultSerializationTime,\n       memoryBytesSpilled = internal.memoryBytesSpilled,\n       diskBytesSpilled = internal.diskBytesSpilled,\n-      inputMetrics = internal.inputMetrics.map { convertInputMetrics },\n-      outputMetrics = Option(internal.outputMetrics).flatten.map { convertOutputMetrics },\n-      shuffleReadMetrics = internal.shuffleReadMetrics.map { convertShuffleReadMetrics },\n-      shuffleWriteMetrics = internal.shuffleWriteMetrics.map { convertShuffleWriteMetrics }\n+      inputMetrics = convertInputMetrics(internal.inputMetrics),\n+      outputMetrics = convertOutputMetrics(internal.outputMetrics),\n+      shuffleReadMetrics = convertShuffleReadMetrics(internal.shuffleReadMetrics),\n+      shuffleWriteMetrics = convertShuffleWriteMetrics(internal.shuffleWriteMetrics)\n     )\n   }\n \n-  def convertInputMetrics(internal: InternalInputMetrics): InputMetrics = {\n-    new InputMetrics(\n-      bytesRead = internal.bytesRead,\n-      recordsRead = internal.recordsRead\n-    )\n+  def convertInputMetrics(internal: InternalInputMetrics): Option[InputMetrics] = {\n+    if (internal.isUpdated) {\n+      Some(new InputMetrics(\n+        bytesRead = internal.bytesRead,\n+        recordsRead = internal.recordsRead\n+      ))\n+    } else {\n+      None\n+    }\n   }\n \n-  def convertOutputMetrics(internal: InternalOutputMetrics): OutputMetrics = {\n-    new OutputMetrics(\n-      bytesWritten = internal.bytesWritten,\n-      recordsWritten = internal.recordsWritten\n-    )\n+  def convertOutputMetrics(internal: InternalOutputMetrics): Option[OutputMetrics] = {\n+    if (internal.isUpdated) {\n+      Some(new OutputMetrics(\n+        bytesWritten = internal.bytesWritten,\n+        recordsWritten = internal.recordsWritten\n+      ))\n+    } else {\n+      None\n+    }\n   }\n \n-  def convertShuffleReadMetrics(internal: InternalShuffleReadMetrics): ShuffleReadMetrics = {\n-    new ShuffleReadMetrics(\n-      remoteBlocksFetched = internal.remoteBlocksFetched,\n-      localBlocksFetched = internal.localBlocksFetched,\n-      fetchWaitTime = internal.fetchWaitTime,\n-      remoteBytesRead = internal.remoteBytesRead,\n-      totalBlocksFetched = internal.totalBlocksFetched,\n-      recordsRead = internal.recordsRead\n-    )\n+  def convertShuffleReadMetrics(\n+      internal: InternalShuffleReadMetrics): Option[ShuffleReadMetrics] = {\n+    if (internal.isUpdated) {\n+      Some(new ShuffleReadMetrics(\n+        remoteBlocksFetched = internal.remoteBlocksFetched,\n+        localBlocksFetched = internal.localBlocksFetched,\n+        fetchWaitTime = internal.fetchWaitTime,\n+        remoteBytesRead = internal.remoteBytesRead,\n+        totalBlocksFetched = internal.totalBlocksFetched,\n+        recordsRead = internal.recordsRead",
    "line": 117
  }],
  "prId": 12417
}]