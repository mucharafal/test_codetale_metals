[{
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "This can just add the argument if not present.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-12T15:19:10Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static String getOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "tedyu"
    },
    "body": "The pattern ExecutorRunnable uses is that the return value is added explicitly to Java opts.\n\nI think being consistent with the pattern is fine.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-12T15:45:03Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static String getOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "I don't see that? the only similar method I see manages `-XX:MaxPermGen` and it does not work this way.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-13T09:26:08Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static String getOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "tedyu"
    },
    "body": "See the code in ExecutorRunnable.scala, around line 214:\n\n```\n    val commands = prefixEnv ++ Seq(\n      YarnSparkHadoopUtil.expandEnvironment(Environment.JAVA_HOME) + \"/bin/java\",\n      \"-server\",\n...\n      YarnSparkHadoopUtil.getOutOfMemoryErrorArgument(javaOpts)) ++\n```\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-13T09:34:21Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static String getOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "That's the argument we're talking about changing here, yes. I am suggesting making it consistent.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-13T09:40:00Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static String getOutOfMemoryErrorArgument(List<String> cmd) {"
  }],
  "prId": 13057
}, {
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "Sorry last question -- why does this method need to be in this class? it's not used, it seems, except from YarnSparkHadoopUtil\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T15:44:53Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "tedyu"
    },
    "body": "Please suggest a suitable class which is better host for this Java method.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T15:59:22Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "Just YarnSparkHadoopUtil ? it can be inlined the one place it's called or am I overlooking something?\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T16:45:41Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "tedyu"
    },
    "body": "YarnSparkHadoopUtil is written in Scala while this method is in Java.\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T16:52:14Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "Why can't it be written in Scala? \n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T17:00:19Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "tedyu"
    },
    "body": "Can you take a look at my initial attempt ?\n\n```\n+      val = onOOME = javaOpts.find(x => x.contains(\"-XX:OnOutOfMemoryError\"))\n+      if (onOOME == None) {\n+        \"-XX:OnOutOfMemoryError='kill %p'\"\n+      } else {\n+        \"\"\n+      }\n```\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T17:09:55Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "Sure, maybe ...\n\n```\nif (!javaOpts.exists(_.contains(\"...\")) {\n  javaOpts.add(\"...\")\n}\n```\n",
    "commit": "e7c447223d12543eb92240550d0acfdf3217b58d",
    "createdAt": "2016-05-17T17:31:29Z",
    "diffHunk": "@@ -334,6 +334,18 @@ static void addPermGenSizeOpt(List<String> cmd) {\n   }\n \n   /**\n+   * Gets the OutOfMemoryError option for Spark if the user hasn't set it.\n+   */\n+  public static void addOutOfMemoryErrorArgument(List<String> cmd) {"
  }],
  "prId": 13057
}]