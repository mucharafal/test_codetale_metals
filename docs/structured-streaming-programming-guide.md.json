[{
  "comments": [{
    "author": {
      "login": "HeartSaVioR"
    },
    "body": "I couldn't find place to leave this for (batch) file source. Please let me know if we have proper place to put. At least we guide the needs of enable this option when \"retainOnlyLastBatchInMetadata\" option is enabled, so might be safe for batch case as well.",
    "commit": "fa88d9edb6c5a4393eaacd18a4efba975d16fcb4",
    "createdAt": "2019-02-20T02:57:49Z",
    "diffHunk": "@@ -536,6 +536,11 @@ Here are the details of all the sources in Spark.\n         href=\"api/R/read.stream.html\">R</a>).\n         E.g. for \"parquet\" format options see <code>DataStreamReader.parquet()</code>.\n         <br/><br/>\n+        <code>ignoreFileStreamSinkMetadata</code>: whether to ignore metadata information being left from file stream sink, which leads to always use in-memory file index. (default: false)",
    "line": 4
  }],
  "prId": 23840
}, {
  "comments": [{
    "author": {
      "login": "HeartSaVioR"
    },
    "body": "I feel this is not ideal, but given file stream sink itself also leverages file log, it cannot be an optional entirely. \r\n\r\nIf we would like to not leaving file log in this case, we may need to have another metadata (which store minimized information like the last succeed batch id) and store it instead when the option is turned on. It should be stored in another directory (_spark_metadata) and listing files should ignore this directory too.",
    "commit": "fa88d9edb6c5a4393eaacd18a4efba975d16fcb4",
    "createdAt": "2019-02-20T03:03:24Z",
    "diffHunk": "@@ -1812,6 +1817,12 @@ Here are the details of all the sinks in Spark.\n         (<a href=\"api/scala/index.html#org.apache.spark.sql.DataFrameWriter\">Scala</a>/<a href=\"api/java/org/apache/spark/sql/DataFrameWriter.html\">Java</a>/<a href=\"api/python/pyspark.sql.html#pyspark.sql.DataFrameWriter\">Python</a>/<a\n         href=\"api/R/write.stream.html\">R</a>).\n         E.g. for \"parquet\" format options see <code>DataFrameWriter.parquet()</code>\n+        <br/>\n+        <code>retainOnlyLastBatchInMetadata</code>: whether to retain metadata information only for last succeed batch.\n+        <br/><br/>\n+        This option greatly reduces overhead on compacting metadata files which would be non-trivial when query processes lots of files in each batch.<br/>\n+        NOTE: As it only retains the last batch in metadata, the metadata is not readable from file source: you must set \"ignoreFileStreamSinkMetadata\" option",
    "line": 20
  }],
  "prId": 23840
}]