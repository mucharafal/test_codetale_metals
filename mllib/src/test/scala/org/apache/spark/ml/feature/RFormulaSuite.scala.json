[{
  "comments": [{
    "author": {
      "login": "yanboliang"
    },
    "body": "Currently disable this assert due to `StringIndexer` output inconsistent `nullable`, I opened [SPARK-11478](https://issues.apache.org/jira/browse/SPARK-11478) to track that issue. After it resolved, this assert will be enabled.\n",
    "commit": "40b9a27361e422fd41ea0404cd61599e4afba00c",
    "createdAt": "2015-11-03T14:35:03Z",
    "diffHunk": "@@ -107,6 +107,25 @@ class RFormulaSuite extends SparkFunSuite with MLlibTestSparkContext {\n     assert(result.collect() === expected.collect())\n   }\n \n+  test(\"index string label\") {\n+    val formula = new RFormula().setFormula(\"id ~ a + b\")\n+    val original = sqlContext.createDataFrame(\n+      Seq((\"male\", \"foo\", 4), (\"female\", \"bar\", 4), (\"female\", \"bar\", 5), (\"male\", \"baz\", 5))\n+    ).toDF(\"id\", \"a\", \"b\")\n+    val model = formula.fit(original)\n+    val result = model.transform(original)\n+    val resultSchema = model.transformSchema(original.schema)\n+    val expected = sqlContext.createDataFrame(\n+      Seq(\n+        (\"male\", \"foo\", 4, Vectors.dense(0.0, 1.0, 4.0), 1.0),\n+        (\"female\", \"bar\", 4, Vectors.dense(1.0, 0.0, 4.0), 0.0),\n+        (\"female\", \"bar\", 5, Vectors.dense(1.0, 0.0, 5.0), 0.0),\n+        (\"male\", \"baz\", 5, Vectors.dense(0.0, 0.0, 5.0), 1.0))\n+    ).toDF(\"id\", \"a\", \"b\", \"features\", \"label\")\n+    // assert(result.schema.toString == resultSchema.toString)",
    "line": 19
  }],
  "prId": 9302
}]