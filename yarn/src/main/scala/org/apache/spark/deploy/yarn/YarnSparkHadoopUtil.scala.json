[{
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "Does this require `bash` to interpret, and do we know the JVM would execute the command in a  shell? if you're tested this and it works, OK\n",
    "commit": "69f263b6485980f1f0833beae5c816356e82db1a",
    "createdAt": "2015-10-29T14:22:49Z",
    "diffHunk": "@@ -238,7 +238,7 @@ object YarnSparkHadoopUtil {\n     if (Utils.isWindows) {\n       escapeForShell(\"-XX:OnOutOfMemoryError=taskkill /F /PID %%%%p\")\n     } else {\n-      \"-XX:OnOutOfMemoryError='kill %p'\"\n+      \"-XX:OnOutOfMemoryError='echo OnOutOfMemoryError; kill %p'\"",
    "line": 5
  }, {
    "author": {
      "login": "darabos"
    },
    "body": "Sorry, I should have mentioned I didn't test this on an actual executor. I tested the flag on the Scala interpreter, which is easier to OOM. It produced this output:\n\n```\n#\n# java.lang.OutOfMemoryError: GC overhead limit exceeded\n# -XX:OnOutOfMemoryError=\"echo hi; kill %p\"\n#   Executing /bin/sh -c \"echo OnOutOfMemoryError\"...\nOnOutOfMemoryError\n#   Executing /bin/sh -c \"kill 32523\"...\n```\n\nI'm not sure where the lines with `#` come from. I did not see this in the output of the executor I lost. (So maybe it was killed by something else after all?)\n\nI guess it would be best if I tested this with actual executors on actual YARN...\n",
    "commit": "69f263b6485980f1f0833beae5c816356e82db1a",
    "createdAt": "2015-10-29T14:42:44Z",
    "diffHunk": "@@ -238,7 +238,7 @@ object YarnSparkHadoopUtil {\n     if (Utils.isWindows) {\n       escapeForShell(\"-XX:OnOutOfMemoryError=taskkill /F /PID %%%%p\")\n     } else {\n-      \"-XX:OnOutOfMemoryError='kill %p'\"\n+      \"-XX:OnOutOfMemoryError='echo OnOutOfMemoryError; kill %p'\"",
    "line": 5
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "That looks pretty convincing then. Seems like it parses the commands and launches each with sh\n",
    "commit": "69f263b6485980f1f0833beae5c816356e82db1a",
    "createdAt": "2015-10-29T18:46:59Z",
    "diffHunk": "@@ -238,7 +238,7 @@ object YarnSparkHadoopUtil {\n     if (Utils.isWindows) {\n       escapeForShell(\"-XX:OnOutOfMemoryError=taskkill /F /PID %%%%p\")\n     } else {\n-      \"-XX:OnOutOfMemoryError='kill %p'\"\n+      \"-XX:OnOutOfMemoryError='echo OnOutOfMemoryError; kill %p'\"",
    "line": 5
  }, {
    "author": {
      "login": "srowen"
    },
    "body": "Oh, are you looking at both stderr and stdout?\n",
    "commit": "69f263b6485980f1f0833beae5c816356e82db1a",
    "createdAt": "2015-10-29T18:47:33Z",
    "diffHunk": "@@ -238,7 +238,7 @@ object YarnSparkHadoopUtil {\n     if (Utils.isWindows) {\n       escapeForShell(\"-XX:OnOutOfMemoryError=taskkill /F /PID %%%%p\")\n     } else {\n-      \"-XX:OnOutOfMemoryError='kill %p'\"\n+      \"-XX:OnOutOfMemoryError='echo OnOutOfMemoryError; kill %p'\"",
    "line": 5
  }],
  "prId": 9355
}]