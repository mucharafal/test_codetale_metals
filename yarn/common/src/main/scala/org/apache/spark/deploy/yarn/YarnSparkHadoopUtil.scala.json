[{
  "comments": [{
    "author": {
      "login": "andrewor14"
    },
    "body": "How about\n\n```\nconf.getOption(\"spark.yarn.historyServer.address\")\n  .map { address => s\"$address${HistoryServer.UI_PATH_PREFIX}/${appId}\" }\n  .getOrElse(\"\")\n```\n",
    "commit": "2d19f3c5b45b797fbd60cf79d99ec4de466403db",
    "createdAt": "2014-08-13T21:36:32Z",
    "diffHunk": "@@ -135,14 +135,10 @@ object YarnSparkHadoopUtil {\n     }\n   }\n \n-  def getUIHistoryAddress(sc: SparkContext, conf: SparkConf) : String = {\n-    val eventLogDir = sc.eventLogger match {\n-      case Some(logger) => logger.getApplicationLogDir()\n-      case None => \"\"\n-    }\n-    val historyServerAddress = conf.get(\"spark.yarn.historyServer.address\", \"\")\n-    if (historyServerAddress != \"\" && eventLogDir != \"\") {\n-      historyServerAddress + HistoryServer.UI_PATH_PREFIX + s\"/$eventLogDir\"\n+  def getUIHistoryAddress(conf: SparkConf, appId: String): String = {\n+    val historyServerAddress = conf.get(\"spark.yarn.historyServer.address\", null)\n+    if (historyServerAddress != null) {\n+      s\"${historyServerAddress}${HistoryServer.UI_PATH_PREFIX}/${appId}\"\n     } else {\n       \"\"\n     }"
  }],
  "prId": 1218
}]