[{
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "This can be replaced with `(1 to 5).map { i => ExecutorCacheTaskLocation(s\"host$i\", s\"$i\") }`\n",
    "commit": "46c5197c946cbed75ac28e1b60e64266ca070ee1",
    "createdAt": "2015-10-26T23:06:39Z",
    "diffHunk": "@@ -20,73 +20,102 @@ package org.apache.spark.streaming.scheduler\n import scala.collection.mutable\n \n import org.apache.spark.SparkFunSuite\n+import org.apache.spark.scheduler.{ExecutorCacheTaskLocation, HostTaskLocation, TaskLocation}\n \n class ReceiverSchedulingPolicySuite extends SparkFunSuite {\n \n   val receiverSchedulingPolicy = new ReceiverSchedulingPolicy\n \n   test(\"rescheduleReceiver: empty executors\") {\n-    val scheduledExecutors =\n+    val scheduledLocations =\n       receiverSchedulingPolicy.rescheduleReceiver(0, None, Map.empty, executors = Seq.empty)\n-    assert(scheduledExecutors === Seq.empty)\n+    assert(scheduledLocations === Seq.empty)\n   }\n \n   test(\"rescheduleReceiver: receiver preferredLocation\") {\n+    val executors = Seq(ExecutorCacheTaskLocation(\"host2\", \"2\"))\n     val receiverTrackingInfoMap = Map(\n       0 -> ReceiverTrackingInfo(0, ReceiverState.INACTIVE, None, None))\n-    val scheduledExecutors = receiverSchedulingPolicy.rescheduleReceiver(\n-      0, Some(\"host1\"), receiverTrackingInfoMap, executors = Seq(\"host2\"))\n-    assert(scheduledExecutors.toSet === Set(\"host1\", \"host2\"))\n+    val scheduledLocations = receiverSchedulingPolicy.rescheduleReceiver(\n+      0, Some(\"host1\"), receiverTrackingInfoMap, executors)\n+    assert(scheduledLocations.toSet === Set(HostTaskLocation(\"host1\"), executors(0)))\n   }\n \n   test(\"rescheduleReceiver: return all idle executors if there are any idle executors\") {\n-    val executors = Seq(\"host1\", \"host2\", \"host3\", \"host4\", \"host5\")\n-    // host3 is idle\n+    val executors = Seq(\n+      ExecutorCacheTaskLocation(\"host1\", \"1\"),\n+      ExecutorCacheTaskLocation(\"host2\", \"2\"),\n+      ExecutorCacheTaskLocation(\"host3\", \"3\"),\n+      ExecutorCacheTaskLocation(\"host4\", \"4\"),\n+      ExecutorCacheTaskLocation(\"host5\", \"5\")\n+    )",
    "line": 53
  }],
  "prId": 9181
}]