[{
  "comments": [{
    "author": {
      "login": "shivaram"
    },
    "body": "I think its better to add a test case that doesn't depend on `magrittr` as our Jenkins environment or other developers might not have the package installed.\n",
    "commit": "f2b8d97ba80ebd424aeab7d14c09c8225f3daa69",
    "createdAt": "2016-05-26T17:30:34Z",
    "diffHunk": "@@ -16,6 +16,7 @@\n #\n \n library(testthat)\n+library(magrittr)"
  }],
  "prId": 13295
}, {
  "comments": [{
    "author": {
      "login": "shivaram"
    },
    "body": "we probably dont need `testthat::` here.\n",
    "commit": "f2b8d97ba80ebd424aeab7d14c09c8225f3daa69",
    "createdAt": "2016-05-30T17:11:56Z",
    "diffHunk": "@@ -1353,6 +1354,21 @@ test_that(\"group by, agg functions\", {\n   unlink(jsonPath3)\n })\n \n+test_that(\"pivot GroupedData column\", {\n+  df <- data.frame(\n+        earnings = c(10000, 10000, 11000, 15000, 12000, 20000, 21000, 22000),\n+        course = c(\"R\", \"Python\", \"R\", \"Python\", \"R\", \"Python\", \"R\", \"Python\"),\n+        year = c(2013, 2013, 2014, 2014, 2015, 2015, 2016, 2016)\n+  )\n+  SparkRdf <- createDataFrame(df)\n+  values <- list(\"R\", \"Python\")\n+  sums <- collect(SparkR::summarize(pivot(groupBy(SparkRdf, \"year\"), \"course\", values),\n+                                    earnings_sum = sum(SparkRdf$earnings)) )\n+  testthat::expect_equal(colnames(sums) %in% c(\"year\", \"R\", \"Python\"), c(T, T, T))"
  }],
  "prId": 13295
}]