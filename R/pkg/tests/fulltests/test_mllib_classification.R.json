[{
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "This is due to the change of how we sort string labels with same frequency under the setting of frequencyDesc/Asc.",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-04T04:04:53Z",
    "diffHunk": "@@ -313,7 +313,7 @@ test_that(\"spark.mlp\", {\n   # Test predict method\n   mlpTestDF <- df\n   mlpPredictions <- collect(select(predict(model, mlpTestDF), \"prediction\"))\n-  expect_equal(head(mlpPredictions$prediction, 6), c(\"1.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\"))\n+  expect_equal(head(mlpPredictions$prediction, 6), c(\"0.0\", \"1.0\", \"1.0\", \"1.0\", \"1.0\", \"1.0\"))",
    "line": 5
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "I checked the predictions. All `0.0` -> `1.0`, and all`1.0` -> `0.0`.",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-04T04:30:49Z",
    "diffHunk": "@@ -313,7 +313,7 @@ test_that(\"spark.mlp\", {\n   # Test predict method\n   mlpTestDF <- df\n   mlpPredictions <- collect(select(predict(model, mlpTestDF), \"prediction\"))\n-  expect_equal(head(mlpPredictions$prediction, 6), c(\"1.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\"))\n+  expect_equal(head(mlpPredictions$prediction, 6), c(\"0.0\", \"1.0\", \"1.0\", \"1.0\", \"1.0\", \"1.0\"))",
    "line": 5
  }],
  "prId": 20146
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Seems `maxIter = 10` is not stable. I increased to 100 to stabilize the predictions. ",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-04T04:06:13Z",
    "diffHunk": "@@ -348,12 +348,12 @@ test_that(\"spark.mlp\", {\n \n   # Test random seed\n   # default seed\n-  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\n+  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)",
    "line": 14
  }, {
    "author": {
      "login": "felixcheung"
    },
    "body": "can you check if the run time increases significantly? this is an issue before - see SPARK-21693",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-04T05:52:22Z",
    "diffHunk": "@@ -348,12 +348,12 @@ test_that(\"spark.mlp\", {\n \n   # Test random seed\n   # default seed\n-  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\n+  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)",
    "line": 14
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "```R\r\n> start.time <- Sys.time()\r\n> model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\r\n> end.time <- Sys.time()\r\n> time.taken <- end.time - start.time\r\n> time.taken\r\nTime difference of 1.780564 secs\r\n```\r\n\r\n```R\r\n> start.time <- Sys.time()\r\n> model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)\r\n> end.time <- Sys.time()\r\n> time.taken <- end.time - start.time\r\n> time.taken\r\nTime difference of 5.728089 secs\r\n```",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-07T02:04:52Z",
    "diffHunk": "@@ -348,12 +348,12 @@ test_that(\"spark.mlp\", {\n \n   # Test random seed\n   # default seed\n-  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\n+  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)",
    "line": 14
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Ahh, @viirya, would you mind if I ask to check it after setting `spark.sparkr.use.daemon` to `false` too?",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-07T12:55:23Z",
    "diffHunk": "@@ -348,12 +348,12 @@ test_that(\"spark.mlp\", {\n \n   # Test random seed\n   # default seed\n-  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\n+  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)",
    "line": 14
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "Ran it again with the config:\r\n\r\n```R\r\n> sparkR.conf(\"spark.sparkr.use.daemon\")                                                                         \r\n$spark.sparkr.use.daemon\r\n[1] \"false\"\r\n> start.time <- Sys.time()\r\n> model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\r\n> end.time <- Sys.time()\r\n> time.taken <- end.time - start.time\r\n> time.taken\r\nTime difference of 1.704288 secs\r\n```\r\n\r\n```R\r\n> start.time <- Sys.time()\r\n> model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)\r\n> end.time <- Sys.time()\r\n> time.taken <- end.time - start.time\r\n> time.taken\r\nTime difference of 5.135418 secs\r\n```\r\n\r\n",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-07T13:40:58Z",
    "diffHunk": "@@ -348,12 +348,12 @@ test_that(\"spark.mlp\", {\n \n   # Test random seed\n   # default seed\n-  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 10)\n+  model <- spark.mlp(df, label ~ features, layers = c(4, 5, 4, 3), maxIter = 100)",
    "line": 14
  }],
  "prId": 20146
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Actually I think we may remove this test `Test predict method`. Seems to me, with the `tol = 0.5`, the prediction may not be very meaningful.",
    "commit": "867e0019c33e0bfd46247968ae16648a662e60fa",
    "createdAt": "2018-01-04T04:52:54Z",
    "diffHunk": "@@ -313,7 +313,7 @@ test_that(\"spark.mlp\", {\n   # Test predict method",
    "line": 1
  }],
  "prId": 20146
}]