[{
  "comments": [{
    "author": {
      "login": "shivaram"
    },
    "body": "This code is now duplicated in two files. Do you think we should just create a `build-vignette.sh` and call it in two places ?\n",
    "commit": "1681005b6fe237d931fcea3daeaed3cb8c6087a1",
    "createdAt": "2016-11-10T23:18:08Z",
    "diffHunk": "@@ -52,21 +52,28 @@ Rscript -e 'libDir <- \"../../lib\"; library(SparkR, lib.loc=libDir); library(knit\n \n popd\n \n-# Find Spark jars.\n-if [ -f \"${SPARK_HOME}/RELEASE\" ]; then\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/jars\"\n+if [ -n \"$NO_VIGNETTES\" ]\n+then\n+  echo \"Skipping R vignettes\"\n else\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/assembly/target/scala-$SPARK_SCALA_VERSION/jars\"\n-fi\n \n-# Only create vignettes if Spark JARs exist\n-if [ -d \"$SPARK_JARS_DIR\" ]; then\n-  # render creates SparkR vignettes\n-  Rscript -e 'library(rmarkdown); paths <- .libPaths(); .libPaths(c(\"lib\", paths)); Sys.setenv(SPARK_HOME=tools::file_path_as_absolute(\"..\")); render(\"pkg/vignettes/sparkr-vignettes.Rmd\"); .libPaths(paths)'\n+  # Find Spark jars."
  }, {
    "author": {
      "login": "felixcheung"
    },
    "body": "right, I thought about that. I think there's value in knitting html and vignettes in create-doc.sh, it is a bit duplicated to have vignettes in 2 places but \n\nin create-doc.sh\n\n```\n...\nrender(\"pkg/vignettes/sparkr-vignettes.Rmd\");\n```\n\nin check-cran.sh\n\n```\n  SPARK_HOME=\"${SPARK_HOME}\" \"$R_SCRIPT_PATH/\"R CMD build $FWDIR/pkg\n```\n\nin the latter it is building the full package along with vignettes, so the actual command and behavior isn't exactly the same.\n\nPerhaps we should just take vignettes build out of create-doc.sh?\n",
    "commit": "1681005b6fe237d931fcea3daeaed3cb8c6087a1",
    "createdAt": "2016-11-10T23:33:13Z",
    "diffHunk": "@@ -52,21 +52,28 @@ Rscript -e 'libDir <- \"../../lib\"; library(SparkR, lib.loc=libDir); library(knit\n \n popd\n \n-# Find Spark jars.\n-if [ -f \"${SPARK_HOME}/RELEASE\" ]; then\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/jars\"\n+if [ -n \"$NO_VIGNETTES\" ]\n+then\n+  echo \"Skipping R vignettes\"\n else\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/assembly/target/scala-$SPARK_SCALA_VERSION/jars\"\n-fi\n \n-# Only create vignettes if Spark JARs exist\n-if [ -d \"$SPARK_JARS_DIR\" ]; then\n-  # render creates SparkR vignettes\n-  Rscript -e 'library(rmarkdown); paths <- .libPaths(); .libPaths(c(\"lib\", paths)); Sys.setenv(SPARK_HOME=tools::file_path_as_absolute(\"..\")); render(\"pkg/vignettes/sparkr-vignettes.Rmd\"); .libPaths(paths)'\n+  # Find Spark jars."
  }, {
    "author": {
      "login": "shivaram"
    },
    "body": "Yeah that seems fine to me. the `create-doc.sh` is used to generate docs for the Spark website etc. so its probably ok to not do the vignette as a part of that.\n",
    "commit": "1681005b6fe237d931fcea3daeaed3cb8c6087a1",
    "createdAt": "2016-11-10T23:36:08Z",
    "diffHunk": "@@ -52,21 +52,28 @@ Rscript -e 'libDir <- \"../../lib\"; library(SparkR, lib.loc=libDir); library(knit\n \n popd\n \n-# Find Spark jars.\n-if [ -f \"${SPARK_HOME}/RELEASE\" ]; then\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/jars\"\n+if [ -n \"$NO_VIGNETTES\" ]\n+then\n+  echo \"Skipping R vignettes\"\n else\n-  SPARK_JARS_DIR=\"${SPARK_HOME}/assembly/target/scala-$SPARK_SCALA_VERSION/jars\"\n-fi\n \n-# Only create vignettes if Spark JARs exist\n-if [ -d \"$SPARK_JARS_DIR\" ]; then\n-  # render creates SparkR vignettes\n-  Rscript -e 'library(rmarkdown); paths <- .libPaths(); .libPaths(c(\"lib\", paths)); Sys.setenv(SPARK_HOME=tools::file_path_as_absolute(\"..\")); render(\"pkg/vignettes/sparkr-vignettes.Rmd\"); .libPaths(paths)'\n+  # Find Spark jars."
  }],
  "prId": 15790
}]