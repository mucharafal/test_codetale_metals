[{
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "Nit: maybe we need a single space like `((long) Platform...`.",
    "commit": "08776e1931ee21e5200a977efd0aa379ae448033",
    "createdAt": "2017-07-10T04:55:21Z",
    "diffHunk": "@@ -44,7 +44,7 @@ public static long getPrefix(byte[] bytes) {\n       final int minLen = Math.min(bytes.length, 8);\n       long p = 0;\n       for (int i = 0; i < minLen; ++i) {\n-        p |= (128L + Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i))\n+        p |= ((long)Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i) & 0xff)"
  }, {
    "author": {
      "login": "kiszk"
    },
    "body": "good catch. done.",
    "commit": "08776e1931ee21e5200a977efd0aa379ae448033",
    "createdAt": "2017-07-10T05:10:45Z",
    "diffHunk": "@@ -44,7 +44,7 @@ public static long getPrefix(byte[] bytes) {\n       final int minLen = Math.min(bytes.length, 8);\n       long p = 0;\n       for (int i = 0; i < minLen; ++i) {\n-        p |= (128L + Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i))\n+        p |= ((long)Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i) & 0xff)"
  }],
  "prId": 18571
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Seems we don't have unit test for this. Shall we add a ByteArraySuite?",
    "commit": "08776e1931ee21e5200a977efd0aa379ae448033",
    "createdAt": "2017-07-14T07:46:38Z",
    "diffHunk": "@@ -44,7 +44,7 @@ public static long getPrefix(byte[] bytes) {\n       final int minLen = Math.min(bytes.length, 8);\n       long p = 0;\n       for (int i = 0; i < minLen; ++i) {\n-        p |= (128L + Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i))\n+        p |= ((long) Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i) & 0xff)",
    "line": 5
  }, {
    "author": {
      "login": "kiszk"
    },
    "body": "We have [the unit test](https://github.com/kiszk/spark/blob/08776e1931ee21e5200a977efd0aa379ae448033/core/src/test/scala/org/apache/spark/util/collection/unsafe/sort/PrefixComparatorsSuite.scala#L62-L115) for this. I added some cases.",
    "commit": "08776e1931ee21e5200a977efd0aa379ae448033",
    "createdAt": "2017-07-14T16:21:37Z",
    "diffHunk": "@@ -44,7 +44,7 @@ public static long getPrefix(byte[] bytes) {\n       final int minLen = Math.min(bytes.length, 8);\n       long p = 0;\n       for (int i = 0; i < minLen; ++i) {\n-        p |= (128L + Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i))\n+        p |= ((long) Platform.getByte(bytes, Platform.BYTE_ARRAY_OFFSET + i) & 0xff)",
    "line": 5
  }],
  "prId": 18571
}]