[{
  "comments": [{
    "author": {
      "login": "nchammas"
    },
    "body": "Do we want to have a version string that's slightly different from the \"original\", just for Python?\n\nI'm thinking about what will happen if people, for example, want to do the same for R. Having 3 slightly different ways of showing the version string seems unnecessary.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-27T14:43:03Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT",
    "line": 4
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "Yup we do, otherwise we can't publish on PyPI which is the end goal.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-27T15:25:01Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT",
    "line": 4
  }],
  "prId": 15659
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "nit: Looks like these changes are not related and can be separated to another small pr?\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-28T07:42:41Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "So the packaging doesn't seem to currently build without this - and I wanted to test the packaging as part of this.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-28T10:34:48Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "Curious why this has not been found before...\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-28T12:32:29Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "Yah I don't know if it's just I have a slightly older maven or some weird plugin. I can take a look some more at this.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-28T14:06:49Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }, {
    "author": {
      "login": "JoshRosen"
    },
    "body": "I think this is a new issue which was introduced in https://github.com/apache/spark/pull/14637/files#diff-01ca42240614718522afde4d4885b40dL189. I'd be in favor of fixing this separately. Do you mind splitting this change into a separate small PR which I'll merge right away?\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-12T00:31:02Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "Done - https://github.com/apache/spark/pull/15860\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-12T04:12:14Z",
    "diffHunk": "@@ -187,10 +208,10 @@ if [[ \"$1\" == \"package\" ]]; then\n   # We increment the Zinc port each time to avoid OOM's and other craziness if multiple builds\n   # share the same Zinc server.\n   FLAGS=\"-Psparkr -Phive -Phive-thriftserver -Pyarn -Pmesos\"\n-  make_binary_release \"hadoop2.3\" \"-Phadoop2.3 $FLAGS\" \"3033\" &\n-  make_binary_release \"hadoop2.4\" \"-Phadoop2.4 $FLAGS\" \"3034\" &\n-  make_binary_release \"hadoop2.6\" \"-Phadoop2.6 $FLAGS\" \"3035\" &\n-  make_binary_release \"hadoop2.7\" \"-Phadoop2.7 $FLAGS\" \"3036\" &\n+  make_binary_release \"hadoop2.3\" \"-Phadoop-2.3 $FLAGS\" \"3033\" &\n+  make_binary_release \"hadoop2.4\" \"-Phadoop-2.4 $FLAGS\" \"3034\" &\n+  make_binary_release \"hadoop2.6\" \"-Phadoop-2.6 $FLAGS\" \"3035\" &\n+  make_binary_release \"hadoop2.7\" \"-Phadoop-2.7 $FLAGS\" \"3036\" &",
    "line": 49
  }],
  "prId": 15659
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "nit: Looks like `python/pyspark/version.py` is only used when building release and will be overwritten, should we list it as ignored file?\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-28T23:39:05Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py",
    "line": 7
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "We need it if the user runs setup.py sdist on their on own and as part of the packaging tests during any Python change in Jenkins.  If the only way to build a pip installable package was make_release then yes - but that isn't the case.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-29T05:59:30Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py",
    "line": 7
  }, {
    "author": {
      "login": "JoshRosen"
    },
    "body": "If we can, I'd like to consolidate this logic into the `release-tag` shell script mentioned upthread.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-12T00:07:09Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py",
    "line": 7
  }],
  "prId": 15659
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Do we have a wrongly appended `.gz` here?\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-31T04:44:33Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz\n+    cp spark-$SPARK_VERSION-bin-$NAME/python/dist/$PYTHON_DIST_NAME .\n+\n+    echo $GPG_PASSPHRASE | $GPG --passphrase-fd 0 --armour \\\n+      --output $PYTHON_DIST_NAME.asc \\\n+      --detach-sig $PYTHON_DIST_NAME\n+    echo $GPG_PASSPHRASE | $GPG --passphrase-fd 0 --print-md \\\n+      MD5 $PYTHON_DIST_NAME.gz > \\"
  }],
  "prId": 15659
}, {
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Without specifying format, seems the output distribution will be zip file on windows? Because in `setup.py` it has support for windows, so I am wondering if this is an issue.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-31T05:01:25Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "I think packaging on windows can be considered a future todo\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-10-31T16:57:43Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "Also realistically I don't think packaging on windows is super supported right now given how we are doing it with shell scripts.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-01T13:56:44Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "Yeah, actually I have this question is because `setup.py` has few codes for windows.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-01T14:00:04Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }, {
    "author": {
      "login": "holdenk"
    },
    "body": "The goal is to eventually support building sdists on Windows - but I think porting the entire release process to windows is out of scope.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-02T17:22:24Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }, {
    "author": {
      "login": "JoshRosen"
    },
    "body": "We shouldn't port the release bash scripts to Windows. It's going to be a huge pain with little obvious benefit. Windows users who want to make release builds can just run this version of the script in a `*nix` VM.\n",
    "commit": "e1398552469288de3829eb889fec0de2ba568f15",
    "createdAt": "2016-11-12T00:32:37Z",
    "diffHunk": "@@ -162,14 +162,35 @@ if [[ \"$1\" == \"package\" ]]; then\n     export ZINC_PORT=$ZINC_PORT\n     echo \"Creating distribution: $NAME ($FLAGS)\"\n \n+    # Write out the NAME and VERSION to PySpark version info we rewrite the - into a . and SNAPSHOT\n+    # to dev0 to be closer to PEP440. We use the NAME as a \"local version\".\n+    PYSPARK_VERSION=`echo \"$SPARK_VERSION+$NAME\" |  sed -r \"s/-/./\" | sed -r \"s/SNAPSHOT/dev0/\"`\n+    echo \"__version__='$PYSPARK_VERSION'\" > python/pyspark/version.py\n+\n     # Get maven home set by MVN\n     MVN_HOME=`$MVN -version 2>&1 | grep 'Maven home' | awk '{print $NF}'`\n \n+    echo \"Creating distribution\"\n     ./dev/make-distribution.sh --name $NAME --mvn $MVN_HOME/bin/mvn --tgz $FLAGS \\\n       -DzincPort=$ZINC_PORT 2>&1 >  ../binary-release-$NAME.log\n     cd ..\n-    cp spark-$SPARK_VERSION-bin-$NAME/spark-$SPARK_VERSION-bin-$NAME.tgz .\n \n+    echo \"Copying and signing python distribution\"\n+    PYTHON_DIST_NAME=pyspark-$PYSPARK_VERSION.tar.gz",
    "line": 20
  }],
  "prId": 15659
}]