[{
  "comments": [{
    "author": {
      "login": "vanzin"
    },
    "body": "`ResetSystemProperties` not needed since you're not changing system properties.",
    "commit": "03e0e271c58e1a4fe7381b60b06e87e5fe2c3a77",
    "createdAt": "2018-01-02T23:31:15Z",
    "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.deploy.yarn\n+\n+import org.apache.hadoop.yarn.conf.YarnConfiguration\n+import org.apache.spark.{SparkConf, SparkFunSuite}\n+import org.apache.spark.internal.Logging\n+import org.apache.spark.util.ResetSystemProperties\n+import org.scalatest.Matchers\n+\n+class ApplicationMasterUtilSuite extends SparkFunSuite with Matchers with Logging\n+  with ResetSystemProperties {"
  }],
  "prId": 20098
}, {
  "comments": [{
    "author": {
      "login": "vanzin"
    },
    "body": "`Logging` not needed, you're not logging anything.",
    "commit": "03e0e271c58e1a4fe7381b60b06e87e5fe2c3a77",
    "createdAt": "2018-01-02T23:31:35Z",
    "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.deploy.yarn\n+\n+import org.apache.hadoop.yarn.conf.YarnConfiguration\n+import org.apache.spark.{SparkConf, SparkFunSuite}\n+import org.apache.spark.internal.Logging\n+import org.apache.spark.util.ResetSystemProperties\n+import org.scalatest.Matchers\n+\n+class ApplicationMasterUtilSuite extends SparkFunSuite with Matchers with Logging"
  }],
  "prId": 20098
}, {
  "comments": [{
    "author": {
      "login": "vanzin"
    },
    "body": "Use `assert(foo === bar)` (and then you also don't need `Matchers`).\r\n\r\nAlso, better to use interpolation to check. e.g. `foo === s\"http://$host:$post/history/$appId/$attemptId\"`. You can set the history port in `SparkConf` to avoid having to read the default value in some other way.",
    "commit": "03e0e271c58e1a4fe7381b60b06e87e5fe2c3a77",
    "createdAt": "2018-01-02T23:31:56Z",
    "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.deploy.yarn\n+\n+import org.apache.hadoop.yarn.conf.YarnConfiguration\n+import org.apache.spark.{SparkConf, SparkFunSuite}\n+import org.apache.spark.internal.Logging\n+import org.apache.spark.util.ResetSystemProperties\n+import org.scalatest.Matchers\n+\n+class ApplicationMasterUtilSuite extends SparkFunSuite with Matchers with Logging\n+  with ResetSystemProperties {\n+\n+  test(\"history url with hadoop and spark substitutions\") {\n+    val sparkConf = new SparkConf()\n+    sparkConf.set(\"spark.yarn.historyServer.address\",\n+      \"http://${hadoopconf-yarn.resourcemanager.hostname}:${spark.history.ui.port}\")\n+\n+    val yarnConf = new YarnConfiguration()\n+    yarnConf.set(\"yarn.resourcemanager.hostname\", \"rm.host.com\")\n+    val appId = \"application_123_1\"\n+    val attemptId = appId + \"_1\"\n+\n+    val shsAddr = ApplicationMasterUtil\n+      .getHistoryServerAddress(sparkConf, yarnConf, appId, attemptId)\n+\n+    shsAddr shouldEqual \"http://rm.host.com:18080/history/application_123_1/application_123_1_1\""
  }],
  "prId": 20098
}, {
  "comments": [{
    "author": {
      "login": "vanzin"
    },
    "body": "These imports will fail style checks. Make sure to run them locally.",
    "commit": "03e0e271c58e1a4fe7381b60b06e87e5fe2c3a77",
    "createdAt": "2018-01-02T23:32:46Z",
    "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.deploy.yarn\n+\n+import org.apache.hadoop.yarn.conf.YarnConfiguration"
  }],
  "prId": 20098
}]