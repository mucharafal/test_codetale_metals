[{
  "comments": [{
    "author": {
      "login": "jerryshao"
    },
    "body": "The logic looks different compared to the original code, also `1` is minute not millisecond.",
    "commit": "211bbd3234a3641b02b38eae7bc0020ffb5b46d3",
    "createdAt": "2017-02-16T10:02:27Z",
    "diffHunk": "@@ -55,14 +55,10 @@ private[spark] class CredentialUpdater(\n \n   /** Start the credential updater task */\n   def start(): Unit = {\n-    val startTime = sparkConf.get(CREDENTIALS_RENEWAL_TIME)\n-    val remainingTime = startTime - System.currentTimeMillis()\n-    if (remainingTime <= 0) {\n-      credentialUpdater.schedule(credentialUpdaterRunnable, 1, TimeUnit.MINUTES)\n-    } else {\n-      logInfo(s\"Scheduling credentials refresh from HDFS in $remainingTime millis.\")\n-      credentialUpdater.schedule(credentialUpdaterRunnable, remainingTime, TimeUnit.MILLISECONDS)\n-    }\n+    val startTime = sparkConf.get(CREDENTIALS_UPDATE_TIME)\n+    val remainingTime = Math.max(1, startTime - System.currentTimeMillis())"
  }, {
    "author": {
      "login": "yaooqinn"
    },
    "body": "OK, let me change it back",
    "commit": "211bbd3234a3641b02b38eae7bc0020ffb5b46d3",
    "createdAt": "2017-02-16T10:53:12Z",
    "diffHunk": "@@ -55,14 +55,10 @@ private[spark] class CredentialUpdater(\n \n   /** Start the credential updater task */\n   def start(): Unit = {\n-    val startTime = sparkConf.get(CREDENTIALS_RENEWAL_TIME)\n-    val remainingTime = startTime - System.currentTimeMillis()\n-    if (remainingTime <= 0) {\n-      credentialUpdater.schedule(credentialUpdaterRunnable, 1, TimeUnit.MINUTES)\n-    } else {\n-      logInfo(s\"Scheduling credentials refresh from HDFS in $remainingTime millis.\")\n-      credentialUpdater.schedule(credentialUpdaterRunnable, remainingTime, TimeUnit.MILLISECONDS)\n-    }\n+    val startTime = sparkConf.get(CREDENTIALS_UPDATE_TIME)\n+    val remainingTime = Math.max(1, startTime - System.currentTimeMillis())"
  }],
  "prId": 16955
}]