[{
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "I'd create a new suite for all the math functions, since there are so many of them. \n\nNo need for specialization, is there? I doubt it's a bottleneck.\n",
    "commit": "fb271536a68cf3f7ff267953098ce305512c65d0",
    "createdAt": "2015-04-26T07:23:09Z",
    "diffHunk": "@@ -331,4 +331,186 @@ class ColumnExpressionSuite extends QueryTest {\n     assert(schema(\"value\").metadata === Metadata.empty)\n     assert(schema(\"abc\").metadata === metadata)\n   }\n+\n+  def testOneToOneMathFunction[@specialized(Int, Double, Float, Long) T]"
  }],
  "prId": 5616
}, {
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "why is the order by needed?\n",
    "commit": "fb271536a68cf3f7ff267953098ce305512c65d0",
    "createdAt": "2015-04-26T07:24:04Z",
    "diffHunk": "@@ -331,4 +331,186 @@ class ColumnExpressionSuite extends QueryTest {\n     assert(schema(\"value\").metadata === Metadata.empty)\n     assert(schema(\"abc\").metadata === metadata)\n   }\n+\n+  def testOneToOneMathFunction[@specialized(Int, Double, Float, Long) T]\n+      (c: Column => Column, f: T => T): Unit = {\n+    checkAnswer(\n+      doubleData.select(c('a)).orderBy('a.asc),"
  }],
  "prId": 5616
}, {
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "any reason why we chose 100? just wondering if we can reduce this number to 10 to speed things up.\n",
    "commit": "fb271536a68cf3f7ff267953098ce305512c65d0",
    "createdAt": "2015-04-26T07:24:21Z",
    "diffHunk": "@@ -331,4 +331,186 @@ class ColumnExpressionSuite extends QueryTest {\n     assert(schema(\"value\").metadata === Metadata.empty)\n     assert(schema(\"abc\").metadata === metadata)\n   }\n+\n+  def testOneToOneMathFunction[@specialized(Int, Double, Float, Long) T]\n+      (c: Column => Column, f: T => T): Unit = {\n+    checkAnswer(\n+      doubleData.select(c('a)).orderBy('a.asc),\n+      (1 to 100).map(n => Row(f((n * 0.02 - 1).asInstanceOf[T])))"
  }],
  "prId": 5616
}]