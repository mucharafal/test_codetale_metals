[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "Use `checkAnswer`?\r\n\r\n```Scala\r\n    checkAnswer(\r\n      sparkContext.parallelize(Seq[java.lang.Integer](0, null, 2), 1).toDF,\r\n      Seq(Row(0), Row(null), Row(2)))\r\n```",
    "commit": "e1fee6e1c42bed50adb26f399a58028d79267a12",
    "createdAt": "2017-03-22T02:50:43Z",
    "diffHunk": "@@ -51,4 +51,15 @@ class DataFrameImplicitsSuite extends QueryTest with SharedSQLContext {\n       sparkContext.parallelize(1 to 10).map(_.toString).toDF(\"stringCol\"),\n       (1 to 10).map(i => Row(i.toString)))\n   }\n+\n+  test(\"SPARK-19959: df[java.lang.Long].collect includes null throws NullPointerException\") {\n+    val dfInt = sparkContext.parallelize(Seq[java.lang.Integer](0, null, 2), 1).toDF\n+    assert(dfInt.collect === Array(Row(0), Row(null), Row(2)))"
  }, {
    "author": {
      "login": "kiszk"
    },
    "body": "Sure, done",
    "commit": "e1fee6e1c42bed50adb26f399a58028d79267a12",
    "createdAt": "2017-03-22T07:22:44Z",
    "diffHunk": "@@ -51,4 +51,15 @@ class DataFrameImplicitsSuite extends QueryTest with SharedSQLContext {\n       sparkContext.parallelize(1 to 10).map(_.toString).toDF(\"stringCol\"),\n       (1 to 10).map(i => Row(i.toString)))\n   }\n+\n+  test(\"SPARK-19959: df[java.lang.Long].collect includes null throws NullPointerException\") {\n+    val dfInt = sparkContext.parallelize(Seq[java.lang.Integer](0, null, 2), 1).toDF\n+    assert(dfInt.collect === Array(Row(0), Row(null), Row(2)))"
  }],
  "prId": 17302
}]