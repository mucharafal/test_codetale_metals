[{
  "comments": [{
    "author": {
      "login": "davies"
    },
    "body": "Why not have all the tables?\n",
    "commit": "461ab81adbc76f2d04ab5aed46b7ebb24cf5c7af",
    "createdAt": "2016-04-29T03:01:16Z",
    "diffHunk": "@@ -0,0 +1,1225 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.parquet\n+\n+import org.apache.spark.{SparkConf, SparkContext}\n+import org.apache.spark.sql.internal.SQLConf\n+import org.apache.spark.sql.SQLContext\n+import org.apache.spark.sql.catalyst.TableIdentifier\n+import org.apache.spark.sql.catalyst.analysis.UnresolvedRelation\n+import org.apache.spark.util.Benchmark\n+\n+/**\n+ * Benchmark to measure TPCDS query performance.\n+ * To run this:\n+ *  spark-submit --class <this class> --jars <spark sql test jar>\n+ */\n+object TPCDSBenchmark {\n+  val conf = new SparkConf()\n+  conf.set(\"spark.sql.parquet.compression.codec\", \"snappy\")\n+  conf.set(\"spark.sql.shuffle.partitions\", \"4\")\n+  conf.set(\"spark.driver.memory\", \"3g\")\n+  conf.set(\"spark.executor.memory\", \"3g\")\n+  conf.set(\"spark.sql.autoBroadcastJoinThreshold\", (20 * 1024 * 1024).toString)\n+\n+  val sc = new SparkContext(\"local[1]\", \"test-sql-context\", conf)\n+  val sqlContext = new SQLContext(sc)\n+\n+  // These queries a subset of the TPCDS benchmark queries and are taken from\n+  // https://github.com/databricks/spark-sql-perf/blob/master/src/main/scala/com/databricks/spark/\n+  // sql/perf/tpcds/ImpalaKitQueries.scala\n+  val tpcds = Seq(\n+    (\"q19\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  i_manufact_id,\n+              |  i_manufact,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  join customer on (store_sales.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address on\n+              |    (customer.c_current_addr_sk = customer_address.ca_address_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451484 and 2451513\n+              |  and d_moy = 11\n+              |  and d_year = 1999\n+              |  and i_manager_id = 7\n+              |  and substr(ca_zip, 1, 5) <> substr(s_zip, 1, 5)\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q19                                      1710 / 1858          8.7         114.5       1.0X\n+     */\n+\n+    (\"q27\", \"\"\"\n+              |select\n+              |  i_item_id,\n+              |  s_state,\n+              |  avg(ss_quantity) agg1,\n+              |  avg(ss_list_price) agg2,\n+              |  avg(ss_coupon_amt) agg3,\n+              |  avg(ss_sales_price) agg4\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join customer_demographics on\n+              |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2450815 and 2451179  -- partition key filter\n+              |  and d_year = 1998\n+              |  and cd_gender = 'F'\n+              |  and cd_marital_status = 'W'\n+              |  and cd_education_status = 'Primary'\n+              |  and s_state in ('WI', 'CA', 'TX', 'FL', 'WA', 'TN')\n+              |group by\n+              |  i_item_id,\n+              |  s_state\n+              |order by\n+              |  i_item_id,\n+              |  s_state\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q27                                      2016 / 2180          8.2         122.6       1.0X\n+     */\n+\n+    (\"q3\", \"\"\"\n+             |select\n+             |  dt.d_year,\n+             |  item.i_brand_id brand_id,\n+             |  item.i_brand brand,\n+             |  sum(ss_ext_sales_price) sum_agg\n+             |from\n+             |  store_sales\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+             |where\n+             |  item.i_manufact_id = 436\n+             |  and dt.d_moy = 12\n+             |  and (ss_sold_date_sk between 2451149 and 2451179\n+             |    or ss_sold_date_sk between 2451514 and 2451544\n+             |    or ss_sold_date_sk between 2451880 and 2451910\n+             |    or ss_sold_date_sk between 2452245 and 2452275\n+             |    or ss_sold_date_sk between 2452610 and 2452640)\n+             |group by\n+             |  d_year,\n+             |  item.i_brand,\n+             |  item.i_brand_id\n+             |order by\n+             |  d_year,\n+             |  sum_agg desc,\n+             |  brand_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q3                                       1073 / 1140         13.5          73.9       1.0X\n+     */\n+\n+    (\"q34\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    and (date_dim.d_dom between 1 and 3\n+              |      or date_dim.d_dom between 25 and 28)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and (case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end) > 1.2\n+              |    and ss_sold_date_sk between 2450816 and 2451910 -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dn\n+              |join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 15 and 20\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag desc,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q34                                      1482 / 1734         10.0         100.4       1.0X\n+     */\n+\n+    (\"q42\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category,\n+              |  sum(ss_ext_sales_price) as total_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+              |where\n+              |  item.i_manager_id = 1\n+              |  and dt.d_moy = 12\n+              |  and dt.d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179  -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |order by\n+              |  total_price desc,\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q42                                      1125 / 1357         12.9          77.4       1.0X\n+     */\n+\n+    (\"q43\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sum(case when (d_day_name = 'Sunday') then ss_sales_price else null end) sun_sales,\n+              |  sum(case when (d_day_name = 'Monday') then ss_sales_price else null end) mon_sales,\n+              |  sum(case when (d_day_name = 'Tuesday') then\n+              |    ss_sales_price else null end) tue_sales,\n+              |  sum(case when (d_day_name = 'Wednesday') then\n+              |    ss_sales_price else null end) wed_sales,\n+              |  sum(case when (d_day_name = 'Thursday') then\n+              |    ss_sales_price else null end) thu_sales,\n+              |  sum(case when (d_day_name = 'Friday') then ss_sales_price else null end) fri_sales,\n+              |  sum(case when (d_day_name = 'Saturday') then\n+              |    ss_sales_price else null end) sat_sales\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  s_gmt_offset = -5\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2450816 and 2451179  -- partition key filter\n+              |group by\n+              |  s_store_name,\n+              |  s_store_id\n+              |order by\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sun_sales,\n+              |  mon_sales,\n+              |  tue_sales,\n+              |  wed_sales,\n+              |  thu_sales,\n+              |  fri_sales,\n+              |  sat_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q43                                      1681 / 1985          8.6         116.1       1.0X\n+     */\n+\n+    (\"q46\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in ('Midway', 'Concord', 'Spring Hill', 'Brownsville', 'Greenville')\n+              |    and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and date_dim.d_dow in (6, 0)\n+              |    and date_dim.d_year in (1999, 1999 + 1, 1999 + 2)\n+              |      group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q46                                      2948 / 3218          5.1         196.1       1.0X\n+     */\n+\n+    (\"q52\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (store_sales.ss_sold_date_sk = dt.d_date_sk)\n+              |where\n+              |  i_manager_id = 1\n+              |  and d_moy = 12\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179 -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  d_year,\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q52                                      1099 / 1228         13.2          75.7       1.0X\n+     */\n+\n+    (\"q53\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manufact_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275 -- partition key filter\n+              |    and d_month_seq in(1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |         (i_category in('Books', 'Children', 'Electronics')\n+              |           and i_class in('personal', 'portable', 'reference', 'self-help')\n+              |           and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |             'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |         )\n+              |         or\n+              |         (i_category in('Women', 'Music', 'Men')\n+              |           and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |           and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |             'exportiimporto #1', 'importoamalg #1')\n+              |         )\n+              |       )\n+              |  group by\n+              |    i_manufact_id,\n+              |    d_qoy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  i_manufact_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q53                                       968 / 1020         15.0          66.6       1.0X\n+     */\n+\n+    (\"q55\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  i_manager_id = 36\n+              |  and d_moy = 12\n+              |  and d_year = 2001\n+              |  and ss_sold_date_sk between 2452245 and 2452275 -- partition key filter\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q55                                      1002 / 1020         14.5          69.0       1.0X\n+     */\n+\n+    (\"q59\", \"\"\"\n+              |select\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1,\n+              |  sun_sales1 / sun_sales2,\n+              |  mon_sales1 / mon_sales2,\n+              |  tue_sales1 / tue_sales2,\n+              |  wed_sales1 / wed_sales2,\n+              |  thu_sales1 / thu_sales2,\n+              |  fri_sales1 / fri_sales2,\n+              |  sat_sales1 / sat_sales2\n+              |from\n+              |  (select\n+              |    s_store_name s_store_name1,\n+              |    wss.d_week_seq d_week_seq1,\n+              |    s_store_id s_store_id1,\n+              |    sun_sales sun_sales1,\n+              |    mon_sales mon_sales1,\n+              |    tue_sales tue_sales1,\n+              |    wed_sales wed_sales1,\n+              |    thu_sales thu_sales1,\n+              |    fri_sales fri_sales1,\n+              |    sat_sales sat_sales1\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 and 1185 + 11\n+              |  ) y\n+              |  join\n+              |  (select\n+              |    s_store_name s_store_name2,\n+              |    wss.d_week_seq d_week_seq2,\n+              |    s_store_id s_store_id2,\n+              |    sun_sales sun_sales2,\n+              |    mon_sales mon_sales2,\n+              |    tue_sales tue_sales2,\n+              |    wed_sales wed_sales2,\n+              |    thu_sales thu_sales2,\n+              |    fri_sales fri_sales2,\n+              |    sat_sales sat_sales2\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 + 12 and 1185 + 23\n+              |  ) x\n+              |  on (y.s_store_id1 = x.s_store_id2)\n+              |where\n+              |  d_week_seq1 = d_week_seq2 - 52\n+              |order by\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q59                                      1624 / 1663         17.9          55.8       1.0X\n+     */\n+\n+    (\"q63\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manager_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq in (1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |          (i_category in('Books', 'Children', 'Electronics')\n+              |            and i_class in('personal', 'portable', 'refernece', 'self-help')\n+              |            and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |              'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |          )\n+              |          or\n+              |          (i_category in('Women', 'Music', 'Men')\n+              |            and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |            and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |              'exportiimporto #1', 'importoamalg #1')\n+              |          )\n+              |        )\n+              |  group by\n+              |    i_manager_id,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  i_manager_id,\n+              |  sum_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q63                                       979 / 1006         14.8          67.4       1.0X\n+     */\n+\n+    (\"q65\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  i_item_desc,\n+              |  sc.revenue,\n+              |  i_current_price,\n+              |  i_wholesale_cost,\n+              |  i_brand\n+              |from\n+              |  (select\n+              |    ss_store_sk,\n+              |    ss_item_sk,\n+              |    sum(ss_sales_price) as revenue\n+              |  from\n+              |    store_sales\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq between 1212 and 1212 + 11\n+              |  group by\n+              |    ss_store_sk,\n+              |    ss_item_sk\n+              |  ) sc\n+              |  join item on (sc.ss_item_sk = item.i_item_sk)\n+              |  join store on (sc.ss_store_sk = store.s_store_sk)\n+              |  join\n+              |  (select\n+              |    ss_store_sk,\n+              |    avg(revenue) as ave\n+              |  from\n+              |    (select\n+              |      ss_store_sk,\n+              |      ss_item_sk,\n+              |      sum(ss_sales_price) as revenue\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |      and d_month_seq between 1212 and 1212 + 11\n+              |    group by\n+              |      ss_store_sk,\n+              |      ss_item_sk\n+              |    ) sa\n+              |  group by\n+              |    ss_store_sk\n+              |  ) sb on (sc.ss_store_sk = sb.ss_store_sk) -- 676 rows\n+              |where\n+              |  sc.revenue <= 0.1 * sb.ave\n+              |order by\n+              |  s_store_name,\n+              |  i_item_desc\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q65                                      7770 / 8097          3.7         267.9       1.0X\n+     */\n+\n+    (\"q68\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  extended_price,\n+              |  extended_tax,\n+              |  list_price\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_ext_sales_price) extended_price,\n+              |    sum(ss_ext_list_price) list_price,\n+              |    sum(ss_ext_tax) extended_tax\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in('Midway', 'Fairview')\n+              |    --and date_dim.d_dom between 1 and 2\n+              |    --and date_dim.d_year in(1999, 1999 + 1, 1999 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-31'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |        and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and d_date between '1999-01-01' and '1999-03-31'\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q68                                      3105 / 3405          4.8         206.5       1.0X\n+     */\n+\n+    (\"q7\", \"\"\"\n+             |select\n+             |  i_item_id,\n+             |  avg(ss_quantity) agg1,\n+             |  avg(ss_list_price) agg2,\n+             |  avg(ss_coupon_amt) agg3,\n+             |  avg(ss_sales_price) agg4\n+             |from\n+             |  store_sales\n+             |  join customer_demographics on\n+             |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join promotion on (store_sales.ss_promo_sk = promotion.p_promo_sk)\n+             |  join date_dim on (ss_sold_date_sk = d_date_sk)\n+             |where\n+             |  cd_gender = 'F'\n+             |  and cd_marital_status = 'W'\n+             |  and cd_education_status = 'Primary'\n+             |  and (p_channel_email = 'N'\n+             |    or p_channel_event = 'N')\n+             |  and d_year = 1998\n+             |  and ss_sold_date_sk between 2450815 and 2451179 -- partition key filter\n+             |group by\n+             |  i_item_id\n+             |order by\n+             |  i_item_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q7                                       2042 / 2333          8.1         124.2       1.0X\n+     */\n+\n+    (\"q73\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    -- join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    store.s_county in\n+              |      ('Williamson County','Franklin Parish','Bronx County','Orange County')\n+              |    -- and date_dim.d_dom between 1 and 2\n+              |    -- and date_dim.d_year in(1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-02'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |    -- partition key filter\n+              |    -- and ss_sold_date_sk in (2450816, 2450846, 2450847, 2450874, 2450875, 2450905,\n+              |    --                         2450906, 2450935, 2450936, 2450966, 2450967,\n+              |    --                         2450996, 2450997, 2451027, 2451028, 2451058, 2451059,\n+              |    --                         2451088, 2451089, 2451119, 2451120, 2451149,\n+              |    --                         2451150, 2451180, 2451181, 2451211, 2451212, 2451239,\n+              |    --                         2451240, 2451270, 2451271, 2451300, 2451301,\n+              |    --                         2451331, 2451332, 2451361, 2451362, 2451392, 2451393,\n+              |    --                         2451423, 2451424, 2451453, 2451454, 2451484,\n+              |    --                         2451485, 2451514, 2451515, 2451545, 2451546, 2451576,\n+              |    --                         2451577, 2451605, 2451606, 2451636, 2451637,\n+              |    --                         2451666, 2451667, 2451697, 2451698, 2451727, 2451728,\n+              |    --                         2451758, 2451759, 2451789, 2451790, 2451819,\n+              |    --                         2451820, 2451850, 2451851, 2451880, 2451881)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end > 1\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dj\n+              |  join customer on (dj.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 1 and 5\n+              |order by\n+              |  cnt desc\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q73                                      1124 / 1221         13.1          76.5       1.0X\n+     */\n+\n+    (\"q79\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  substr(s_city, 1, 30) as city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    s_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  where\n+              |    store.s_number_employees between 200 and 295\n+              |    and (household_demographics.hd_dep_count = 8\n+              |      or household_demographics.hd_vehicle_count > 0)\n+              |    and date_dim.d_dow = 1\n+              |    and date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1998-01-01' and '2000-12-25'\n+              |    -- 156 days\n+              |  and d_date between '1999-01-01' and '1999-03-31'\n+              |  and ss_sold_date_sk between 2451180 and 2451269  -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    s_city\n+              |  ) ms\n+              |  join customer on (ms.ss_customer_sk = customer.c_customer_sk)\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  city,\n+              |  profit\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q79                                      2029 / 2488          7.3         137.5       1.0X\n+     */\n+\n+      (\"q8\",\n+        \"\"\"\n+          |select  s_store_name\n+          |      ,sum(ss_net_profit)\n+          | from store_sales\n+          |     ,date_dim\n+          |     ,store,\n+          |     (select distinct a01.ca_zip\n+          |     from\n+          |     (SELECT substr(ca_zip,1,5) ca_zip\n+          |      FROM customer_address\n+          |      WHERE substr(ca_zip,1,5) IN ('89436', '30868', '65085', '22977', '83927', '77557',\n+          |      '58429', '40697', '80614', '10502', '32779',\n+          |      '91137', '61265', '98294', '17921', '18427', '21203', '59362', '87291', '84093',\n+          |      '21505', '17184', '10866', '67898', '25797',\n+          |      '28055', '18377', '80332', '74535', '21757', '29742', '90885', '29898', '17819',\n+          |      '40811', '25990', '47513', '89531', '91068',\n+          |      '10391', '18846', '99223', '82637', '41368', '83658', '86199', '81625', '26696',\n+          |      '89338', '88425', '32200', '81427', '19053',\n+          |      '77471', '36610', '99823', '43276', '41249', '48584', '83550', '82276', '18842',\n+          |      '78890', '14090', '38123', '40936', '34425',\n+          |      '19850', '43286', '80072', '79188', '54191', '11395', '50497', '84861', '90733',\n+          |      '21068', '57666', '37119', '25004', '57835',\n+          |      '70067', '62878', '95806', '19303', '18840', '19124', '29785', '16737', '16022',\n+          |      '49613', '89977', '68310', '60069', '98360',\n+          |      '48649', '39050', '41793', '25002', '27413', '39736', '47208', '16515', '94808',\n+          |      '57648', '15009', '80015', '42961', '63982',\n+          |      '21744', '71853', '81087', '67468', '34175', '64008', '20261', '11201', '51799',\n+          |      '48043', '45645', '61163', '48375', '36447',\n+          |      '57042', '21218', '41100', '89951', '22745', '35851', '83326', '61125', '78298',\n+          |      '80752', '49858', '52940', '96976', '63792',\n+          |      '11376', '53582', '18717', '90226', '50530', '94203', '99447', '27670', '96577',\n+          |      '57856', '56372', '16165', '23427', '54561',\n+          |      '28806', '44439', '22926', '30123', '61451', '92397', '56979', '92309', '70873',\n+          |      '13355', '21801', '46346', '37562', '56458',\n+          |      '28286', '47306', '99555', '69399', '26234', '47546', '49661', '88601', '35943',\n+          |      '39936', '25632', '24611', '44166', '56648',\n+          |      '30379', '59785', '11110', '14329', '93815', '52226', '71381', '13842', '25612',\n+          |      '63294', '14664', '21077', '82626', '18799',\n+          |      '60915', '81020', '56447', '76619', '11433', '13414', '42548', '92713', '70467',\n+          |      '30884', '47484', '16072', '38936', '13036',\n+          |      '88376', '45539', '35901', '19506', '65690', '73957', '71850', '49231', '14276',\n+          |      '20005', '18384', '76615', '11635', '38177',\n+          |      '55607', '41369', '95447', '58581', '58149', '91946', '33790', '76232', '75692',\n+          |      '95464', '22246', '51061', '56692', '53121',\n+          |      '77209', '15482', '10688', '14868', '45907', '73520', '72666', '25734', '17959',\n+          |      '24677', '66446', '94627', '53535', '15560',\n+          |      '41967', '69297', '11929', '59403', '33283', '52232', '57350', '43933', '40921',\n+          |      '36635', '10827', '71286', '19736', '80619',\n+          |      '25251', '95042', '15526', '36496', '55854', '49124', '81980', '35375', '49157',\n+          |      '63512', '28944', '14946', '36503', '54010',\n+          |      '18767', '23969', '43905', '66979', '33113', '21286', '58471', '59080', '13395',\n+          |      '79144', '70373', '67031', '38360', '26705',\n+          |      '50906', '52406', '26066', '73146', '15884', '31897', '30045', '61068', '45550',\n+          |      '92454', '13376', '14354', '19770', '22928',\n+          |      '97790', '50723', '46081', '30202', '14410', '20223', '88500', '67298', '13261',\n+          |      '14172', '81410', '93578', '83583', '46047',\n+          |      '94167', '82564', '21156', '15799', '86709', '37931', '74703', '83103', '23054',\n+          |      '70470', '72008', '35709', '91911', '69998',\n+          |      '20961', '70070', '63197', '54853', '88191', '91830', '49521', '19454', '81450',\n+          |      '89091', '62378', '31904', '61869', '51744',\n+          |      '36580', '85778', '36871', '48121', '28810', '83712', '45486', '67393', '26935',\n+          |      '42393', '20132', '55349', '86057', '21309',\n+          |      '80218', '10094', '11357', '48819', '39734', '40758', '30432', '21204', '29467',\n+          |      '30214', '61024', '55307', '74621', '11622',\n+          |      '68908', '33032', '52868', '99194', '99900', '84936', '69036', '99149', '45013',\n+          |      '32895', '59004', '32322', '14933', '32936',\n+          |      '33562', '72550', '27385', '58049', '58200', '16808', '21360', '32961', '18586',\n+          |      '79307', '15492')) a01\n+          |     inner join\n+          |     (select ca_zip\n+          |      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n+          |            FROM customer_address, customer\n+          |            WHERE ca_address_sk = c_current_addr_sk and\n+          |                  c_preferred_cust_flag='Y'\n+          |            group by ca_zip\n+          |            having count(*) > 10)A1\n+          |      ) b11\n+          |      on (a01.ca_zip = b11.ca_zip )) A2\n+          | where ss_store_sk = s_store_sk\n+          |  and ss_sold_date_sk = d_date_sk\n+          |  and ss_sold_date_sk between 2451271 and 2451361\n+          |  and d_qoy = 2 and d_year = 1999\n+          |  and (substr(s_zip,1,2) = substr(a2.ca_zip,1,2))\n+          | group by s_store_name\n+          | order by s_store_name\n+          |limit 100\n+        \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q8                                       1737 / 2197          8.7         115.6       1.0X\n+     */\n+\n+      (\"q82\", \"\"\"\n+                |select\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |from\n+                |  store_sales\n+                |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+                |  join inventory on (item.i_item_sk = inventory.inv_item_sk)\n+                |  join date_dim on (inventory.inv_date_sk = date_dim.d_date_sk)\n+                |where\n+                |  i_current_price between 30 and 30 + 30\n+                |  and i_manufact_id in (437, 129, 727, 663)\n+                |  and inv_quantity_on_hand between 100 and 500\n+                |group by\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |order by\n+                |  i_item_id\n+                |limit 100\n+              \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q82                                     9399 / 10245          6.8         147.2       1.0X\n+     */\n+\n+    (\"q89\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451545 and 2451910  -- partition key filter\n+              |    and d_year in (2000)\n+              |    and ((i_category in('Home', 'Books', 'Electronics')\n+              |          and i_class in('wallpaper', 'parenting', 'musical'))\n+              |        or (i_category in('Shoes', 'Jewelry', 'Men')\n+              |            and i_class in('womens', 'birdal', 'pants'))\n+              |        )\n+              |  group by\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  s_store_name\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q89                                      1122 / 1274         12.9          77.2       1.0X\n+     */\n+\n+    (\"q98\", \"\"\"\n+              |select\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price,\n+              |  sum(ss_ext_sales_price) as itemrevenue\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451911 and 2451941\n+              |  -- partition key filter (1 calendar month)\n+              |  and d_date between '2001-01-01' and '2001-01-31'\n+              |  and i_category in('Jewelry', 'Sports', 'Books')\n+              |group by\n+              |  i_item_id,\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price\n+              |order by\n+              |  i_category,\n+              |  i_class,\n+              |  i_item_id,\n+              |  i_item_desc\n+              |  -- revenueratio\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q98                                      1235 / 1542         11.8          85.0       1.0X\n+     */\n+\n+    (\"ss_max\", \"\"\"\n+                 |select\n+                 |  count(*) as total,\n+                 |  max(ss_sold_date_sk) as max_ss_sold_date_sk,\n+                 |  max(ss_sold_time_sk) as max_ss_sold_time_sk,\n+                 |  max(ss_item_sk) as max_ss_item_sk,\n+                 |  max(ss_customer_sk) as max_ss_customer_sk,\n+                 |  max(ss_cdemo_sk) as max_ss_cdemo_sk,\n+                 |  max(ss_hdemo_sk) as max_ss_hdemo_sk,\n+                 |  max(ss_addr_sk) as max_ss_addr_sk,\n+                 |  max(ss_store_sk) as max_ss_store_sk,\n+                 |  max(ss_promo_sk) as max_ss_promo_sk\n+                 |from store_sales\n+               \"\"\".stripMargin)\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    ss_max                                   2305 / 2731          6.2         160.0       1.0X\n+     */\n+\n+  ).toArray\n+\n+  val tables = Seq(\"customer\", \"customer_address\", \"customer_demographics\", \"date_dim\",\n+    \"household_demographics\", \"inventory\", \"item\", \"promotion\", \"store\", \"catalog_sales\",\n+    \"web_sales\", \"store_sales\")",
    "line": 1185
  }, {
    "author": {
      "login": "sameeragarwal"
    },
    "body": "any particular reason?\n",
    "commit": "461ab81adbc76f2d04ab5aed46b7ebb24cf5c7af",
    "createdAt": "2016-04-29T03:44:35Z",
    "diffHunk": "@@ -0,0 +1,1225 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.parquet\n+\n+import org.apache.spark.{SparkConf, SparkContext}\n+import org.apache.spark.sql.internal.SQLConf\n+import org.apache.spark.sql.SQLContext\n+import org.apache.spark.sql.catalyst.TableIdentifier\n+import org.apache.spark.sql.catalyst.analysis.UnresolvedRelation\n+import org.apache.spark.util.Benchmark\n+\n+/**\n+ * Benchmark to measure TPCDS query performance.\n+ * To run this:\n+ *  spark-submit --class <this class> --jars <spark sql test jar>\n+ */\n+object TPCDSBenchmark {\n+  val conf = new SparkConf()\n+  conf.set(\"spark.sql.parquet.compression.codec\", \"snappy\")\n+  conf.set(\"spark.sql.shuffle.partitions\", \"4\")\n+  conf.set(\"spark.driver.memory\", \"3g\")\n+  conf.set(\"spark.executor.memory\", \"3g\")\n+  conf.set(\"spark.sql.autoBroadcastJoinThreshold\", (20 * 1024 * 1024).toString)\n+\n+  val sc = new SparkContext(\"local[1]\", \"test-sql-context\", conf)\n+  val sqlContext = new SQLContext(sc)\n+\n+  // These queries a subset of the TPCDS benchmark queries and are taken from\n+  // https://github.com/databricks/spark-sql-perf/blob/master/src/main/scala/com/databricks/spark/\n+  // sql/perf/tpcds/ImpalaKitQueries.scala\n+  val tpcds = Seq(\n+    (\"q19\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  i_manufact_id,\n+              |  i_manufact,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  join customer on (store_sales.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address on\n+              |    (customer.c_current_addr_sk = customer_address.ca_address_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451484 and 2451513\n+              |  and d_moy = 11\n+              |  and d_year = 1999\n+              |  and i_manager_id = 7\n+              |  and substr(ca_zip, 1, 5) <> substr(s_zip, 1, 5)\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q19                                      1710 / 1858          8.7         114.5       1.0X\n+     */\n+\n+    (\"q27\", \"\"\"\n+              |select\n+              |  i_item_id,\n+              |  s_state,\n+              |  avg(ss_quantity) agg1,\n+              |  avg(ss_list_price) agg2,\n+              |  avg(ss_coupon_amt) agg3,\n+              |  avg(ss_sales_price) agg4\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join customer_demographics on\n+              |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2450815 and 2451179  -- partition key filter\n+              |  and d_year = 1998\n+              |  and cd_gender = 'F'\n+              |  and cd_marital_status = 'W'\n+              |  and cd_education_status = 'Primary'\n+              |  and s_state in ('WI', 'CA', 'TX', 'FL', 'WA', 'TN')\n+              |group by\n+              |  i_item_id,\n+              |  s_state\n+              |order by\n+              |  i_item_id,\n+              |  s_state\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q27                                      2016 / 2180          8.2         122.6       1.0X\n+     */\n+\n+    (\"q3\", \"\"\"\n+             |select\n+             |  dt.d_year,\n+             |  item.i_brand_id brand_id,\n+             |  item.i_brand brand,\n+             |  sum(ss_ext_sales_price) sum_agg\n+             |from\n+             |  store_sales\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+             |where\n+             |  item.i_manufact_id = 436\n+             |  and dt.d_moy = 12\n+             |  and (ss_sold_date_sk between 2451149 and 2451179\n+             |    or ss_sold_date_sk between 2451514 and 2451544\n+             |    or ss_sold_date_sk between 2451880 and 2451910\n+             |    or ss_sold_date_sk between 2452245 and 2452275\n+             |    or ss_sold_date_sk between 2452610 and 2452640)\n+             |group by\n+             |  d_year,\n+             |  item.i_brand,\n+             |  item.i_brand_id\n+             |order by\n+             |  d_year,\n+             |  sum_agg desc,\n+             |  brand_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q3                                       1073 / 1140         13.5          73.9       1.0X\n+     */\n+\n+    (\"q34\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    and (date_dim.d_dom between 1 and 3\n+              |      or date_dim.d_dom between 25 and 28)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and (case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end) > 1.2\n+              |    and ss_sold_date_sk between 2450816 and 2451910 -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dn\n+              |join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 15 and 20\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag desc,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q34                                      1482 / 1734         10.0         100.4       1.0X\n+     */\n+\n+    (\"q42\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category,\n+              |  sum(ss_ext_sales_price) as total_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+              |where\n+              |  item.i_manager_id = 1\n+              |  and dt.d_moy = 12\n+              |  and dt.d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179  -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |order by\n+              |  total_price desc,\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q42                                      1125 / 1357         12.9          77.4       1.0X\n+     */\n+\n+    (\"q43\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sum(case when (d_day_name = 'Sunday') then ss_sales_price else null end) sun_sales,\n+              |  sum(case when (d_day_name = 'Monday') then ss_sales_price else null end) mon_sales,\n+              |  sum(case when (d_day_name = 'Tuesday') then\n+              |    ss_sales_price else null end) tue_sales,\n+              |  sum(case when (d_day_name = 'Wednesday') then\n+              |    ss_sales_price else null end) wed_sales,\n+              |  sum(case when (d_day_name = 'Thursday') then\n+              |    ss_sales_price else null end) thu_sales,\n+              |  sum(case when (d_day_name = 'Friday') then ss_sales_price else null end) fri_sales,\n+              |  sum(case when (d_day_name = 'Saturday') then\n+              |    ss_sales_price else null end) sat_sales\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  s_gmt_offset = -5\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2450816 and 2451179  -- partition key filter\n+              |group by\n+              |  s_store_name,\n+              |  s_store_id\n+              |order by\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sun_sales,\n+              |  mon_sales,\n+              |  tue_sales,\n+              |  wed_sales,\n+              |  thu_sales,\n+              |  fri_sales,\n+              |  sat_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q43                                      1681 / 1985          8.6         116.1       1.0X\n+     */\n+\n+    (\"q46\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in ('Midway', 'Concord', 'Spring Hill', 'Brownsville', 'Greenville')\n+              |    and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and date_dim.d_dow in (6, 0)\n+              |    and date_dim.d_year in (1999, 1999 + 1, 1999 + 2)\n+              |      group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q46                                      2948 / 3218          5.1         196.1       1.0X\n+     */\n+\n+    (\"q52\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (store_sales.ss_sold_date_sk = dt.d_date_sk)\n+              |where\n+              |  i_manager_id = 1\n+              |  and d_moy = 12\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179 -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  d_year,\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q52                                      1099 / 1228         13.2          75.7       1.0X\n+     */\n+\n+    (\"q53\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manufact_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275 -- partition key filter\n+              |    and d_month_seq in(1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |         (i_category in('Books', 'Children', 'Electronics')\n+              |           and i_class in('personal', 'portable', 'reference', 'self-help')\n+              |           and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |             'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |         )\n+              |         or\n+              |         (i_category in('Women', 'Music', 'Men')\n+              |           and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |           and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |             'exportiimporto #1', 'importoamalg #1')\n+              |         )\n+              |       )\n+              |  group by\n+              |    i_manufact_id,\n+              |    d_qoy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  i_manufact_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q53                                       968 / 1020         15.0          66.6       1.0X\n+     */\n+\n+    (\"q55\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  i_manager_id = 36\n+              |  and d_moy = 12\n+              |  and d_year = 2001\n+              |  and ss_sold_date_sk between 2452245 and 2452275 -- partition key filter\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q55                                      1002 / 1020         14.5          69.0       1.0X\n+     */\n+\n+    (\"q59\", \"\"\"\n+              |select\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1,\n+              |  sun_sales1 / sun_sales2,\n+              |  mon_sales1 / mon_sales2,\n+              |  tue_sales1 / tue_sales2,\n+              |  wed_sales1 / wed_sales2,\n+              |  thu_sales1 / thu_sales2,\n+              |  fri_sales1 / fri_sales2,\n+              |  sat_sales1 / sat_sales2\n+              |from\n+              |  (select\n+              |    s_store_name s_store_name1,\n+              |    wss.d_week_seq d_week_seq1,\n+              |    s_store_id s_store_id1,\n+              |    sun_sales sun_sales1,\n+              |    mon_sales mon_sales1,\n+              |    tue_sales tue_sales1,\n+              |    wed_sales wed_sales1,\n+              |    thu_sales thu_sales1,\n+              |    fri_sales fri_sales1,\n+              |    sat_sales sat_sales1\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 and 1185 + 11\n+              |  ) y\n+              |  join\n+              |  (select\n+              |    s_store_name s_store_name2,\n+              |    wss.d_week_seq d_week_seq2,\n+              |    s_store_id s_store_id2,\n+              |    sun_sales sun_sales2,\n+              |    mon_sales mon_sales2,\n+              |    tue_sales tue_sales2,\n+              |    wed_sales wed_sales2,\n+              |    thu_sales thu_sales2,\n+              |    fri_sales fri_sales2,\n+              |    sat_sales sat_sales2\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 + 12 and 1185 + 23\n+              |  ) x\n+              |  on (y.s_store_id1 = x.s_store_id2)\n+              |where\n+              |  d_week_seq1 = d_week_seq2 - 52\n+              |order by\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q59                                      1624 / 1663         17.9          55.8       1.0X\n+     */\n+\n+    (\"q63\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manager_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq in (1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |          (i_category in('Books', 'Children', 'Electronics')\n+              |            and i_class in('personal', 'portable', 'refernece', 'self-help')\n+              |            and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |              'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |          )\n+              |          or\n+              |          (i_category in('Women', 'Music', 'Men')\n+              |            and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |            and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |              'exportiimporto #1', 'importoamalg #1')\n+              |          )\n+              |        )\n+              |  group by\n+              |    i_manager_id,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  i_manager_id,\n+              |  sum_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q63                                       979 / 1006         14.8          67.4       1.0X\n+     */\n+\n+    (\"q65\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  i_item_desc,\n+              |  sc.revenue,\n+              |  i_current_price,\n+              |  i_wholesale_cost,\n+              |  i_brand\n+              |from\n+              |  (select\n+              |    ss_store_sk,\n+              |    ss_item_sk,\n+              |    sum(ss_sales_price) as revenue\n+              |  from\n+              |    store_sales\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq between 1212 and 1212 + 11\n+              |  group by\n+              |    ss_store_sk,\n+              |    ss_item_sk\n+              |  ) sc\n+              |  join item on (sc.ss_item_sk = item.i_item_sk)\n+              |  join store on (sc.ss_store_sk = store.s_store_sk)\n+              |  join\n+              |  (select\n+              |    ss_store_sk,\n+              |    avg(revenue) as ave\n+              |  from\n+              |    (select\n+              |      ss_store_sk,\n+              |      ss_item_sk,\n+              |      sum(ss_sales_price) as revenue\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |      and d_month_seq between 1212 and 1212 + 11\n+              |    group by\n+              |      ss_store_sk,\n+              |      ss_item_sk\n+              |    ) sa\n+              |  group by\n+              |    ss_store_sk\n+              |  ) sb on (sc.ss_store_sk = sb.ss_store_sk) -- 676 rows\n+              |where\n+              |  sc.revenue <= 0.1 * sb.ave\n+              |order by\n+              |  s_store_name,\n+              |  i_item_desc\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q65                                      7770 / 8097          3.7         267.9       1.0X\n+     */\n+\n+    (\"q68\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  extended_price,\n+              |  extended_tax,\n+              |  list_price\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_ext_sales_price) extended_price,\n+              |    sum(ss_ext_list_price) list_price,\n+              |    sum(ss_ext_tax) extended_tax\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in('Midway', 'Fairview')\n+              |    --and date_dim.d_dom between 1 and 2\n+              |    --and date_dim.d_year in(1999, 1999 + 1, 1999 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-31'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |        and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and d_date between '1999-01-01' and '1999-03-31'\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q68                                      3105 / 3405          4.8         206.5       1.0X\n+     */\n+\n+    (\"q7\", \"\"\"\n+             |select\n+             |  i_item_id,\n+             |  avg(ss_quantity) agg1,\n+             |  avg(ss_list_price) agg2,\n+             |  avg(ss_coupon_amt) agg3,\n+             |  avg(ss_sales_price) agg4\n+             |from\n+             |  store_sales\n+             |  join customer_demographics on\n+             |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join promotion on (store_sales.ss_promo_sk = promotion.p_promo_sk)\n+             |  join date_dim on (ss_sold_date_sk = d_date_sk)\n+             |where\n+             |  cd_gender = 'F'\n+             |  and cd_marital_status = 'W'\n+             |  and cd_education_status = 'Primary'\n+             |  and (p_channel_email = 'N'\n+             |    or p_channel_event = 'N')\n+             |  and d_year = 1998\n+             |  and ss_sold_date_sk between 2450815 and 2451179 -- partition key filter\n+             |group by\n+             |  i_item_id\n+             |order by\n+             |  i_item_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q7                                       2042 / 2333          8.1         124.2       1.0X\n+     */\n+\n+    (\"q73\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    -- join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    store.s_county in\n+              |      ('Williamson County','Franklin Parish','Bronx County','Orange County')\n+              |    -- and date_dim.d_dom between 1 and 2\n+              |    -- and date_dim.d_year in(1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-02'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |    -- partition key filter\n+              |    -- and ss_sold_date_sk in (2450816, 2450846, 2450847, 2450874, 2450875, 2450905,\n+              |    --                         2450906, 2450935, 2450936, 2450966, 2450967,\n+              |    --                         2450996, 2450997, 2451027, 2451028, 2451058, 2451059,\n+              |    --                         2451088, 2451089, 2451119, 2451120, 2451149,\n+              |    --                         2451150, 2451180, 2451181, 2451211, 2451212, 2451239,\n+              |    --                         2451240, 2451270, 2451271, 2451300, 2451301,\n+              |    --                         2451331, 2451332, 2451361, 2451362, 2451392, 2451393,\n+              |    --                         2451423, 2451424, 2451453, 2451454, 2451484,\n+              |    --                         2451485, 2451514, 2451515, 2451545, 2451546, 2451576,\n+              |    --                         2451577, 2451605, 2451606, 2451636, 2451637,\n+              |    --                         2451666, 2451667, 2451697, 2451698, 2451727, 2451728,\n+              |    --                         2451758, 2451759, 2451789, 2451790, 2451819,\n+              |    --                         2451820, 2451850, 2451851, 2451880, 2451881)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end > 1\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dj\n+              |  join customer on (dj.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 1 and 5\n+              |order by\n+              |  cnt desc\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q73                                      1124 / 1221         13.1          76.5       1.0X\n+     */\n+\n+    (\"q79\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  substr(s_city, 1, 30) as city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    s_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  where\n+              |    store.s_number_employees between 200 and 295\n+              |    and (household_demographics.hd_dep_count = 8\n+              |      or household_demographics.hd_vehicle_count > 0)\n+              |    and date_dim.d_dow = 1\n+              |    and date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1998-01-01' and '2000-12-25'\n+              |    -- 156 days\n+              |  and d_date between '1999-01-01' and '1999-03-31'\n+              |  and ss_sold_date_sk between 2451180 and 2451269  -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    s_city\n+              |  ) ms\n+              |  join customer on (ms.ss_customer_sk = customer.c_customer_sk)\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  city,\n+              |  profit\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q79                                      2029 / 2488          7.3         137.5       1.0X\n+     */\n+\n+      (\"q8\",\n+        \"\"\"\n+          |select  s_store_name\n+          |      ,sum(ss_net_profit)\n+          | from store_sales\n+          |     ,date_dim\n+          |     ,store,\n+          |     (select distinct a01.ca_zip\n+          |     from\n+          |     (SELECT substr(ca_zip,1,5) ca_zip\n+          |      FROM customer_address\n+          |      WHERE substr(ca_zip,1,5) IN ('89436', '30868', '65085', '22977', '83927', '77557',\n+          |      '58429', '40697', '80614', '10502', '32779',\n+          |      '91137', '61265', '98294', '17921', '18427', '21203', '59362', '87291', '84093',\n+          |      '21505', '17184', '10866', '67898', '25797',\n+          |      '28055', '18377', '80332', '74535', '21757', '29742', '90885', '29898', '17819',\n+          |      '40811', '25990', '47513', '89531', '91068',\n+          |      '10391', '18846', '99223', '82637', '41368', '83658', '86199', '81625', '26696',\n+          |      '89338', '88425', '32200', '81427', '19053',\n+          |      '77471', '36610', '99823', '43276', '41249', '48584', '83550', '82276', '18842',\n+          |      '78890', '14090', '38123', '40936', '34425',\n+          |      '19850', '43286', '80072', '79188', '54191', '11395', '50497', '84861', '90733',\n+          |      '21068', '57666', '37119', '25004', '57835',\n+          |      '70067', '62878', '95806', '19303', '18840', '19124', '29785', '16737', '16022',\n+          |      '49613', '89977', '68310', '60069', '98360',\n+          |      '48649', '39050', '41793', '25002', '27413', '39736', '47208', '16515', '94808',\n+          |      '57648', '15009', '80015', '42961', '63982',\n+          |      '21744', '71853', '81087', '67468', '34175', '64008', '20261', '11201', '51799',\n+          |      '48043', '45645', '61163', '48375', '36447',\n+          |      '57042', '21218', '41100', '89951', '22745', '35851', '83326', '61125', '78298',\n+          |      '80752', '49858', '52940', '96976', '63792',\n+          |      '11376', '53582', '18717', '90226', '50530', '94203', '99447', '27670', '96577',\n+          |      '57856', '56372', '16165', '23427', '54561',\n+          |      '28806', '44439', '22926', '30123', '61451', '92397', '56979', '92309', '70873',\n+          |      '13355', '21801', '46346', '37562', '56458',\n+          |      '28286', '47306', '99555', '69399', '26234', '47546', '49661', '88601', '35943',\n+          |      '39936', '25632', '24611', '44166', '56648',\n+          |      '30379', '59785', '11110', '14329', '93815', '52226', '71381', '13842', '25612',\n+          |      '63294', '14664', '21077', '82626', '18799',\n+          |      '60915', '81020', '56447', '76619', '11433', '13414', '42548', '92713', '70467',\n+          |      '30884', '47484', '16072', '38936', '13036',\n+          |      '88376', '45539', '35901', '19506', '65690', '73957', '71850', '49231', '14276',\n+          |      '20005', '18384', '76615', '11635', '38177',\n+          |      '55607', '41369', '95447', '58581', '58149', '91946', '33790', '76232', '75692',\n+          |      '95464', '22246', '51061', '56692', '53121',\n+          |      '77209', '15482', '10688', '14868', '45907', '73520', '72666', '25734', '17959',\n+          |      '24677', '66446', '94627', '53535', '15560',\n+          |      '41967', '69297', '11929', '59403', '33283', '52232', '57350', '43933', '40921',\n+          |      '36635', '10827', '71286', '19736', '80619',\n+          |      '25251', '95042', '15526', '36496', '55854', '49124', '81980', '35375', '49157',\n+          |      '63512', '28944', '14946', '36503', '54010',\n+          |      '18767', '23969', '43905', '66979', '33113', '21286', '58471', '59080', '13395',\n+          |      '79144', '70373', '67031', '38360', '26705',\n+          |      '50906', '52406', '26066', '73146', '15884', '31897', '30045', '61068', '45550',\n+          |      '92454', '13376', '14354', '19770', '22928',\n+          |      '97790', '50723', '46081', '30202', '14410', '20223', '88500', '67298', '13261',\n+          |      '14172', '81410', '93578', '83583', '46047',\n+          |      '94167', '82564', '21156', '15799', '86709', '37931', '74703', '83103', '23054',\n+          |      '70470', '72008', '35709', '91911', '69998',\n+          |      '20961', '70070', '63197', '54853', '88191', '91830', '49521', '19454', '81450',\n+          |      '89091', '62378', '31904', '61869', '51744',\n+          |      '36580', '85778', '36871', '48121', '28810', '83712', '45486', '67393', '26935',\n+          |      '42393', '20132', '55349', '86057', '21309',\n+          |      '80218', '10094', '11357', '48819', '39734', '40758', '30432', '21204', '29467',\n+          |      '30214', '61024', '55307', '74621', '11622',\n+          |      '68908', '33032', '52868', '99194', '99900', '84936', '69036', '99149', '45013',\n+          |      '32895', '59004', '32322', '14933', '32936',\n+          |      '33562', '72550', '27385', '58049', '58200', '16808', '21360', '32961', '18586',\n+          |      '79307', '15492')) a01\n+          |     inner join\n+          |     (select ca_zip\n+          |      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n+          |            FROM customer_address, customer\n+          |            WHERE ca_address_sk = c_current_addr_sk and\n+          |                  c_preferred_cust_flag='Y'\n+          |            group by ca_zip\n+          |            having count(*) > 10)A1\n+          |      ) b11\n+          |      on (a01.ca_zip = b11.ca_zip )) A2\n+          | where ss_store_sk = s_store_sk\n+          |  and ss_sold_date_sk = d_date_sk\n+          |  and ss_sold_date_sk between 2451271 and 2451361\n+          |  and d_qoy = 2 and d_year = 1999\n+          |  and (substr(s_zip,1,2) = substr(a2.ca_zip,1,2))\n+          | group by s_store_name\n+          | order by s_store_name\n+          |limit 100\n+        \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q8                                       1737 / 2197          8.7         115.6       1.0X\n+     */\n+\n+      (\"q82\", \"\"\"\n+                |select\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |from\n+                |  store_sales\n+                |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+                |  join inventory on (item.i_item_sk = inventory.inv_item_sk)\n+                |  join date_dim on (inventory.inv_date_sk = date_dim.d_date_sk)\n+                |where\n+                |  i_current_price between 30 and 30 + 30\n+                |  and i_manufact_id in (437, 129, 727, 663)\n+                |  and inv_quantity_on_hand between 100 and 500\n+                |group by\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |order by\n+                |  i_item_id\n+                |limit 100\n+              \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q82                                     9399 / 10245          6.8         147.2       1.0X\n+     */\n+\n+    (\"q89\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451545 and 2451910  -- partition key filter\n+              |    and d_year in (2000)\n+              |    and ((i_category in('Home', 'Books', 'Electronics')\n+              |          and i_class in('wallpaper', 'parenting', 'musical'))\n+              |        or (i_category in('Shoes', 'Jewelry', 'Men')\n+              |            and i_class in('womens', 'birdal', 'pants'))\n+              |        )\n+              |  group by\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  s_store_name\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q89                                      1122 / 1274         12.9          77.2       1.0X\n+     */\n+\n+    (\"q98\", \"\"\"\n+              |select\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price,\n+              |  sum(ss_ext_sales_price) as itemrevenue\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451911 and 2451941\n+              |  -- partition key filter (1 calendar month)\n+              |  and d_date between '2001-01-01' and '2001-01-31'\n+              |  and i_category in('Jewelry', 'Sports', 'Books')\n+              |group by\n+              |  i_item_id,\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price\n+              |order by\n+              |  i_category,\n+              |  i_class,\n+              |  i_item_id,\n+              |  i_item_desc\n+              |  -- revenueratio\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q98                                      1235 / 1542         11.8          85.0       1.0X\n+     */\n+\n+    (\"ss_max\", \"\"\"\n+                 |select\n+                 |  count(*) as total,\n+                 |  max(ss_sold_date_sk) as max_ss_sold_date_sk,\n+                 |  max(ss_sold_time_sk) as max_ss_sold_time_sk,\n+                 |  max(ss_item_sk) as max_ss_item_sk,\n+                 |  max(ss_customer_sk) as max_ss_customer_sk,\n+                 |  max(ss_cdemo_sk) as max_ss_cdemo_sk,\n+                 |  max(ss_hdemo_sk) as max_ss_hdemo_sk,\n+                 |  max(ss_addr_sk) as max_ss_addr_sk,\n+                 |  max(ss_store_sk) as max_ss_store_sk,\n+                 |  max(ss_promo_sk) as max_ss_promo_sk\n+                 |from store_sales\n+               \"\"\".stripMargin)\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    ss_max                                   2305 / 2731          6.2         160.0       1.0X\n+     */\n+\n+  ).toArray\n+\n+  val tables = Seq(\"customer\", \"customer_address\", \"customer_demographics\", \"date_dim\",\n+    \"household_demographics\", \"inventory\", \"item\", \"promotion\", \"store\", \"catalog_sales\",\n+    \"web_sales\", \"store_sales\")",
    "line": 1185
  }, {
    "author": {
      "login": "rxin"
    },
    "body": "It's good to have them for sure in the future. Anyway this is OK for now.\n",
    "commit": "461ab81adbc76f2d04ab5aed46b7ebb24cf5c7af",
    "createdAt": "2016-04-29T07:52:11Z",
    "diffHunk": "@@ -0,0 +1,1225 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.parquet\n+\n+import org.apache.spark.{SparkConf, SparkContext}\n+import org.apache.spark.sql.internal.SQLConf\n+import org.apache.spark.sql.SQLContext\n+import org.apache.spark.sql.catalyst.TableIdentifier\n+import org.apache.spark.sql.catalyst.analysis.UnresolvedRelation\n+import org.apache.spark.util.Benchmark\n+\n+/**\n+ * Benchmark to measure TPCDS query performance.\n+ * To run this:\n+ *  spark-submit --class <this class> --jars <spark sql test jar>\n+ */\n+object TPCDSBenchmark {\n+  val conf = new SparkConf()\n+  conf.set(\"spark.sql.parquet.compression.codec\", \"snappy\")\n+  conf.set(\"spark.sql.shuffle.partitions\", \"4\")\n+  conf.set(\"spark.driver.memory\", \"3g\")\n+  conf.set(\"spark.executor.memory\", \"3g\")\n+  conf.set(\"spark.sql.autoBroadcastJoinThreshold\", (20 * 1024 * 1024).toString)\n+\n+  val sc = new SparkContext(\"local[1]\", \"test-sql-context\", conf)\n+  val sqlContext = new SQLContext(sc)\n+\n+  // These queries a subset of the TPCDS benchmark queries and are taken from\n+  // https://github.com/databricks/spark-sql-perf/blob/master/src/main/scala/com/databricks/spark/\n+  // sql/perf/tpcds/ImpalaKitQueries.scala\n+  val tpcds = Seq(\n+    (\"q19\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  i_manufact_id,\n+              |  i_manufact,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  join customer on (store_sales.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address on\n+              |    (customer.c_current_addr_sk = customer_address.ca_address_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451484 and 2451513\n+              |  and d_moy = 11\n+              |  and d_year = 1999\n+              |  and i_manager_id = 7\n+              |  and substr(ca_zip, 1, 5) <> substr(s_zip, 1, 5)\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand,\n+              |  i_brand_id,\n+              |  i_manufact_id,\n+              |  i_manufact\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q19                                      1710 / 1858          8.7         114.5       1.0X\n+     */\n+\n+    (\"q27\", \"\"\"\n+              |select\n+              |  i_item_id,\n+              |  s_state,\n+              |  avg(ss_quantity) agg1,\n+              |  avg(ss_list_price) agg2,\n+              |  avg(ss_coupon_amt) agg3,\n+              |  avg(ss_sales_price) agg4\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join customer_demographics on\n+              |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2450815 and 2451179  -- partition key filter\n+              |  and d_year = 1998\n+              |  and cd_gender = 'F'\n+              |  and cd_marital_status = 'W'\n+              |  and cd_education_status = 'Primary'\n+              |  and s_state in ('WI', 'CA', 'TX', 'FL', 'WA', 'TN')\n+              |group by\n+              |  i_item_id,\n+              |  s_state\n+              |order by\n+              |  i_item_id,\n+              |  s_state\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q27                                      2016 / 2180          8.2         122.6       1.0X\n+     */\n+\n+    (\"q3\", \"\"\"\n+             |select\n+             |  dt.d_year,\n+             |  item.i_brand_id brand_id,\n+             |  item.i_brand brand,\n+             |  sum(ss_ext_sales_price) sum_agg\n+             |from\n+             |  store_sales\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+             |where\n+             |  item.i_manufact_id = 436\n+             |  and dt.d_moy = 12\n+             |  and (ss_sold_date_sk between 2451149 and 2451179\n+             |    or ss_sold_date_sk between 2451514 and 2451544\n+             |    or ss_sold_date_sk between 2451880 and 2451910\n+             |    or ss_sold_date_sk between 2452245 and 2452275\n+             |    or ss_sold_date_sk between 2452610 and 2452640)\n+             |group by\n+             |  d_year,\n+             |  item.i_brand,\n+             |  item.i_brand_id\n+             |order by\n+             |  d_year,\n+             |  sum_agg desc,\n+             |  brand_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q3                                       1073 / 1140         13.5          73.9       1.0X\n+     */\n+\n+    (\"q34\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    and (date_dim.d_dom between 1 and 3\n+              |      or date_dim.d_dom between 25 and 28)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and (case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end) > 1.2\n+              |    and ss_sold_date_sk between 2450816 and 2451910 -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dn\n+              |join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 15 and 20\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag desc,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q34                                      1482 / 1734         10.0         100.4       1.0X\n+     */\n+\n+    (\"q42\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category,\n+              |  sum(ss_ext_sales_price) as total_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (dt.d_date_sk = store_sales.ss_sold_date_sk)\n+              |where\n+              |  item.i_manager_id = 1\n+              |  and dt.d_moy = 12\n+              |  and dt.d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179  -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |order by\n+              |  total_price desc,\n+              |  d_year,\n+              |  i_category_id,\n+              |  i_category\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q42                                      1125 / 1357         12.9          77.4       1.0X\n+     */\n+\n+    (\"q43\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sum(case when (d_day_name = 'Sunday') then ss_sales_price else null end) sun_sales,\n+              |  sum(case when (d_day_name = 'Monday') then ss_sales_price else null end) mon_sales,\n+              |  sum(case when (d_day_name = 'Tuesday') then\n+              |    ss_sales_price else null end) tue_sales,\n+              |  sum(case when (d_day_name = 'Wednesday') then\n+              |    ss_sales_price else null end) wed_sales,\n+              |  sum(case when (d_day_name = 'Thursday') then\n+              |    ss_sales_price else null end) thu_sales,\n+              |  sum(case when (d_day_name = 'Friday') then ss_sales_price else null end) fri_sales,\n+              |  sum(case when (d_day_name = 'Saturday') then\n+              |    ss_sales_price else null end) sat_sales\n+              |from\n+              |  store_sales\n+              |  join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  s_gmt_offset = -5\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2450816 and 2451179  -- partition key filter\n+              |group by\n+              |  s_store_name,\n+              |  s_store_id\n+              |order by\n+              |  s_store_name,\n+              |  s_store_id,\n+              |  sun_sales,\n+              |  mon_sales,\n+              |  tue_sales,\n+              |  wed_sales,\n+              |  thu_sales,\n+              |  fri_sales,\n+              |  sat_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q43                                      1681 / 1985          8.6         116.1       1.0X\n+     */\n+\n+    (\"q46\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in ('Midway', 'Concord', 'Spring Hill', 'Brownsville', 'Greenville')\n+              |    and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and date_dim.d_dow in (6, 0)\n+              |    and date_dim.d_year in (1999, 1999 + 1, 1999 + 2)\n+              |      group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q46                                      2948 / 3218          5.1         196.1       1.0X\n+     */\n+\n+    (\"q52\", \"\"\"\n+              |select\n+              |  d_year,\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim dt on (store_sales.ss_sold_date_sk = dt.d_date_sk)\n+              |where\n+              |  i_manager_id = 1\n+              |  and d_moy = 12\n+              |  and d_year = 1998\n+              |  and ss_sold_date_sk between 2451149 and 2451179 -- partition key filter\n+              |group by\n+              |  d_year,\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  d_year,\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q52                                      1099 / 1228         13.2          75.7       1.0X\n+     */\n+\n+    (\"q53\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manufact_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275 -- partition key filter\n+              |    and d_month_seq in(1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |         (i_category in('Books', 'Children', 'Electronics')\n+              |           and i_class in('personal', 'portable', 'reference', 'self-help')\n+              |           and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |             'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |         )\n+              |         or\n+              |         (i_category in('Women', 'Music', 'Men')\n+              |           and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |           and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |             'exportiimporto #1', 'importoamalg #1')\n+              |         )\n+              |       )\n+              |  group by\n+              |    i_manufact_id,\n+              |    d_qoy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  i_manufact_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q53                                       968 / 1020         15.0          66.6       1.0X\n+     */\n+\n+    (\"q55\", \"\"\"\n+              |select\n+              |  i_brand_id,\n+              |  i_brand,\n+              |  sum(ss_ext_sales_price) ext_price\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  i_manager_id = 36\n+              |  and d_moy = 12\n+              |  and d_year = 2001\n+              |  and ss_sold_date_sk between 2452245 and 2452275 -- partition key filter\n+              |group by\n+              |  i_brand,\n+              |  i_brand_id\n+              |order by\n+              |  ext_price desc,\n+              |  i_brand_id\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q55                                      1002 / 1020         14.5          69.0       1.0X\n+     */\n+\n+    (\"q59\", \"\"\"\n+              |select\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1,\n+              |  sun_sales1 / sun_sales2,\n+              |  mon_sales1 / mon_sales2,\n+              |  tue_sales1 / tue_sales2,\n+              |  wed_sales1 / wed_sales2,\n+              |  thu_sales1 / thu_sales2,\n+              |  fri_sales1 / fri_sales2,\n+              |  sat_sales1 / sat_sales2\n+              |from\n+              |  (select\n+              |    s_store_name s_store_name1,\n+              |    wss.d_week_seq d_week_seq1,\n+              |    s_store_id s_store_id1,\n+              |    sun_sales sun_sales1,\n+              |    mon_sales mon_sales1,\n+              |    tue_sales tue_sales1,\n+              |    wed_sales wed_sales1,\n+              |    thu_sales thu_sales1,\n+              |    fri_sales fri_sales1,\n+              |    sat_sales sat_sales1\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 and 1185 + 11\n+              |  ) y\n+              |  join\n+              |  (select\n+              |    s_store_name s_store_name2,\n+              |    wss.d_week_seq d_week_seq2,\n+              |    s_store_id s_store_id2,\n+              |    sun_sales sun_sales2,\n+              |    mon_sales mon_sales2,\n+              |    tue_sales tue_sales2,\n+              |    wed_sales wed_sales2,\n+              |    thu_sales thu_sales2,\n+              |    fri_sales fri_sales2,\n+              |    sat_sales sat_sales2\n+              |  from\n+              |    (select\n+              |      d_week_seq,\n+              |      ss_store_sk,\n+              |      sum(case when(d_day_name = 'Sunday') then\n+              |        ss_sales_price else null end) sun_sales,\n+              |      sum(case when(d_day_name = 'Monday') then\n+              |        ss_sales_price else null end) mon_sales,\n+              |      sum(case when(d_day_name = 'Tuesday') then\n+              |        ss_sales_price else null end) tue_sales,\n+              |      sum(case when(d_day_name = 'Wednesday') then\n+              |        ss_sales_price else null end) wed_sales,\n+              |      sum(case when(d_day_name = 'Thursday') then\n+              |        ss_sales_price else null end) thu_sales,\n+              |      sum(case when(d_day_name = 'Friday') then\n+              |        ss_sales_price else null end) fri_sales,\n+              |      sum(case when(d_day_name = 'Saturday') then\n+              |        ss_sales_price else null end) sat_sales\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451088 and 2451452\n+              |    group by\n+              |      d_week_seq,\n+              |      ss_store_sk\n+              |    ) wss\n+              |    join store on (wss.ss_store_sk = store.s_store_sk)\n+              |    join date_dim d on (wss.d_week_seq = d.d_week_seq)\n+              |  where\n+              |    d_month_seq between 1185 + 12 and 1185 + 23\n+              |  ) x\n+              |  on (y.s_store_id1 = x.s_store_id2)\n+              |where\n+              |  d_week_seq1 = d_week_seq2 - 52\n+              |order by\n+              |  s_store_name1,\n+              |  s_store_id1,\n+              |  d_week_seq1\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q59                                      1624 / 1663         17.9          55.8       1.0X\n+     */\n+\n+    (\"q63\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_manager_id,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq in (1212, 1212 + 1, 1212 + 2, 1212 + 3, 1212 + 4, 1212 + 5,\n+              |      1212 + 6, 1212 + 7, 1212 + 8, 1212 + 9, 1212 + 10, 1212 + 11)\n+              |    and (\n+              |          (i_category in('Books', 'Children', 'Electronics')\n+              |            and i_class in('personal', 'portable', 'refernece', 'self-help')\n+              |            and i_brand in('scholaramalgamalg #14', 'scholaramalgamalg #7',\n+              |              'exportiunivamalg #9', 'scholaramalgamalg #9')\n+              |          )\n+              |          or\n+              |          (i_category in('Women', 'Music', 'Men')\n+              |            and i_class in('accessories', 'classical', 'fragrances', 'pants')\n+              |            and i_brand in('amalgimporto #1', 'edu packscholar #1',\n+              |              'exportiimporto #1', 'importoamalg #1')\n+              |          )\n+              |        )\n+              |  group by\n+              |    i_manager_id,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  i_manager_id,\n+              |  sum_sales\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q63                                       979 / 1006         14.8          67.4       1.0X\n+     */\n+\n+    (\"q65\", \"\"\"\n+              |select\n+              |  s_store_name,\n+              |  i_item_desc,\n+              |  sc.revenue,\n+              |  i_current_price,\n+              |  i_wholesale_cost,\n+              |  i_brand\n+              |from\n+              |  (select\n+              |    ss_store_sk,\n+              |    ss_item_sk,\n+              |    sum(ss_sales_price) as revenue\n+              |  from\n+              |    store_sales\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |    and d_month_seq between 1212 and 1212 + 11\n+              |  group by\n+              |    ss_store_sk,\n+              |    ss_item_sk\n+              |  ) sc\n+              |  join item on (sc.ss_item_sk = item.i_item_sk)\n+              |  join store on (sc.ss_store_sk = store.s_store_sk)\n+              |  join\n+              |  (select\n+              |    ss_store_sk,\n+              |    avg(revenue) as ave\n+              |  from\n+              |    (select\n+              |      ss_store_sk,\n+              |      ss_item_sk,\n+              |      sum(ss_sales_price) as revenue\n+              |    from\n+              |      store_sales\n+              |      join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    where\n+              |      ss_sold_date_sk between 2451911 and 2452275  -- partition key filter\n+              |      and d_month_seq between 1212 and 1212 + 11\n+              |    group by\n+              |      ss_store_sk,\n+              |      ss_item_sk\n+              |    ) sa\n+              |  group by\n+              |    ss_store_sk\n+              |  ) sb on (sc.ss_store_sk = sb.ss_store_sk) -- 676 rows\n+              |where\n+              |  sc.revenue <= 0.1 * sb.ave\n+              |order by\n+              |  s_store_name,\n+              |  i_item_desc\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q65                                      7770 / 8097          3.7         267.9       1.0X\n+     */\n+\n+    (\"q68\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  ca_city,\n+              |  bought_city,\n+              |  ss_ticket_number,\n+              |  extended_price,\n+              |  extended_tax,\n+              |  list_price\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ca_city bought_city,\n+              |    sum(ss_ext_sales_price) extended_price,\n+              |    sum(ss_ext_list_price) list_price,\n+              |    sum(ss_ext_tax) extended_tax\n+              |  from\n+              |    store_sales\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join customer_address on\n+              |      (store_sales.ss_addr_sk = customer_address.ca_address_sk)\n+              |  where\n+              |    store.s_city in('Midway', 'Fairview')\n+              |    --and date_dim.d_dom between 1 and 2\n+              |    --and date_dim.d_year in(1999, 1999 + 1, 1999 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-31'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |        and (household_demographics.hd_dep_count = 5\n+              |      or household_demographics.hd_vehicle_count = 3)\n+              |    and d_date between '1999-01-01' and '1999-03-31'\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    ca_city\n+              |  ) dn\n+              |  join customer on (dn.ss_customer_sk = customer.c_customer_sk)\n+              |  join customer_address current_addr on\n+              |    (customer.c_current_addr_sk = current_addr.ca_address_sk)\n+              |where\n+              |  current_addr.ca_city <> bought_city\n+              |order by\n+              |  c_last_name,\n+              |  ss_ticket_number\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q68                                      3105 / 3405          4.8         206.5       1.0X\n+     */\n+\n+    (\"q7\", \"\"\"\n+             |select\n+             |  i_item_id,\n+             |  avg(ss_quantity) agg1,\n+             |  avg(ss_list_price) agg2,\n+             |  avg(ss_coupon_amt) agg3,\n+             |  avg(ss_sales_price) agg4\n+             |from\n+             |  store_sales\n+             |  join customer_demographics on\n+             |    (store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk)\n+             |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+             |  join promotion on (store_sales.ss_promo_sk = promotion.p_promo_sk)\n+             |  join date_dim on (ss_sold_date_sk = d_date_sk)\n+             |where\n+             |  cd_gender = 'F'\n+             |  and cd_marital_status = 'W'\n+             |  and cd_education_status = 'Primary'\n+             |  and (p_channel_email = 'N'\n+             |    or p_channel_event = 'N')\n+             |  and d_year = 1998\n+             |  and ss_sold_date_sk between 2450815 and 2451179 -- partition key filter\n+             |group by\n+             |  i_item_id\n+             |order by\n+             |  i_item_id\n+             |limit 100\n+           \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q7                                       2042 / 2333          8.1         124.2       1.0X\n+     */\n+\n+    (\"q73\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  c_salutation,\n+              |  c_preferred_cust_flag,\n+              |  ss_ticket_number,\n+              |  cnt\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    count(*) cnt\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    -- join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    store.s_county in\n+              |      ('Williamson County','Franklin Parish','Bronx County','Orange County')\n+              |    -- and date_dim.d_dom between 1 and 2\n+              |    -- and date_dim.d_year in(1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1999-01-01' and '2001-12-02'\n+              |    -- and dayofmonth(ss_date) in (1,2)\n+              |    -- partition key filter\n+              |    -- and ss_sold_date_sk in (2450816, 2450846, 2450847, 2450874, 2450875, 2450905,\n+              |    --                         2450906, 2450935, 2450936, 2450966, 2450967,\n+              |    --                         2450996, 2450997, 2451027, 2451028, 2451058, 2451059,\n+              |    --                         2451088, 2451089, 2451119, 2451120, 2451149,\n+              |    --                         2451150, 2451180, 2451181, 2451211, 2451212, 2451239,\n+              |    --                         2451240, 2451270, 2451271, 2451300, 2451301,\n+              |    --                         2451331, 2451332, 2451361, 2451362, 2451392, 2451393,\n+              |    --                         2451423, 2451424, 2451453, 2451454, 2451484,\n+              |    --                         2451485, 2451514, 2451515, 2451545, 2451546, 2451576,\n+              |    --                         2451577, 2451605, 2451606, 2451636, 2451637,\n+              |    --                         2451666, 2451667, 2451697, 2451698, 2451727, 2451728,\n+              |    --                         2451758, 2451759, 2451789, 2451790, 2451819,\n+              |    --                         2451820, 2451850, 2451851, 2451880, 2451881)\n+              |    and (household_demographics.hd_buy_potential = '>10000'\n+              |      or household_demographics.hd_buy_potential = 'unknown')\n+              |    and household_demographics.hd_vehicle_count > 0\n+              |    and case when household_demographics.hd_vehicle_count > 0 then\n+              |        household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n+              |      else null end > 1\n+              |    and ss_sold_date_sk between 2451180 and 2451269\n+              |    -- partition key filter (3 months)\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk\n+              |  ) dj\n+              |  join customer on (dj.ss_customer_sk = customer.c_customer_sk)\n+              |where\n+              |  cnt between 1 and 5\n+              |order by\n+              |  cnt desc\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q73                                      1124 / 1221         13.1          76.5       1.0X\n+     */\n+\n+    (\"q79\", \"\"\"\n+              |select\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  substr(s_city, 1, 30) as city,\n+              |  ss_ticket_number,\n+              |  amt,\n+              |  profit\n+              |from\n+              |  (select\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    s_city,\n+              |    sum(ss_coupon_amt) amt,\n+              |    sum(ss_net_profit) profit\n+              |  from\n+              |    store_sales\n+              |    join household_demographics on\n+              |      (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |  where\n+              |    store.s_number_employees between 200 and 295\n+              |    and (household_demographics.hd_dep_count = 8\n+              |      or household_demographics.hd_vehicle_count > 0)\n+              |    and date_dim.d_dow = 1\n+              |    and date_dim.d_year in (1998, 1998 + 1, 1998 + 2)\n+              |    -- and ss_date between '1998-01-01' and '2000-12-25'\n+              |    -- 156 days\n+              |  and d_date between '1999-01-01' and '1999-03-31'\n+              |  and ss_sold_date_sk between 2451180 and 2451269  -- partition key filter\n+              |  group by\n+              |    ss_ticket_number,\n+              |    ss_customer_sk,\n+              |    ss_addr_sk,\n+              |    s_city\n+              |  ) ms\n+              |  join customer on (ms.ss_customer_sk = customer.c_customer_sk)\n+              |order by\n+              |  c_last_name,\n+              |  c_first_name,\n+              |  city,\n+              |  profit\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q79                                      2029 / 2488          7.3         137.5       1.0X\n+     */\n+\n+      (\"q8\",\n+        \"\"\"\n+          |select  s_store_name\n+          |      ,sum(ss_net_profit)\n+          | from store_sales\n+          |     ,date_dim\n+          |     ,store,\n+          |     (select distinct a01.ca_zip\n+          |     from\n+          |     (SELECT substr(ca_zip,1,5) ca_zip\n+          |      FROM customer_address\n+          |      WHERE substr(ca_zip,1,5) IN ('89436', '30868', '65085', '22977', '83927', '77557',\n+          |      '58429', '40697', '80614', '10502', '32779',\n+          |      '91137', '61265', '98294', '17921', '18427', '21203', '59362', '87291', '84093',\n+          |      '21505', '17184', '10866', '67898', '25797',\n+          |      '28055', '18377', '80332', '74535', '21757', '29742', '90885', '29898', '17819',\n+          |      '40811', '25990', '47513', '89531', '91068',\n+          |      '10391', '18846', '99223', '82637', '41368', '83658', '86199', '81625', '26696',\n+          |      '89338', '88425', '32200', '81427', '19053',\n+          |      '77471', '36610', '99823', '43276', '41249', '48584', '83550', '82276', '18842',\n+          |      '78890', '14090', '38123', '40936', '34425',\n+          |      '19850', '43286', '80072', '79188', '54191', '11395', '50497', '84861', '90733',\n+          |      '21068', '57666', '37119', '25004', '57835',\n+          |      '70067', '62878', '95806', '19303', '18840', '19124', '29785', '16737', '16022',\n+          |      '49613', '89977', '68310', '60069', '98360',\n+          |      '48649', '39050', '41793', '25002', '27413', '39736', '47208', '16515', '94808',\n+          |      '57648', '15009', '80015', '42961', '63982',\n+          |      '21744', '71853', '81087', '67468', '34175', '64008', '20261', '11201', '51799',\n+          |      '48043', '45645', '61163', '48375', '36447',\n+          |      '57042', '21218', '41100', '89951', '22745', '35851', '83326', '61125', '78298',\n+          |      '80752', '49858', '52940', '96976', '63792',\n+          |      '11376', '53582', '18717', '90226', '50530', '94203', '99447', '27670', '96577',\n+          |      '57856', '56372', '16165', '23427', '54561',\n+          |      '28806', '44439', '22926', '30123', '61451', '92397', '56979', '92309', '70873',\n+          |      '13355', '21801', '46346', '37562', '56458',\n+          |      '28286', '47306', '99555', '69399', '26234', '47546', '49661', '88601', '35943',\n+          |      '39936', '25632', '24611', '44166', '56648',\n+          |      '30379', '59785', '11110', '14329', '93815', '52226', '71381', '13842', '25612',\n+          |      '63294', '14664', '21077', '82626', '18799',\n+          |      '60915', '81020', '56447', '76619', '11433', '13414', '42548', '92713', '70467',\n+          |      '30884', '47484', '16072', '38936', '13036',\n+          |      '88376', '45539', '35901', '19506', '65690', '73957', '71850', '49231', '14276',\n+          |      '20005', '18384', '76615', '11635', '38177',\n+          |      '55607', '41369', '95447', '58581', '58149', '91946', '33790', '76232', '75692',\n+          |      '95464', '22246', '51061', '56692', '53121',\n+          |      '77209', '15482', '10688', '14868', '45907', '73520', '72666', '25734', '17959',\n+          |      '24677', '66446', '94627', '53535', '15560',\n+          |      '41967', '69297', '11929', '59403', '33283', '52232', '57350', '43933', '40921',\n+          |      '36635', '10827', '71286', '19736', '80619',\n+          |      '25251', '95042', '15526', '36496', '55854', '49124', '81980', '35375', '49157',\n+          |      '63512', '28944', '14946', '36503', '54010',\n+          |      '18767', '23969', '43905', '66979', '33113', '21286', '58471', '59080', '13395',\n+          |      '79144', '70373', '67031', '38360', '26705',\n+          |      '50906', '52406', '26066', '73146', '15884', '31897', '30045', '61068', '45550',\n+          |      '92454', '13376', '14354', '19770', '22928',\n+          |      '97790', '50723', '46081', '30202', '14410', '20223', '88500', '67298', '13261',\n+          |      '14172', '81410', '93578', '83583', '46047',\n+          |      '94167', '82564', '21156', '15799', '86709', '37931', '74703', '83103', '23054',\n+          |      '70470', '72008', '35709', '91911', '69998',\n+          |      '20961', '70070', '63197', '54853', '88191', '91830', '49521', '19454', '81450',\n+          |      '89091', '62378', '31904', '61869', '51744',\n+          |      '36580', '85778', '36871', '48121', '28810', '83712', '45486', '67393', '26935',\n+          |      '42393', '20132', '55349', '86057', '21309',\n+          |      '80218', '10094', '11357', '48819', '39734', '40758', '30432', '21204', '29467',\n+          |      '30214', '61024', '55307', '74621', '11622',\n+          |      '68908', '33032', '52868', '99194', '99900', '84936', '69036', '99149', '45013',\n+          |      '32895', '59004', '32322', '14933', '32936',\n+          |      '33562', '72550', '27385', '58049', '58200', '16808', '21360', '32961', '18586',\n+          |      '79307', '15492')) a01\n+          |     inner join\n+          |     (select ca_zip\n+          |      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n+          |            FROM customer_address, customer\n+          |            WHERE ca_address_sk = c_current_addr_sk and\n+          |                  c_preferred_cust_flag='Y'\n+          |            group by ca_zip\n+          |            having count(*) > 10)A1\n+          |      ) b11\n+          |      on (a01.ca_zip = b11.ca_zip )) A2\n+          | where ss_store_sk = s_store_sk\n+          |  and ss_sold_date_sk = d_date_sk\n+          |  and ss_sold_date_sk between 2451271 and 2451361\n+          |  and d_qoy = 2 and d_year = 1999\n+          |  and (substr(s_zip,1,2) = substr(a2.ca_zip,1,2))\n+          | group by s_store_name\n+          | order by s_store_name\n+          |limit 100\n+        \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q8                                       1737 / 2197          8.7         115.6       1.0X\n+     */\n+\n+      (\"q82\", \"\"\"\n+                |select\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |from\n+                |  store_sales\n+                |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+                |  join inventory on (item.i_item_sk = inventory.inv_item_sk)\n+                |  join date_dim on (inventory.inv_date_sk = date_dim.d_date_sk)\n+                |where\n+                |  i_current_price between 30 and 30 + 30\n+                |  and i_manufact_id in (437, 129, 727, 663)\n+                |  and inv_quantity_on_hand between 100 and 500\n+                |group by\n+                |  i_item_id,\n+                |  i_item_desc,\n+                |  i_current_price\n+                |order by\n+                |  i_item_id\n+                |limit 100\n+              \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q82                                     9399 / 10245          6.8         147.2       1.0X\n+     */\n+\n+    (\"q89\", \"\"\"\n+              |select\n+              |  *\n+              |from\n+              |  (select\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy,\n+              |    sum(ss_sales_price) sum_sales\n+              |  from\n+              |    store_sales\n+              |    join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |    join store on (store_sales.ss_store_sk = store.s_store_sk)\n+              |    join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |  where\n+              |    ss_sold_date_sk between 2451545 and 2451910  -- partition key filter\n+              |    and d_year in (2000)\n+              |    and ((i_category in('Home', 'Books', 'Electronics')\n+              |          and i_class in('wallpaper', 'parenting', 'musical'))\n+              |        or (i_category in('Shoes', 'Jewelry', 'Men')\n+              |            and i_class in('womens', 'birdal', 'pants'))\n+              |        )\n+              |  group by\n+              |    i_category,\n+              |    i_class,\n+              |    i_brand,\n+              |    s_store_name,\n+              |    s_company_name,\n+              |    d_moy\n+              |  ) tmp1\n+              |order by\n+              |  sum_sales,\n+              |  s_store_name\n+              |limit 100\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q89                                      1122 / 1274         12.9          77.2       1.0X\n+     */\n+\n+    (\"q98\", \"\"\"\n+              |select\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price,\n+              |  sum(ss_ext_sales_price) as itemrevenue\n+              |from\n+              |  store_sales\n+              |  join item on (store_sales.ss_item_sk = item.i_item_sk)\n+              |  join date_dim on (store_sales.ss_sold_date_sk = date_dim.d_date_sk)\n+              |where\n+              |  ss_sold_date_sk between 2451911 and 2451941\n+              |  -- partition key filter (1 calendar month)\n+              |  and d_date between '2001-01-01' and '2001-01-31'\n+              |  and i_category in('Jewelry', 'Sports', 'Books')\n+              |group by\n+              |  i_item_id,\n+              |  i_item_desc,\n+              |  i_category,\n+              |  i_class,\n+              |  i_current_price\n+              |order by\n+              |  i_category,\n+              |  i_class,\n+              |  i_item_id,\n+              |  i_item_desc\n+              |  -- revenueratio\n+              |limit 1000\n+            \"\"\".stripMargin),\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    q98                                      1235 / 1542         11.8          85.0       1.0X\n+     */\n+\n+    (\"ss_max\", \"\"\"\n+                 |select\n+                 |  count(*) as total,\n+                 |  max(ss_sold_date_sk) as max_ss_sold_date_sk,\n+                 |  max(ss_sold_time_sk) as max_ss_sold_time_sk,\n+                 |  max(ss_item_sk) as max_ss_item_sk,\n+                 |  max(ss_customer_sk) as max_ss_customer_sk,\n+                 |  max(ss_cdemo_sk) as max_ss_cdemo_sk,\n+                 |  max(ss_hdemo_sk) as max_ss_hdemo_sk,\n+                 |  max(ss_addr_sk) as max_ss_addr_sk,\n+                 |  max(ss_store_sk) as max_ss_store_sk,\n+                 |  max(ss_promo_sk) as max_ss_promo_sk\n+                 |from store_sales\n+               \"\"\".stripMargin)\n+\n+    /*\n+    Java HotSpot(TM) 64-Bit Server VM 1.8.0_73-b02 on Mac OS X 10.11.4\n+    Intel(R) Core(TM) i7-4960HQ CPU @ 2.60GHz\n+\n+    TPCDS Snappy (scale = 5):           Best/Avg Time(ms)    Rate(M/s)   Per Row(ns)   Relative\n+    -------------------------------------------------------------------------------------------\n+    ss_max                                   2305 / 2731          6.2         160.0       1.0X\n+     */\n+\n+  ).toArray\n+\n+  val tables = Seq(\"customer\", \"customer_address\", \"customer_demographics\", \"date_dim\",\n+    \"household_demographics\", \"inventory\", \"item\", \"promotion\", \"store\", \"catalog_sales\",\n+    \"web_sales\", \"store_sales\")",
    "line": 1185
  }],
  "prId": 12771
}]