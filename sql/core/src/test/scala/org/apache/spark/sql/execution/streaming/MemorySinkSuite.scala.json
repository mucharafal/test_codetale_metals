[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "`MemorySinkV2 ` is mainly for testing. I think the stats changes will not impact anything, right? @tdas @jose-torres ",
    "commit": "f72084e9edfbdaf6334b13c54f1534eca5e88806",
    "createdAt": "2018-04-30T16:48:04Z",
    "diffHunk": "@@ -220,11 +220,11 @@ class MemorySinkSuite extends StreamTest with BeforeAndAfter {\n \n     sink.addBatch(0, 1 to 3)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 12)\n+    assert(plan.stats.sizeInBytes === 36)\n \n     sink.addBatch(1, 4 to 6)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 24)\n+    assert(plan.stats.sizeInBytes === 72)",
    "line": 10
  }, {
    "author": {
      "login": "jose-torres"
    },
    "body": "It shouldn't impact anything, but abstractly it seems strange that this unification would cause the stats to change? What are we doing differently to cause this, and how confident are we this won't happen to production sinks?",
    "commit": "f72084e9edfbdaf6334b13c54f1534eca5e88806",
    "createdAt": "2018-05-01T05:05:46Z",
    "diffHunk": "@@ -220,11 +220,11 @@ class MemorySinkSuite extends StreamTest with BeforeAndAfter {\n \n     sink.addBatch(0, 1 to 3)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 12)\n+    assert(plan.stats.sizeInBytes === 36)\n \n     sink.addBatch(1, 4 to 6)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 24)\n+    assert(plan.stats.sizeInBytes === 72)",
    "line": 10
  }, {
    "author": {
      "login": "cloud-fan"
    },
    "body": "It seems we forgot to count the row object overhead (8 bytes) before in memory stream.",
    "commit": "f72084e9edfbdaf6334b13c54f1534eca5e88806",
    "createdAt": "2018-05-02T14:28:55Z",
    "diffHunk": "@@ -220,11 +220,11 @@ class MemorySinkSuite extends StreamTest with BeforeAndAfter {\n \n     sink.addBatch(0, 1 to 3)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 12)\n+    assert(plan.stats.sizeInBytes === 36)\n \n     sink.addBatch(1, 4 to 6)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 24)\n+    assert(plan.stats.sizeInBytes === 72)",
    "line": 10
  }, {
    "author": {
      "login": "jose-torres"
    },
    "body": "SGTM then",
    "commit": "f72084e9edfbdaf6334b13c54f1534eca5e88806",
    "createdAt": "2018-05-02T22:05:19Z",
    "diffHunk": "@@ -220,11 +220,11 @@ class MemorySinkSuite extends StreamTest with BeforeAndAfter {\n \n     sink.addBatch(0, 1 to 3)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 12)\n+    assert(plan.stats.sizeInBytes === 36)\n \n     sink.addBatch(1, 4 to 6)\n     plan.invalidateStatsCache()\n-    assert(plan.stats.sizeInBytes === 24)\n+    assert(plan.stats.sizeInBytes === 72)",
    "line": 10
  }],
  "prId": 21189
}]