[{
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "note that this actually fails unit tests. I thought it passed but it was from a previous commit.\n\nCan you please pay a little bit more attention in the future and at least run your own unit tests locally? Thanks.\n",
    "commit": "ef7e3da03f54bbde35406bac6ce9dcdd94f5ea75",
    "createdAt": "2015-07-28T05:06:19Z",
    "diffHunk": "@@ -184,4 +184,26 @@ class DateFunctionsSuite extends QueryTest {\n       Row(15, 15, 15))\n   }\n \n+  test(\"function last_day\") {\n+    val df1 = Seq((1, \"2015-07-23\"), (2, \"2015-07-24\")).toDF(\"i\", \"d\")\n+    val df2 = Seq((1, \"2015-07-23 00:11:22\"), (2, \"2015-07-24 11:22:33\")).toDF(\"i\", \"t\")\n+    checkAnswer(\n+      df1.select(last_day(col(\"d\"))),\n+      Seq(Row(Date.valueOf(\"2015-07-31\")), Row(Date.valueOf(\"2015-07-31\"))))\n+    checkAnswer(\n+      df2.select(last_day(col(\"t\"))),\n+      Seq(Row(Date.valueOf(\"2015-07-31\")), Row(Date.valueOf(\"2015-07-31\"))))\n+  }\n+\n+  test(\"function next_day\") {\n+    val df1 = Seq((\"mon\", \"2015-07-23\"), (\"tuesday\", \"2015-07-20\")).toDF(\"dow\", \"d\")\n+    val df2 = Seq((\"th\", \"2015-07-23 00:11:22\"), (\"xx\", \"2015-07-24 11:22:33\")).toDF(\"dow\", \"t\")\n+    checkAnswer(\n+      df1.select(next_day(col(\"d\"), \"MONDAY\")),\n+      Seq(Row(Date.valueOf(\"2015-07-27\")), Row(Date.valueOf(\"2015-07-27\"))))\n+    checkAnswer(\n+      df2.select(next_day(col(\"t\"), \"th\")),\n+      Seq(Row(Date.valueOf(\"2015-07-30\")), Row(null)))",
    "line": 23
  }, {
    "author": {
      "login": "adrian-wang"
    },
    "body": "Sorry for that...\n",
    "commit": "ef7e3da03f54bbde35406bac6ce9dcdd94f5ea75",
    "createdAt": "2015-07-28T05:19:10Z",
    "diffHunk": "@@ -184,4 +184,26 @@ class DateFunctionsSuite extends QueryTest {\n       Row(15, 15, 15))\n   }\n \n+  test(\"function last_day\") {\n+    val df1 = Seq((1, \"2015-07-23\"), (2, \"2015-07-24\")).toDF(\"i\", \"d\")\n+    val df2 = Seq((1, \"2015-07-23 00:11:22\"), (2, \"2015-07-24 11:22:33\")).toDF(\"i\", \"t\")\n+    checkAnswer(\n+      df1.select(last_day(col(\"d\"))),\n+      Seq(Row(Date.valueOf(\"2015-07-31\")), Row(Date.valueOf(\"2015-07-31\"))))\n+    checkAnswer(\n+      df2.select(last_day(col(\"t\"))),\n+      Seq(Row(Date.valueOf(\"2015-07-31\")), Row(Date.valueOf(\"2015-07-31\"))))\n+  }\n+\n+  test(\"function next_day\") {\n+    val df1 = Seq((\"mon\", \"2015-07-23\"), (\"tuesday\", \"2015-07-20\")).toDF(\"dow\", \"d\")\n+    val df2 = Seq((\"th\", \"2015-07-23 00:11:22\"), (\"xx\", \"2015-07-24 11:22:33\")).toDF(\"dow\", \"t\")\n+    checkAnswer(\n+      df1.select(next_day(col(\"d\"), \"MONDAY\")),\n+      Seq(Row(Date.valueOf(\"2015-07-27\")), Row(Date.valueOf(\"2015-07-27\"))))\n+    checkAnswer(\n+      df2.select(next_day(col(\"t\"), \"th\")),\n+      Seq(Row(Date.valueOf(\"2015-07-30\")), Row(null)))",
    "line": 23
  }],
  "prId": 6986
}]