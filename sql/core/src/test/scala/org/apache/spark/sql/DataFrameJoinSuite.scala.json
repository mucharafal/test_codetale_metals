[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "cc @mgaido91  ",
    "commit": "0e0cdb269ea88d1233babb898a6aee0981132c75",
    "createdAt": "2018-01-21T13:29:16Z",
    "diffHunk": "@@ -276,16 +277,14 @@ class DataFrameJoinSuite extends QueryTest with SharedSQLContext {\n \n   test(\"SPARK-23087: don't throw Analysis Exception in CheckCartesianProduct when join condition \" +\n     \"is false or null\") {\n-    val df = spark.range(10)\n-    val dfNull = spark.range(10).select(lit(null).as(\"b\"))\n-    val planNull = df.join(dfNull, $\"id\" === $\"b\", \"left\").queryExecution.analyzed\n-\n-    spark.sessionState.executePlan(planNull).optimizedPlan\n-\n-    val dfOne = df.select(lit(1).as(\"a\"))\n-    val dfTwo = spark.range(10).select(lit(2).as(\"b\"))\n-    val planFalse = dfOne.join(dfTwo, $\"a\" === $\"b\", \"left\").queryExecution.analyzed\n-\n-    spark.sessionState.executePlan(planFalse).optimizedPlan\n+    withSQLConf(SQLConf.CROSS_JOINS_ENABLED.key -> \"false\") {\n+      val df = spark.range(10)\n+      val dfNull = spark.range(10).select(lit(null).as(\"b\"))\n+      df.join(dfNull, $\"id\" === $\"b\", \"left\").queryExecution.optimizedPlan\n+\n+      val dfOne = df.select(lit(1).as(\"a\"))\n+      val dfTwo = spark.range(10).select(lit(2).as(\"b\"))\n+      dfOne.join(dfTwo, $\"a\" === $\"b\", \"left\").queryExecution.optimizedPlan\n+    }",
    "line": 31
  }],
  "prId": 20341
}]