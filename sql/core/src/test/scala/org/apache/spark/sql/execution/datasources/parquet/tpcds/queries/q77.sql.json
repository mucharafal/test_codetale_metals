[{
  "comments": [{
    "author": {
      "login": "davies"
    },
    "body": "Could you change the `date_add` back to interval expression?\n",
    "commit": "18150121df04c8f0fd39c2c2fbfbc7fc39ccbd64",
    "createdAt": "2016-05-19T23:21:05Z",
    "diffHunk": "@@ -0,0 +1,100 @@\n+WITH ss AS\n+(SELECT\n+    s_store_sk,\n+    sum(ss_ext_sales_price) AS sales,\n+    sum(ss_net_profit) AS profit\n+  FROM store_sales, date_dim, store\n+  WHERE ss_sold_date_sk = d_date_sk\n+    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n+  date_add(cast('2000-08-03' AS DATE), 30)\n+    AND ss_store_sk = s_store_sk\n+  GROUP BY s_store_sk),\n+    sr AS\n+  (SELECT\n+    s_store_sk,\n+    sum(sr_return_amt) AS returns,\n+    sum(sr_net_loss) AS profit_loss\n+  FROM store_returns, date_dim, store\n+  WHERE sr_returned_date_sk = d_date_sk\n+    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n+  date_add(cast('2000-08-03' AS DATE), 30)\n+    AND sr_store_sk = s_store_sk\n+  GROUP BY s_store_sk),\n+    cs AS\n+  (SELECT\n+    cs_call_center_sk,\n+    sum(cs_ext_sales_price) AS sales,\n+    sum(cs_net_profit) AS profit\n+  FROM catalog_sales, date_dim\n+  WHERE cs_sold_date_sk = d_date_sk\n+    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n+  date_add(cast('2000-08-03' AS DATE), 30)\n+  GROUP BY cs_call_center_sk),\n+    cr AS\n+  (SELECT\n+    sum(cr_return_amount) AS returns,\n+    sum(cr_net_loss) AS profit_loss\n+  FROM catalog_returns, date_dim\n+  WHERE cr_returned_date_sk = d_date_sk\n+    AND d_date BETWEEN cast('2000-08-03]' AS DATE) AND\n+  date_add(cast('2000-08-03' AS DATE), 30)),\n+    ws AS\n+  (SELECT\n+    wp_web_page_sk,\n+    sum(ws_ext_sales_price) AS sales,\n+    sum(ws_net_profit) AS profit\n+  FROM web_sales, date_dim, web_page\n+  WHERE ws_sold_date_sk = d_date_sk\n+    AND d_date BETWEEN cast('2000-08-03' AS DATE) AND\n+  date_add(cast('2000-08-03' AS DATE), 30)"
  }],
  "prId": 13188
}]