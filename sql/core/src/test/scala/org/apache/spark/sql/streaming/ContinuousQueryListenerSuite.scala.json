[{
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "nit: make these conditions separate assert so its easy to debug if something fails.\n",
    "commit": "1f00c608aaf8938f0f234327660d306db9b54b97",
    "createdAt": "2016-06-06T20:33:15Z",
    "diffHunk": "@@ -141,6 +139,92 @@ class ContinuousQueryListenerSuite extends StreamTest with BeforeAndAfter {\n     }\n   }\n \n+  test(\"exception should be reported in QueryTerminated\") {\n+    val listener = new QueryStatusCollector\n+    withListenerAdded(listener) {\n+      val input = MemoryStream[Int]\n+      testStream(input.toDS.map(_ / 0))(\n+        StartStream(),\n+        AddData(input, 1),\n+        ExpectFailure[SparkException](),\n+        Assert {\n+          spark.sparkContext.listenerBus.waitUntilEmpty(10000)\n+          assert(listener.terminationStatus !== null)\n+          assert(listener.terminationException.isDefined &&"
  }],
  "prId": 13335
}]