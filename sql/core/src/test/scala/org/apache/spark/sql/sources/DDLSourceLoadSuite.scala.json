[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "we still need a test case to cover the conflicting data source case.",
    "commit": "96cf1a975242ac20212dd31a9ff83bc566eff275",
    "createdAt": "2017-05-09T12:21:29Z",
    "diffHunk": "@@ -19,16 +19,15 @@ package org.apache.spark.sql.sources\n \n import org.apache.spark.sql.{AnalysisException, SQLContext}\n import org.apache.spark.sql.test.SharedSQLContext\n-import org.apache.spark.sql.types.{StringType, StructField, StructType}\n+import org.apache.spark.sql.types.{IntegerType, StringType, StructField, StructType}\n \n \n // please note that the META-INF/services had to be modified for the test directory for this to work\n class DDLSourceLoadSuite extends DataSourceTest with SharedSQLContext {\n \n   test(\"data sources with the same name\") {\n-    intercept[RuntimeException] {\n-      spark.read.format(\"Fluet da Bomb\").load()"
  }],
  "prId": 17916
}, {
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "So, we will only allow this case.",
    "commit": "96cf1a975242ac20212dd31a9ff83bc566eff275",
    "createdAt": "2017-05-09T23:23:28Z",
    "diffHunk": "@@ -19,26 +19,39 @@ package org.apache.spark.sql.sources\n \n import org.apache.spark.sql.{AnalysisException, SQLContext}\n import org.apache.spark.sql.test.SharedSQLContext\n-import org.apache.spark.sql.types.{StringType, StructField, StructType}\n+import org.apache.spark.sql.types._\n \n \n // please note that the META-INF/services had to be modified for the test directory for this to work\n class DDLSourceLoadSuite extends DataSourceTest with SharedSQLContext {\n \n-  test(\"data sources with the same name\") {\n-    intercept[RuntimeException] {\n+  test(\"data sources with the same name - internal data sources\") {\n+    val e = intercept[RuntimeException] {\n       spark.read.format(\"Fluet da Bomb\").load()\n     }\n+    assert(e.getMessage.contains(\"Multiple sources found for Fluet da Bomb\"))\n+  }\n+\n+  test(\"data sources with the same name - internal data source/external data source\") {",
    "line": 20
  }],
  "prId": 17916
}]