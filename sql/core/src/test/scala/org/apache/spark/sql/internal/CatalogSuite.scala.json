[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "this behaviour is consistent with hive.\n",
    "commit": "4071bec22849ea999c3c7e1b2e73f7cf2b8f9722",
    "createdAt": "2016-09-03T03:32:58Z",
    "diffHunk": "@@ -305,6 +306,26 @@ class CatalogSuite\n     columnFields.foreach { f => assert(columnString.contains(f.toString)) }\n   }\n \n+  test(\"createExternalTable should fail if path and schema are both not given \" +\n+    \"for file-based data source\") {\n+    val e = intercept[AnalysisException] {\n+      spark.catalog.createExternalTable(\"tbl\", \"json\", Map.empty[String, String])\n+    }\n+    assert(e.message.contains(\"Unable to infer schema\"))\n+  }\n+\n+  test(\"createExternalTable should not fail if path is not given but schema is given \" +"
  }],
  "prId": 14921
}]