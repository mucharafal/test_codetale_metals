[{
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "Minor nit: I'd write 100.0 instead of 100D etc.",
    "commit": "02af468b8c249103e65e97ce0945309e0d48e1a3",
    "createdAt": "2019-10-05T15:40:53Z",
    "diffHunk": "@@ -124,20 +124,24 @@ class ApproximatePercentileQuerySuite extends QueryTest with SharedSparkSession\n   test(\"percentile_approx, with different accuracies\") {\n \n     withTempView(table) {\n-      (1 to 1000).toDF(\"col\").createOrReplaceTempView(table)\n+      val tableCount = 1000\n+      (1 to tableCount).toDF(\"col\").createOrReplaceTempView(table)\n \n       // With different accuracies\n-      val expectedPercentile = 250D\n       val accuracies = Array(1, 10, 100, 1000, 10000)\n-      val errors = accuracies.map { accuracy =>\n-        val df = spark.sql(s\"SELECT percentile_approx(col, 0.25, $accuracy) FROM $table\")\n-        val approximatePercentile = df.collect().head.getInt(0)\n-        val error = Math.abs(approximatePercentile - expectedPercentile)\n-        error\n+      val expectedPercentiles = Array(100D, 200D, 250D, 314D, 777D)",
    "line": 16
  }],
  "prId": 26029
}]