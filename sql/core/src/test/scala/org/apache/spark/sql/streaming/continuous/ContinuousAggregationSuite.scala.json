[{
  "comments": [{
    "author": {
      "login": "tdas"
    },
    "body": "test transformations both before and after coalesce. ",
    "commit": "f77b12ba92a868274ecdfea331786addb2d9ca83",
    "createdAt": "2018-06-26T08:33:12Z",
    "diffHunk": "@@ -50,6 +51,42 @@ class ContinuousAggregationSuite extends ContinuousSuiteBase {\n     }\n   }\n \n+  test(\"multiple partitions with coalesce\") {\n+    val input = ContinuousMemoryStream[Int]\n+\n+    val df = input.toDF().coalesce(1).agg(max('value))\n+\n+    testStream(df, OutputMode.Complete)(\n+      AddData(input, 0, 1, 2),\n+      CheckAnswer(2),\n+      StopStream,\n+      AddData(input, 3, 4, 5),\n+      StartStream(),\n+      CheckAnswer(5),\n+      AddData(input, -1, -2, -3),\n+      CheckAnswer(5))\n+  }\n+\n+  test(\"multiple partitions with coalesce - multiple transformations\") {\n+    val input = ContinuousMemoryStream[Int]\n+\n+    val df = input.toDF()\n+      .coalesce(1)\n+      .select('value as 'copy, 'value)\n+      .where('copy =!= 2)\n+      .agg(max('value))"
  }, {
    "author": {
      "login": "tdas"
    },
    "body": "You missed this comment. ",
    "commit": "f77b12ba92a868274ecdfea331786addb2d9ca83",
    "createdAt": "2018-06-27T06:33:31Z",
    "diffHunk": "@@ -50,6 +51,42 @@ class ContinuousAggregationSuite extends ContinuousSuiteBase {\n     }\n   }\n \n+  test(\"multiple partitions with coalesce\") {\n+    val input = ContinuousMemoryStream[Int]\n+\n+    val df = input.toDF().coalesce(1).agg(max('value))\n+\n+    testStream(df, OutputMode.Complete)(\n+      AddData(input, 0, 1, 2),\n+      CheckAnswer(2),\n+      StopStream,\n+      AddData(input, 3, 4, 5),\n+      StartStream(),\n+      CheckAnswer(5),\n+      AddData(input, -1, -2, -3),\n+      CheckAnswer(5))\n+  }\n+\n+  test(\"multiple partitions with coalesce - multiple transformations\") {\n+    val input = ContinuousMemoryStream[Int]\n+\n+    val df = input.toDF()\n+      .coalesce(1)\n+      .select('value as 'copy, 'value)\n+      .where('copy =!= 2)\n+      .agg(max('value))"
  }],
  "prId": 21560
}]