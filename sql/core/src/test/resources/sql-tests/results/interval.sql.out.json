[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "How about the columns having the matched data type?",
    "commit": "8e414ac6acd9e36d06d2002247727e2680fed31a",
    "createdAt": "2018-03-19T06:22:05Z",
    "diffHunk": "@@ -0,0 +1,375 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 31\n+\n+\n+-- !query 0\n+select\n+  '1' second,\n+  2  seconds,\n+  '1' minute,\n+  2  minutes,\n+  '1' hour,\n+  2  hours,\n+  '1' day,\n+  2  days,\n+  '1' month,\n+  2  months,\n+  '1' year,\n+  2  years\n+-- !query 0 schema\n+struct<interval 1 seconds:calendarinterval,interval 2 seconds:calendarinterval,interval 1 minutes:calendarinterval,interval 2 minutes:calendarinterval,interval 1 hours:calendarinterval,interval 2 hours:calendarinterval,interval 1 days:calendarinterval,interval 2 days:calendarinterval,interval 1 months:calendarinterval,interval 2 months:calendarinterval,interval 1 years:calendarinterval,interval 2 years:calendarinterval>\n+-- !query 0 output\n+interval 1 seconds\tinterval 2 seconds\tinterval 1 minutes\tinterval 2 minutes\tinterval 1 hours\tinterval 2 hours\tinterval 1 days\tinterval 2 days\tinterval 1 months\tinterval 2 months\tinterval 1 years\tinterval 2 years\n+\n+\n+-- !query 1\n+select\n+  interval '10-11' year to month,\n+  interval '10' year,\n+  interval '11' month\n+-- !query 1 schema\n+struct<interval 10 years 11 months:calendarinterval,interval 10 years:calendarinterval,interval 11 months:calendarinterval>\n+-- !query 1 output\n+interval 10 years 11 months\tinterval 10 years\tinterval 11 months\n+\n+\n+-- !query 2\n+select\n+  '10-11' year to month,\n+  '10' year,\n+  '11' month\n+-- !query 2 schema\n+struct<interval 10 years 11 months:calendarinterval,interval 10 years:calendarinterval,interval 11 months:calendarinterval>\n+-- !query 2 output\n+interval 10 years 11 months\tinterval 10 years\tinterval 11 months\n+\n+\n+-- !query 3\n+select\n+  interval '10 9:8:7.987654321' day to second,\n+  interval '10' day,\n+  interval '11' hour,\n+  interval '12' minute,\n+  interval '13' second,\n+  interval '13.123456789' second\n+-- !query 3 schema\n+struct<interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds:calendarinterval,interval 1 weeks 3 days:calendarinterval,interval 11 hours:calendarinterval,interval 12 minutes:calendarinterval,interval 13 seconds:calendarinterval,interval 13 seconds 123 milliseconds 456 microseconds:calendarinterval>\n+-- !query 3 output\n+interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds\tinterval 1 weeks 3 days\tinterval 11 hours\tinterval 12 minutes\tinterval 13 seconds\tinterval 13 seconds 123 milliseconds 456 microseconds\n+\n+\n+-- !query 4\n+select\n+  '10 9:8:7.987654321' day to second,\n+  '10' day,\n+  '11' hour,\n+  '12' minute,\n+  '13' second,\n+  '13.123456789' second\n+-- !query 4 schema\n+struct<interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds:calendarinterval,interval 1 weeks 3 days:calendarinterval,interval 11 hours:calendarinterval,interval 12 minutes:calendarinterval,interval 13 seconds:calendarinterval,interval 13 seconds 123 milliseconds 456 microseconds:calendarinterval>\n+-- !query 4 output\n+interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds\tinterval 1 weeks 3 days\tinterval 11 hours\tinterval 12 minutes\tinterval 13 seconds\tinterval 13 seconds 123 milliseconds 456 microseconds\n+\n+\n+-- !query 5\n+create temporary view interval_arithmetic as\n+  select CAST(dateval AS date), CAST(tsval AS timestamp) from values\n+    ('2012-01-01', '2012-01-01')\n+    as interval_arithmetic(dateval, tsval)\n+-- !query 5 schema\n+struct<>\n+-- !query 5 output\n+\n+\n+\n+-- !query 6\n+select\n+  dateval,\n+  dateval - interval '2-2' year to month,\n+  dateval - interval '-2-2' year to month,\n+  dateval + interval '2-2' year to month,\n+  dateval + interval '-2-2' year to month,\n+  - interval '2-2' year to month + dateval,\n+  interval '2-2' year to month + dateval\n+from interval_arithmetic\n+-- !query 6 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 2 years 2 months) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date>\n+-- !query 6 output\n+2012-01-01\t2009-11-01\t2014-03-01\t2014-03-01\t2009-11-01\t2009-11-01\t2014-03-01\n+\n+\n+-- !query 7\n+select\n+  dateval,\n+  dateval - '2-2' year to month,\n+  dateval - '-2-2' year to month,\n+  dateval + '2-2' year to month,\n+  dateval + '-2-2' year to month,\n+  - '2-2' year to month + dateval,\n+  '2-2' year to month + dateval\n+from interval_arithmetic\n+-- !query 7 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 2 years 2 months) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date>\n+-- !query 7 output\n+2012-01-01\t2009-11-01\t2014-03-01\t2014-03-01\t2009-11-01\t2009-11-01\t2014-03-01\n+\n+\n+-- !query 8\n+select\n+  tsval,\n+  tsval - interval '2-2' year to month,\n+  tsval - interval '-2-2' year to month,\n+  tsval + interval '2-2' year to month,\n+  tsval + interval '-2-2' year to month,\n+  - interval '2-2' year to month + tsval,\n+  interval '2-2' year to month + tsval\n+from interval_arithmetic\n+-- !query 8 schema\n+struct<tsval:timestamp,CAST(tsval - interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval - interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval + interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + (- interval 2 years 2 months) AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp>\n+-- !query 8 output\n+2012-01-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\t2014-03-01 00:00:00\t2009-11-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\n+\n+\n+-- !query 9\n+select\n+  tsval,\n+  tsval - '2-2' year to month,\n+  tsval - '-2-2' year to month,\n+  tsval + '2-2' year to month,\n+  tsval + '-2-2' year to month,\n+  - '2-2' year to month + tsval,\n+  '2-2' year to month + tsval\n+from interval_arithmetic\n+-- !query 9 schema\n+struct<tsval:timestamp,CAST(tsval - interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval - interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval + interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + (- interval 2 years 2 months) AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp>\n+-- !query 9 output\n+2012-01-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\t2014-03-01 00:00:00\t2009-11-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\n+\n+\n+-- !query 10\n+select\n+  interval '2-2' year to month + interval '3-3' year to month,\n+  interval '2-2' year to month - interval '3-3' year to month\n+from interval_arithmetic\n+-- !query 10 schema\n+struct<(interval 2 years 2 months + interval 3 years 3 months):calendarinterval,(interval 2 years 2 months - interval 3 years 3 months):calendarinterval>\n+-- !query 10 output\n+interval 5 years 5 months\tinterval -1 years -1 months\n+\n+\n+-- !query 11\n+select\n+  '2-2' year to month + '3-3' year to month,\n+  '2-2' year to month - '3-3' year to month\n+from interval_arithmetic\n+-- !query 11 schema\n+struct<(interval 2 years 2 months + interval 3 years 3 months):calendarinterval,(interval 2 years 2 months - interval 3 years 3 months):calendarinterval>\n+-- !query 11 output\n+interval 5 years 5 months\tinterval -1 years -1 months\n+\n+\n+-- !query 12\n+select\n+  dateval,\n+  dateval - interval '99 11:22:33.123456789' day to second,\n+  dateval - interval '-99 11:22:33.123456789' day to second,\n+  dateval + interval '99 11:22:33.123456789' day to second,\n+  dateval + interval '-99 11:22:33.123456789' day to second,\n+  -interval '99 11:22:33.123456789' day to second + dateval,\n+  interval '99 11:22:33.123456789' day to second + dateval\n+from interval_arithmetic\n+-- !query 12 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date>\n+-- !query 12 output\n+2012-01-01\t2011-09-23\t2012-04-09\t2012-04-09\t2011-09-23\t2011-09-23\t2012-04-09\n+\n+\n+-- !query 13\n+select\n+  dateval,\n+  dateval - '99 11:22:33.123456789' day to second,\n+  dateval - '-99 11:22:33.123456789' day to second,\n+  dateval + '99 11:22:33.123456789' day to second,\n+  dateval + '-99 11:22:33.123456789' day to second,\n+  - '99 11:22:33.123456789' day to second + dateval,\n+  '99 11:22:33.123456789' day to second + dateval\n+from interval_arithmetic\n+-- !query 13 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date>\n+-- !query 13 output\n+2012-01-01\t2011-09-23\t2012-04-09\t2012-04-09\t2011-09-23\t2011-09-23\t2012-04-09\n+\n+\n+-- !query 14\n+select\n+  tsval,\n+  tsval - interval '99 11:22:33.123456789' day to second,\n+  tsval - interval '-99 11:22:33.123456789' day to second,\n+  tsval + interval '99 11:22:33.123456789' day to second,\n+  tsval + interval '-99 11:22:33.123456789' day to second,\n+  -interval '99 11:22:33.123456789' day to second + tsval,\n+  interval '99 11:22:33.123456789' day to second + tsval\n+from interval_arithmetic\n+-- !query 14 schema\n+struct<tsval:timestamp,CAST(tsval - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp>\n+-- !query 14 output\n+2012-01-01 00:00:00\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\t2012-04-09 12:22:33.123456\t2011-09-23 13:37:26.876544\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\n+\n+\n+-- !query 15\n+select\n+  tsval,\n+  tsval - '99 11:22:33.123456789' day to second,\n+  tsval - '-99 11:22:33.123456789' day to second,\n+  tsval + '99 11:22:33.123456789' day to second,\n+  tsval + '-99 11:22:33.123456789' day to second,\n+  - '99 11:22:33.123456789' day to second + tsval,\n+  '99 11:22:33.123456789' day to second + tsval\n+from interval_arithmetic\n+-- !query 15 schema\n+struct<tsval:timestamp,CAST(tsval - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp>\n+-- !query 15 output\n+2012-01-01 00:00:00\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\t2012-04-09 12:22:33.123456\t2011-09-23 13:37:26.876544\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\n+\n+\n+-- !query 16\n+select\n+  interval '99 11:22:33.123456789' day to second + interval '10 9:8:7.123456789' day to second,\n+  interval '99 11:22:33.123456789' day to second - interval '10 9:8:7.123456789' day to second\n+from interval_arithmetic\n+-- !query 16 schema\n+struct<(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds + interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval,(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds - interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval>\n+-- !query 16 output\n+interval 15 weeks 4 days 20 hours 30 minutes 40 seconds 246 milliseconds 912 microseconds\tinterval 12 weeks 5 days 2 hours 14 minutes 26 seconds\n+\n+\n+-- !query 17\n+select\n+  '99 11:22:33.123456789' day to second + '10 9:8:7.123456789' day to second,\n+  '99 11:22:33.123456789' day to second - '10 9:8:7.123456789' day to second\n+from interval_arithmetic\n+-- !query 17 schema\n+struct<(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds + interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval,(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds - interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval>\n+-- !query 17 output\n+interval 15 weeks 4 days 20 hours 30 minutes 40 seconds 246 milliseconds 912 microseconds\tinterval 12 weeks 5 days 2 hours 14 minutes 26 seconds\n+\n+\n+-- !query 18\n+select 30 day\n+-- !query 18 schema\n+struct<interval 4 weeks 2 days:calendarinterval>\n+-- !query 18 output\n+interval 4 weeks 2 days\n+\n+\n+-- !query 19\n+select 30 day day\n+-- !query 19 schema\n+struct<day:calendarinterval>\n+-- !query 19 output\n+interval 4 weeks 2 days\n+\n+\n+-- !query 20\n+select 30 day day day\n+-- !query 20 schema\n+struct<>\n+-- !query 20 output\n+org.apache.spark.sql.catalyst.parser.ParseException\n+\n+extraneous input 'day' expecting <EOF>(line 1, pos 18)\n+\n+== SQL ==\n+select 30 day day day\n+------------------^^^\n+\n+\n+-- !query 21\n+select date '2012-01-01' - 30 day\n+-- !query 21 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) - interval 4 weeks 2 days AS DATE):date>\n+-- !query 21 output\n+2011-12-02\n+\n+\n+-- !query 22\n+select date '2012-01-01' - 30 day day\n+-- !query 22 schema\n+struct<day:date>\n+-- !query 22 output\n+2011-12-02\n+\n+\n+-- !query 23\n+select date '2012-01-01' - 30 day day day\n+-- !query 23 schema\n+struct<>\n+-- !query 23 output\n+org.apache.spark.sql.catalyst.parser.ParseException\n+\n+extraneous input 'day' expecting <EOF>(line 1, pos 38)\n+\n+== SQL ==\n+select date '2012-01-01' - 30 day day day\n+--------------------------------------^^^\n+\n+\n+-- !query 24\n+select date '2012-01-01' + '-30' day\n+-- !query 24 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + interval -4 weeks -2 days AS DATE):date>\n+-- !query 24 output\n+2011-12-02\n+\n+\n+-- !query 25\n+select date '2012-01-01' + interval '-30' day\n+-- !query 25 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + interval -4 weeks -2 days AS DATE):date>\n+-- !query 25 output\n+2011-12-02\n+\n+\n+-- !query 26\n+select date '2012-01-01' + interval (-30) day\n+-- !query 26 schema\n+struct<>\n+-- !query 26 output\n+org.apache.spark.sql.AnalysisException\n+Undefined function: 'interval'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 27\n+\n+\n+-- !query 27\n+select date '2012-01-01' + (-30) day\n+-- !query 27 schema\n+struct<>\n+-- !query 27 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve '(DATE '2012-01-01' + -30)' due to data type mismatch: differing types in '(DATE '2012-01-01' + -30)' (date and int).; line 1 pos 7\n+\n+\n+-- !query 28\n+create temporary view t as select * from values (1), (2) as t(a)\n+-- !query 28 schema\n+struct<>\n+-- !query 28 output\n+\n+\n+\n+-- !query 29\n+select date '2012-01-01' + interval (a + 1) day from t\n+-- !query 29 schema\n+struct<>\n+-- !query 29 output\n+org.apache.spark.sql.AnalysisException\n+Undefined function: 'interval'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 27\n+\n+\n+-- !query 30\n+select date '2012-01-01' + (a + 1) day from t\n+-- !query 30 schema\n+struct<>\n+-- !query 30 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve '(DATE '2012-01-01' + (t.`a` + 1))' due to data type mismatch: differing types in '(DATE '2012-01-01' + (t.`a` + 1))' (date and int).; line 1 pos 7"
  }, {
    "author": {
      "login": "maropu"
    },
    "body": "~~ok, I'll add tests to check~~\r\nYou mean interval-interval cases? If so, this one? https://github.com/apache/spark/pull/20433/files#diff-24539a8bfdac0a14cec58755dd6565dbR237",
    "commit": "8e414ac6acd9e36d06d2002247727e2680fed31a",
    "createdAt": "2018-03-19T07:39:14Z",
    "diffHunk": "@@ -0,0 +1,375 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 31\n+\n+\n+-- !query 0\n+select\n+  '1' second,\n+  2  seconds,\n+  '1' minute,\n+  2  minutes,\n+  '1' hour,\n+  2  hours,\n+  '1' day,\n+  2  days,\n+  '1' month,\n+  2  months,\n+  '1' year,\n+  2  years\n+-- !query 0 schema\n+struct<interval 1 seconds:calendarinterval,interval 2 seconds:calendarinterval,interval 1 minutes:calendarinterval,interval 2 minutes:calendarinterval,interval 1 hours:calendarinterval,interval 2 hours:calendarinterval,interval 1 days:calendarinterval,interval 2 days:calendarinterval,interval 1 months:calendarinterval,interval 2 months:calendarinterval,interval 1 years:calendarinterval,interval 2 years:calendarinterval>\n+-- !query 0 output\n+interval 1 seconds\tinterval 2 seconds\tinterval 1 minutes\tinterval 2 minutes\tinterval 1 hours\tinterval 2 hours\tinterval 1 days\tinterval 2 days\tinterval 1 months\tinterval 2 months\tinterval 1 years\tinterval 2 years\n+\n+\n+-- !query 1\n+select\n+  interval '10-11' year to month,\n+  interval '10' year,\n+  interval '11' month\n+-- !query 1 schema\n+struct<interval 10 years 11 months:calendarinterval,interval 10 years:calendarinterval,interval 11 months:calendarinterval>\n+-- !query 1 output\n+interval 10 years 11 months\tinterval 10 years\tinterval 11 months\n+\n+\n+-- !query 2\n+select\n+  '10-11' year to month,\n+  '10' year,\n+  '11' month\n+-- !query 2 schema\n+struct<interval 10 years 11 months:calendarinterval,interval 10 years:calendarinterval,interval 11 months:calendarinterval>\n+-- !query 2 output\n+interval 10 years 11 months\tinterval 10 years\tinterval 11 months\n+\n+\n+-- !query 3\n+select\n+  interval '10 9:8:7.987654321' day to second,\n+  interval '10' day,\n+  interval '11' hour,\n+  interval '12' minute,\n+  interval '13' second,\n+  interval '13.123456789' second\n+-- !query 3 schema\n+struct<interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds:calendarinterval,interval 1 weeks 3 days:calendarinterval,interval 11 hours:calendarinterval,interval 12 minutes:calendarinterval,interval 13 seconds:calendarinterval,interval 13 seconds 123 milliseconds 456 microseconds:calendarinterval>\n+-- !query 3 output\n+interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds\tinterval 1 weeks 3 days\tinterval 11 hours\tinterval 12 minutes\tinterval 13 seconds\tinterval 13 seconds 123 milliseconds 456 microseconds\n+\n+\n+-- !query 4\n+select\n+  '10 9:8:7.987654321' day to second,\n+  '10' day,\n+  '11' hour,\n+  '12' minute,\n+  '13' second,\n+  '13.123456789' second\n+-- !query 4 schema\n+struct<interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds:calendarinterval,interval 1 weeks 3 days:calendarinterval,interval 11 hours:calendarinterval,interval 12 minutes:calendarinterval,interval 13 seconds:calendarinterval,interval 13 seconds 123 milliseconds 456 microseconds:calendarinterval>\n+-- !query 4 output\n+interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 987 milliseconds 654 microseconds\tinterval 1 weeks 3 days\tinterval 11 hours\tinterval 12 minutes\tinterval 13 seconds\tinterval 13 seconds 123 milliseconds 456 microseconds\n+\n+\n+-- !query 5\n+create temporary view interval_arithmetic as\n+  select CAST(dateval AS date), CAST(tsval AS timestamp) from values\n+    ('2012-01-01', '2012-01-01')\n+    as interval_arithmetic(dateval, tsval)\n+-- !query 5 schema\n+struct<>\n+-- !query 5 output\n+\n+\n+\n+-- !query 6\n+select\n+  dateval,\n+  dateval - interval '2-2' year to month,\n+  dateval - interval '-2-2' year to month,\n+  dateval + interval '2-2' year to month,\n+  dateval + interval '-2-2' year to month,\n+  - interval '2-2' year to month + dateval,\n+  interval '2-2' year to month + dateval\n+from interval_arithmetic\n+-- !query 6 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 2 years 2 months) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date>\n+-- !query 6 output\n+2012-01-01\t2009-11-01\t2014-03-01\t2014-03-01\t2009-11-01\t2009-11-01\t2014-03-01\n+\n+\n+-- !query 7\n+select\n+  dateval,\n+  dateval - '2-2' year to month,\n+  dateval - '-2-2' year to month,\n+  dateval + '2-2' year to month,\n+  dateval + '-2-2' year to month,\n+  - '2-2' year to month + dateval,\n+  '2-2' year to month + dateval\n+from interval_arithmetic\n+-- !query 7 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -2 years -2 months AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 2 years 2 months) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 2 years 2 months AS DATE):date>\n+-- !query 7 output\n+2012-01-01\t2009-11-01\t2014-03-01\t2014-03-01\t2009-11-01\t2009-11-01\t2014-03-01\n+\n+\n+-- !query 8\n+select\n+  tsval,\n+  tsval - interval '2-2' year to month,\n+  tsval - interval '-2-2' year to month,\n+  tsval + interval '2-2' year to month,\n+  tsval + interval '-2-2' year to month,\n+  - interval '2-2' year to month + tsval,\n+  interval '2-2' year to month + tsval\n+from interval_arithmetic\n+-- !query 8 schema\n+struct<tsval:timestamp,CAST(tsval - interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval - interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval + interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + (- interval 2 years 2 months) AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp>\n+-- !query 8 output\n+2012-01-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\t2014-03-01 00:00:00\t2009-11-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\n+\n+\n+-- !query 9\n+select\n+  tsval,\n+  tsval - '2-2' year to month,\n+  tsval - '-2-2' year to month,\n+  tsval + '2-2' year to month,\n+  tsval + '-2-2' year to month,\n+  - '2-2' year to month + tsval,\n+  '2-2' year to month + tsval\n+from interval_arithmetic\n+-- !query 9 schema\n+struct<tsval:timestamp,CAST(tsval - interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval - interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp,CAST(tsval + interval -2 years -2 months AS TIMESTAMP):timestamp,CAST(tsval + (- interval 2 years 2 months) AS TIMESTAMP):timestamp,CAST(tsval + interval 2 years 2 months AS TIMESTAMP):timestamp>\n+-- !query 9 output\n+2012-01-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\t2014-03-01 00:00:00\t2009-11-01 00:00:00\t2009-11-01 00:00:00\t2014-03-01 00:00:00\n+\n+\n+-- !query 10\n+select\n+  interval '2-2' year to month + interval '3-3' year to month,\n+  interval '2-2' year to month - interval '3-3' year to month\n+from interval_arithmetic\n+-- !query 10 schema\n+struct<(interval 2 years 2 months + interval 3 years 3 months):calendarinterval,(interval 2 years 2 months - interval 3 years 3 months):calendarinterval>\n+-- !query 10 output\n+interval 5 years 5 months\tinterval -1 years -1 months\n+\n+\n+-- !query 11\n+select\n+  '2-2' year to month + '3-3' year to month,\n+  '2-2' year to month - '3-3' year to month\n+from interval_arithmetic\n+-- !query 11 schema\n+struct<(interval 2 years 2 months + interval 3 years 3 months):calendarinterval,(interval 2 years 2 months - interval 3 years 3 months):calendarinterval>\n+-- !query 11 output\n+interval 5 years 5 months\tinterval -1 years -1 months\n+\n+\n+-- !query 12\n+select\n+  dateval,\n+  dateval - interval '99 11:22:33.123456789' day to second,\n+  dateval - interval '-99 11:22:33.123456789' day to second,\n+  dateval + interval '99 11:22:33.123456789' day to second,\n+  dateval + interval '-99 11:22:33.123456789' day to second,\n+  -interval '99 11:22:33.123456789' day to second + dateval,\n+  interval '99 11:22:33.123456789' day to second + dateval\n+from interval_arithmetic\n+-- !query 12 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date>\n+-- !query 12 output\n+2012-01-01\t2011-09-23\t2012-04-09\t2012-04-09\t2011-09-23\t2011-09-23\t2012-04-09\n+\n+\n+-- !query 13\n+select\n+  dateval,\n+  dateval - '99 11:22:33.123456789' day to second,\n+  dateval - '-99 11:22:33.123456789' day to second,\n+  dateval + '99 11:22:33.123456789' day to second,\n+  dateval + '-99 11:22:33.123456789' day to second,\n+  - '99 11:22:33.123456789' day to second + dateval,\n+  '99 11:22:33.123456789' day to second + dateval\n+from interval_arithmetic\n+-- !query 13 schema\n+struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS DATE):date>\n+-- !query 13 output\n+2012-01-01\t2011-09-23\t2012-04-09\t2012-04-09\t2011-09-23\t2011-09-23\t2012-04-09\n+\n+\n+-- !query 14\n+select\n+  tsval,\n+  tsval - interval '99 11:22:33.123456789' day to second,\n+  tsval - interval '-99 11:22:33.123456789' day to second,\n+  tsval + interval '99 11:22:33.123456789' day to second,\n+  tsval + interval '-99 11:22:33.123456789' day to second,\n+  -interval '99 11:22:33.123456789' day to second + tsval,\n+  interval '99 11:22:33.123456789' day to second + tsval\n+from interval_arithmetic\n+-- !query 14 schema\n+struct<tsval:timestamp,CAST(tsval - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp>\n+-- !query 14 output\n+2012-01-01 00:00:00\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\t2012-04-09 12:22:33.123456\t2011-09-23 13:37:26.876544\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\n+\n+\n+-- !query 15\n+select\n+  tsval,\n+  tsval - '99 11:22:33.123456789' day to second,\n+  tsval - '-99 11:22:33.123456789' day to second,\n+  tsval + '99 11:22:33.123456789' day to second,\n+  tsval + '-99 11:22:33.123456789' day to second,\n+  - '99 11:22:33.123456789' day to second + tsval,\n+  '99 11:22:33.123456789' day to second + tsval\n+from interval_arithmetic\n+-- !query 15 schema\n+struct<tsval:timestamp,CAST(tsval - interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval - interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + interval -14 weeks -1 days -11 hours -22 minutes -33 seconds -123 milliseconds -456 microseconds AS TIMESTAMP):timestamp,CAST(tsval + (- interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds) AS TIMESTAMP):timestamp,CAST(tsval + interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds AS TIMESTAMP):timestamp>\n+-- !query 15 output\n+2012-01-01 00:00:00\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\t2012-04-09 12:22:33.123456\t2011-09-23 13:37:26.876544\t2011-09-23 13:37:26.876544\t2012-04-09 12:22:33.123456\n+\n+\n+-- !query 16\n+select\n+  interval '99 11:22:33.123456789' day to second + interval '10 9:8:7.123456789' day to second,\n+  interval '99 11:22:33.123456789' day to second - interval '10 9:8:7.123456789' day to second\n+from interval_arithmetic\n+-- !query 16 schema\n+struct<(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds + interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval,(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds - interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval>\n+-- !query 16 output\n+interval 15 weeks 4 days 20 hours 30 minutes 40 seconds 246 milliseconds 912 microseconds\tinterval 12 weeks 5 days 2 hours 14 minutes 26 seconds\n+\n+\n+-- !query 17\n+select\n+  '99 11:22:33.123456789' day to second + '10 9:8:7.123456789' day to second,\n+  '99 11:22:33.123456789' day to second - '10 9:8:7.123456789' day to second\n+from interval_arithmetic\n+-- !query 17 schema\n+struct<(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds + interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval,(interval 14 weeks 1 days 11 hours 22 minutes 33 seconds 123 milliseconds 456 microseconds - interval 1 weeks 3 days 9 hours 8 minutes 7 seconds 123 milliseconds 456 microseconds):calendarinterval>\n+-- !query 17 output\n+interval 15 weeks 4 days 20 hours 30 minutes 40 seconds 246 milliseconds 912 microseconds\tinterval 12 weeks 5 days 2 hours 14 minutes 26 seconds\n+\n+\n+-- !query 18\n+select 30 day\n+-- !query 18 schema\n+struct<interval 4 weeks 2 days:calendarinterval>\n+-- !query 18 output\n+interval 4 weeks 2 days\n+\n+\n+-- !query 19\n+select 30 day day\n+-- !query 19 schema\n+struct<day:calendarinterval>\n+-- !query 19 output\n+interval 4 weeks 2 days\n+\n+\n+-- !query 20\n+select 30 day day day\n+-- !query 20 schema\n+struct<>\n+-- !query 20 output\n+org.apache.spark.sql.catalyst.parser.ParseException\n+\n+extraneous input 'day' expecting <EOF>(line 1, pos 18)\n+\n+== SQL ==\n+select 30 day day day\n+------------------^^^\n+\n+\n+-- !query 21\n+select date '2012-01-01' - 30 day\n+-- !query 21 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) - interval 4 weeks 2 days AS DATE):date>\n+-- !query 21 output\n+2011-12-02\n+\n+\n+-- !query 22\n+select date '2012-01-01' - 30 day day\n+-- !query 22 schema\n+struct<day:date>\n+-- !query 22 output\n+2011-12-02\n+\n+\n+-- !query 23\n+select date '2012-01-01' - 30 day day day\n+-- !query 23 schema\n+struct<>\n+-- !query 23 output\n+org.apache.spark.sql.catalyst.parser.ParseException\n+\n+extraneous input 'day' expecting <EOF>(line 1, pos 38)\n+\n+== SQL ==\n+select date '2012-01-01' - 30 day day day\n+--------------------------------------^^^\n+\n+\n+-- !query 24\n+select date '2012-01-01' + '-30' day\n+-- !query 24 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + interval -4 weeks -2 days AS DATE):date>\n+-- !query 24 output\n+2011-12-02\n+\n+\n+-- !query 25\n+select date '2012-01-01' + interval '-30' day\n+-- !query 25 schema\n+struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + interval -4 weeks -2 days AS DATE):date>\n+-- !query 25 output\n+2011-12-02\n+\n+\n+-- !query 26\n+select date '2012-01-01' + interval (-30) day\n+-- !query 26 schema\n+struct<>\n+-- !query 26 output\n+org.apache.spark.sql.AnalysisException\n+Undefined function: 'interval'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 27\n+\n+\n+-- !query 27\n+select date '2012-01-01' + (-30) day\n+-- !query 27 schema\n+struct<>\n+-- !query 27 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve '(DATE '2012-01-01' + -30)' due to data type mismatch: differing types in '(DATE '2012-01-01' + -30)' (date and int).; line 1 pos 7\n+\n+\n+-- !query 28\n+create temporary view t as select * from values (1), (2) as t(a)\n+-- !query 28 schema\n+struct<>\n+-- !query 28 output\n+\n+\n+\n+-- !query 29\n+select date '2012-01-01' + interval (a + 1) day from t\n+-- !query 29 schema\n+struct<>\n+-- !query 29 output\n+org.apache.spark.sql.AnalysisException\n+Undefined function: 'interval'. This function is neither a registered temporary function nor a permanent function registered in the database 'default'.; line 1 pos 27\n+\n+\n+-- !query 30\n+select date '2012-01-01' + (a + 1) day from t\n+-- !query 30 schema\n+struct<>\n+-- !query 30 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve '(DATE '2012-01-01' + (t.`a` + 1))' due to data type mismatch: differing types in '(DATE '2012-01-01' + (t.`a` + 1))' (date and int).; line 1 pos 7"
  }],
  "prId": 20433
}]