[{
  "comments": [{
    "author": {
      "login": "nsyca"
    },
    "body": "All the results are equivalent with the ones from DB2.",
    "commit": "3dd57fd7017e173cb00a53280a41783be634d6fe",
    "createdAt": "2017-02-15T20:25:06Z",
    "diffHunk": "@@ -0,0 +1,595 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 16\n+\n+\n+-- !query 0\n+create temporary view t1 as select * from values\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:00:00.000', date '2014-04-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1a\", 16S, 12, 21L, float(15.0), 20D, 20E2, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),\n+  (\"val1a\", 16S, 12, 10L, float(15.0), 20D, 20E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),\n+  (\"val1d\", null, 16, 22L, float(17.0), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', null),\n+  (\"val1d\", null, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-07-04 01:02:00.001', null),\n+  (\"val1e\", 10S, null, 25L, float(17.0), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),\n+  (\"val1d\", 10S, null, 12L, float(17.0), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')\n+  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view t2 as select * from values\n+  (\"val2a\", 6S, 12, 14L, float(15), 20D, 20E2, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 119L, float(17), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1c\", 12S, 16, 219L, float(17), 25D, 26E2, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),\n+  (\"val1b\", null, 16, 319L, float(17), 25D, 26E2, timestamp '2017-05-04 01:01:00.000', null),\n+  (\"val2e\", 8S, null, 419L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1f\", 19S, null, 519L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 12S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),\n+  (\"val1e\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),\n+  (\"val1f\", 19S, null, 19L, float(17), 25D, 26E2, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', null)\n+  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+create temporary view t3 as select * from values\n+  (\"val3a\", 6S, 12, 110L, float(15), 20D, 20E2, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),\n+  (\"val3a\", 6S, 12, 10L, float(15), 20D, 20E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 219L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 319L, float(17), 25D, 26E2, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),\n+  (\"val3c\", 17S, 16, 519L, float(17), 25D, 26E2, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),\n+  (\"val3c\", 17S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),\n+  (\"val1b\", null, 16, 419L, float(17), 25D, 26E2, timestamp '2014-10-04 01:02:00.000', null),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-11-04 01:02:00.000', null),\n+  (\"val3b\", 8S, null, 719L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val3b\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')\n+  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)\n+-- !query 2 schema\n+struct<>\n+-- !query 2 output\n+\n+\n+\n+-- !query 3\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2h,\n+       t2i\n+FROM   (SELECT *\n+        FROM   t2\n+        WHERE  t2a IN (SELECT t1a\n+                       FROM   t1)\n+        UNION ALL\n+        SELECT *\n+        FROM   t3\n+        WHERE  t3a IN (SELECT t1a\n+                       FROM   t1)) AS t3\n+WHERE  t2i IS NOT NULL AND\n+       2 * t2b = t2c\n+ORDER  BY t2c DESC nulls first\n+-- !query 3 schema\n+struct<t2a:string,t2b:smallint,t2c:int,t2h:timestamp,t2i:date>\n+-- !query 3 output\n+val1b\t8\t16\t2015-05-04 01:01:00\t2015-05-04\n+val1b\t8\t16\t2014-07-04 01:01:00\t2014-07-04\n+val1b\t8\t16\t2014-06-04 01:02:00\t2014-06-04\n+val1b\t8\t16\t2014-07-04 01:02:00\t2014-07-04\n+\n+\n+-- !query 4\n+SELECT t2a,\n+       t2b,\n+       t2d,\n+       Count(DISTINCT( t2h )),\n+       t2i\n+FROM   (SELECT *\n+        FROM   t2\n+        WHERE  t2a IN (SELECT t1a\n+                       FROM   t1\n+                       WHERE  t2b = t1b)\n+        UNION\n+        SELECT *\n+        FROM   t1\n+        WHERE  t1a IN (SELECT t3a\n+                       FROM   t3\n+                       WHERE  t1c = t3c)) AS t3\n+GROUP  BY t2a,\n+          t2b,\n+          t2d,\n+          t2i\n+ORDER  BY t2d DESC\n+-- !query 4 schema\n+struct<t2a:string,t2b:smallint,t2d:bigint,count(DISTINCT t2h):bigint,t2i:date>\n+-- !query 4 output\n+val1b\t8\t119\t1\t2015-05-04\n+val1b\t8\t19\t1\t2014-07-04\n+val1b\t8\t19\t1\t2014-05-04\n+\n+\n+-- !query 5\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       Min(t2d)\n+FROM   t2\n+WHERE  t2a IN (SELECT t1a\n+               FROM   t1\n+               WHERE  t1b = t2b)\n+GROUP BY t2a, t2b, t2c\n+UNION ALL\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       Max(t2d)\n+FROM   t2\n+WHERE  t2a IN (SELECT t1a\n+               FROM   t1\n+               WHERE  t2c = t1c)\n+GROUP BY t2a, t2b, t2c\n+UNION\n+SELECT t3a,\n+       t3b,\n+       t3c,\n+       Min(t3d)\n+FROM   t3\n+WHERE  t3a IN (SELECT t2a\n+               FROM   t2\n+               WHERE  t3c = t2c)\n+GROUP BY t3a, t3b, t3c\n+UNION DISTINCT\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       Max(t1d)\n+FROM   t1\n+WHERE  t1a IN (SELECT t3a\n+               FROM   t3\n+               WHERE  t3d = t1d)\n+GROUP BY t1a, t1b, t1c\n+-- !query 5 schema\n+struct<t2a:string,t2b:smallint,t2c:int,min(t2d):bigint>\n+-- !query 5 output\n+val1b\t10\t12\t19\n+val1b\t8\t16\t119\n+val1b\t8\t16\t19\n+val1b\tNULL\t16\t19\n+val1b\tNULL\t16\t319\n+val1c\t12\t16\t219\n+\n+\n+-- !query 6\n+SELECT DISTINCT( t2a ),\n+               t2b,\n+               Count(t2c),\n+               t2d,\n+               t2h,\n+               t2i\n+FROM   t2\n+WHERE  t2a IN (SELECT t1a\n+               FROM   t1\n+               WHERE  t1b = t2b)\n+GROUP  BY t2a,\n+          t2b,\n+          t2c,\n+          t2d,\n+          t2h,\n+          t2i\n+UNION\n+SELECT DISTINCT( t2a ),\n+               t2b,\n+               Count(t2c),\n+               t2d,\n+               t2h,\n+               t2i\n+FROM   t2\n+WHERE  t2a IN (SELECT t1a\n+               FROM   t1\n+               WHERE  t2c = t1c)\n+GROUP  BY t2a,\n+          t2b,\n+          t2c,\n+          t2d,\n+          t2h,\n+          t2i\n+HAVING t2b IS NOT NULL\n+-- !query 6 schema\n+struct<t2a:string,t2b:smallint,count(t2c):bigint,t2d:bigint,t2h:timestamp,t2i:date>\n+-- !query 6 output\n+val1b\t8\t1\t119\t2015-05-04 01:01:00\t2015-05-04\n+val1b\t8\t1\t19\t2014-07-04 01:01:00\t2014-07-04\n+val1c\t12\t1\t19\t2014-08-04 01:01:00\t2014-08-05\n+val1c\t12\t1\t219\t2016-05-04 01:01:00\t2016-05-04\n+\n+\n+-- !query 7\n+SELECT t2a,\n+               t2b,\n+               Count(t2c),\n+               t2d,\n+               t2h,\n+               t2i\n+FROM   t2\n+WHERE  t2a IN (SELECT DISTINCT(t1a)\n+               FROM   t1\n+               WHERE  t1b = t2b)\n+GROUP  BY t2a,\n+          t2b,\n+          t2c,\n+          t2d,\n+          t2h,\n+          t2i\n+\n+UNION\n+SELECT DISTINCT( t2a ),\n+               t2b,\n+               Count(t2c),\n+               t2d,\n+               t2h,\n+               t2i\n+FROM   t2\n+WHERE  t2b IN (SELECT Max(t1b)\n+               FROM   t1\n+               WHERE  t2c = t1c)\n+GROUP  BY t2a,\n+          t2b,\n+          t2c,\n+          t2d,\n+          t2h,\n+          t2i\n+HAVING t2b IS NOT NULL\n+UNION DISTINCT\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2d,\n+       t2h,\n+       t2i\n+FROM   t2\n+WHERE  t2d IN (SELECT min(t1d)\n+               FROM   t1\n+               WHERE  t2c = t1c)\n+-- !query 7 schema\n+struct<t2a:string,t2b:smallint,count(t2c):bigint,t2d:bigint,t2h:timestamp,t2i:date>\n+-- !query 7 output\n+val1b\t8\t1\t119\t2015-05-04 01:01:00\t2015-05-04\n+val1b\t8\t1\t19\t2014-07-04 01:01:00\t2014-07-04\n+val1b\t8\t16\t19\t2014-07-04 01:01:00\t2014-07-04\n+val1b\tNULL\t16\t19\t2014-05-04 01:01:00\tNULL\n+val1c\t12\t16\t19\t2014-08-04 01:01:00\t2014-08-05\n+\n+\n+-- !query 8\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2d\n+FROM   t2\n+WHERE  t2a IN (SELECT t1a\n+               FROM   t1\n+               WHERE  t1b = t2b AND\n+                      t1d < t2d)\n+INTERSECT\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2d\n+FROM   t2\n+WHERE  t2b IN (SELECT Max(t1b)\n+               FROM   t1\n+               WHERE  t2c = t1c)\n+EXCEPT\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2d\n+FROM   t2\n+WHERE  t2d IN (SELECT Min(t3d)\n+               FROM   t3\n+               WHERE  t2c = t3c)\n+UNION ALL\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2d\n+FROM   t2\n+WHERE  t2c IN (SELECT Max(t1c)\n+               FROM   t1\n+               WHERE t1d = t2d)\n+-- !query 8 schema\n+struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint>\n+-- !query 8 output\n+val1b\t8\t16\t119\n+val1b\t8\t16\t19\n+val1b\tNULL\t16\t19\n+val1c\t12\t16\t19\n+\n+\n+-- !query 9\n+SELECT DISTINCT(t1a),\n+       t1b,\n+       t1c,\n+       t1d\n+FROM   t1\n+WHERE  t1a IN (SELECT t3a\n+               FROM   (SELECT t2a t3a\n+                       FROM   t2\n+                       UNION ALL\n+                       SELECT t2a t3a\n+                       FROM   t2) AS t3\n+               UNION\n+               SELECT t2a\n+               FROM   (SELECT t2a\n+                       FROM   t2\n+                       WHERE  t2b > 6\n+                       UNION\n+                       SELECT t2a\n+                       FROM   t2\n+                       WHERE  t2b > 6) AS t4\n+               UNION DISTINCT\n+               SELECT t2a\n+               FROM   (SELECT t2a\n+                       FROM   t2\n+                       WHERE  t2b > 6\n+                       UNION DISTINCT\n+                       SELECT t1a\n+                       FROM   t1\n+                       WHERE  t1b > 6) AS t5)\n+GROUP BY t1a, t1b, t1c, t1d\n+HAVING t1c IS NOT NULL AND t1b IS NOT NULL\n+ORDER BY t1c DESC\n+-- !query 9 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint>\n+-- !query 9 output\n+val1c\t8\t16\t19\n+val1b\t8\t16\t19\n+val1a\t16\t12\t21\n+val1a\t16\t12\t10\n+val1a\t6\t8\t10\n+\n+\n+-- !query 10\n+SELECT t1a,\n+       t1b,\n+       t1c\n+FROM   t1\n+WHERE  t1b IN (SELECT t2b\n+               FROM   (SELECT t2b\n+                       FROM   t2\n+                       WHERE  t2b > 6\n+                       INTERSECT\n+                       SELECT t1b\n+                       FROM   t1\n+                       WHERE  t1b > 6) AS t3\n+               WHERE  t2b = t1b)\n+-- !query 10 schema\n+struct<t1a:string,t1b:smallint,t1c:int>\n+-- !query 10 output\n+val1b\t8\t16\n+val1c\t8\t16\n+val1d\t10\tNULL\n+val1e\t10\tNULL\n+val1e\t10\tNULL\n+val1e\t10\tNULL\n+\n+\n+-- !query 11\n+SELECT t1a,\n+       t1b,\n+       t1c\n+FROM   t1\n+WHERE  t1h IN (SELECT t2h\n+               FROM   (SELECT t2h\n+                       FROM   t2\n+                       EXCEPT\n+                       SELECT t3h\n+                       FROM   t3) AS t3)\n+ORDER BY t1b DESC NULLs first, t1c  DESC NULLs last\n+-- !query 11 schema\n+struct<t1a:string,t1b:smallint,t1c:int>\n+-- !query 11 output\n+val1d\tNULL\t16\n+val1a\t16\t12\n+val1e\t10\tNULL\n+val1d\t10\tNULL\n+val1e\t10\tNULL\n+val1b\t8\t16\n+\n+\n+-- !query 12\n+SELECT t1a,\n+       t1b,\n+       t1c\n+FROM   t1\n+WHERE  t1b IN\n+       (\n+              SELECT t2b\n+              FROM   (\n+                            SELECT t2b\n+                            FROM   t2\n+                            WHERE  t2b > 6\n+                            INTERSECT\n+                            SELECT t1b\n+                            FROM   t1\n+                            WHERE  t1b > 6) AS t3)\n+UNION DISTINCT\n+SELECT t1a,\n+       t1b,\n+       t1c\n+FROM   t1\n+WHERE  t1b IN\n+       (\n+              SELECT t2b\n+              FROM   (\n+                            SELECT t2b\n+                            FROM   t2\n+                            WHERE  t2b > 6\n+                            EXCEPT\n+                            SELECT t1b\n+                            FROM   t1\n+                            WHERE  t1b > 6) AS t4\n+              WHERE  t2b = t1b)\n+ORDER BY t1c DESC NULLS last\n+-- !query 12 schema\n+struct<t1a:string,t1b:smallint,t1c:int>\n+-- !query 12 output\n+val1c\t8\t16\n+val1b\t8\t16\n+val1e\t10\tNULL\n+val1d\t10\tNULL\n+\n+\n+-- !query 13\n+SELECT *\n+FROM   (SELECT *\n+        FROM   (SELECT *\n+                FROM   t2\n+                WHERE  t2h IN (SELECT t1h\n+                               FROM   t1\n+                               WHERE  t1a = t2a)\n+                UNION DISTINCT\n+                SELECT *\n+                FROM   t1\n+                WHERE  t1h IN (SELECT t3h\n+                               FROM   t3\n+                               UNION\n+                               SELECT t1h\n+                               FROM   t1)\n+                UNION\n+                SELECT *\n+                FROM   t3\n+                WHERE  t3a IN (SELECT t2a\n+                               FROM   t2\n+                               UNION ALL\n+                               SELECT t1a\n+                               FROM   t1\n+                               WHERE  t1b > 0)\n+               INTERSECT\n+               SELECT *\n+               FROM   T1\n+               WHERE  t1b IN (SELECT t3b\n+                              FROM   t3\n+                              UNION DISTINCT\n+                              SELECT t2b\n+                              FROM   t2\n+                               )\n+              EXCEPT\n+              SELECT *\n+              FROM   t2\n+              WHERE  t2h IN (SELECT t1i\n+                             FROM   t1)) t4\n+        WHERE  t4.t2b IN (SELECT Min(t3b)\n+                          FROM   t3\n+                          WHERE  t4.t2a = t3a))\n+-- !query 13 schema\n+struct<t2a:string,t2b:smallint,t2c:int,t2d:bigint,t2e:float,t2f:double,t2g:decimal(2,-2),t2h:timestamp,t2i:date>\n+-- !query 13 output\n+val1b\t8\t16\t19\t17.0\t25.0\t2600\t2014-05-04 01:01:00\t2014-05-04\n+\n+\n+-- !query 14\n+SELECT t2a,\n+       t2b,\n+       t2c,\n+       t2i\n+FROM   (SELECT *\n+        FROM   t2\n+        WHERE  t2a NOT IN (SELECT t1a\n+                           FROM   t1\n+                           UNION\n+                           SELECT t3a\n+                           FROM   t3)\n+        UNION ALL\n+        SELECT *\n+        FROM   t2\n+        WHERE  t2a NOT IN (SELECT t1a\n+                           FROM   t1\n+                           INTERSECT\n+                           SELECT t2a\n+                           FROM   t2)) AS t3\n+WHERE  t3.t2a NOT IN (SELECT t1a\n+                      FROM   t1\n+                      INTERSECT\n+                      SELECT t2a\n+                      FROM   t2)\n+       AND t2c IS NOT NULL\n+ORDER  BY t2a\n+-- !query 14 schema\n+struct<t2a:string,t2b:smallint,t2c:int,t2i:date>\n+-- !query 14 output\n+val2a\t6\t12\t2014-04-04\n+val2a\t6\t12\t2014-04-04\n+\n+\n+-- !query 15\n+SELECT   Count(DISTINCT(t1a)),\n+         t1b,\n+         t1c,\n+         t1i\n+FROM     t1\n+WHERE    t1b NOT IN\n+         (\n+                SELECT t2b\n+                FROM   (\n+                              SELECT t2b\n+                              FROM   t2\n+                              WHERE  t2b NOT IN\n+                                     (\n+                                            SELECT t1b\n+                                            FROM   t1)\n+                              UNION\n+                              SELECT t1b\n+                              FROM   t1\n+                              WHERE  t1b NOT IN\n+                                     (\n+                                            SELECT t3b\n+                                            FROM   t3)\n+                              UNION\n+                                    distinct SELECT t3b\n+                              FROM   t3\n+                              WHERE  t3b NOT IN\n+                                     (\n+                                            SELECT t2b\n+                                            FROM   t2)) AS t3\n+                WHERE  t2b = t1b)\n+GROUP BY t1a,\n+         t1b,\n+         t1c,\n+         t1i\n+HAVING   t1b NOT IN\n+         (\n+                SELECT t2b\n+                FROM   t2\n+                WHERE  t2c IS NULL\n+                EXCEPT\n+                SELECT t3b\n+                FROM   t3)\n+ORDER BY t1c DESC NULLS LAST\n+-- !query 15 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint,t1c:int,t1i:date>\n+-- !query 15 output\n+1\t8\t16\t2014-05-05\n+1\t8\t16\t2014-05-04\n+1\t16\t12\t2014-06-04\n+1\t16\t12\t2014-07-04\n+1\t6\t8\t2014-04-04\n+1\t10\tNULL\t2014-08-04\n+1\t10\tNULL\t2014-09-04\n+1\t10\tNULL\t2015-05-04\n+1\t10\tNULL\t2014-05-04",
    "line": 595
  }],
  "prId": 16915
}]