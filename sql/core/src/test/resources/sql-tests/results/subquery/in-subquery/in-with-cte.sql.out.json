[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "The style looks strange. Could you adjust them?",
    "commit": "3dd57fd7017e173cb00a53280a41783be634d6fe",
    "createdAt": "2017-02-13T21:41:44Z",
    "diffHunk": "@@ -0,0 +1,368 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view t1 as select * from values\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:00:00.000', date '2014-04-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1a\", 16S, 12, 21L, float(15.0), 20D, 20E2, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),\n+  (\"val1a\", 16S, 12, 10L, float(15.0), 20D, 20E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),\n+  (\"val1d\", null, 16, 22L, float(17.0), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', null),\n+  (\"val1d\", null, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-07-04 01:02:00.001', null),\n+  (\"val1e\", 10S, null, 25L, float(17.0), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),\n+  (\"val1d\", 10S, null, 12L, float(17.0), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')\n+  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view t2 as select * from values\n+  (\"val2a\", 6S, 12, 14L, float(15), 20D, 20E2, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 119L, float(17), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1c\", 12S, 16, 219L, float(17), 25D, 26E2, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),\n+  (\"val1b\", null, 16, 319L, float(17), 25D, 26E2, timestamp '2017-05-04 01:01:00.000', null),\n+  (\"val2e\", 8S, null, 419L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1f\", 19S, null, 519L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 12S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),\n+  (\"val1e\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),\n+  (\"val1f\", 19S, null, 19L, float(17), 25D, 26E2, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', null)\n+  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+create temporary view t3 as select * from values\n+  (\"val3a\", 6S, 12, 110L, float(15), 20D, 20E2, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),\n+  (\"val3a\", 6S, 12, 10L, float(15), 20D, 20E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 219L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 319L, float(17), 25D, 26E2, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),\n+  (\"val3c\", 17S, 16, 519L, float(17), 25D, 26E2, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),\n+  (\"val3c\", 17S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),\n+  (\"val1b\", null, 16, 419L, float(17), 25D, 26E2, timestamp '2014-10-04 01:02:00.000', null),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-11-04 01:02:00.000', null),\n+  (\"val3b\", 8S, null, 719L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val3b\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')\n+  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)\n+-- !query 2 schema\n+struct<>\n+-- !query 2 output\n+\n+\n+\n+-- !query 3\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1a = \"val1a\")\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1d,\n+       t1h\n+FROM   t1\n+WHERE  t1b IN (SELECT cte1.t1b\n+               FROM   cte1\n+               WHERE  cte1.t1b > 0)\n+-- !query 3 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1h:timestamp>\n+-- !query 3 output\n+val1a\t16\t12\t10\t2014-07-04 01:01:00\n+val1a\t16\t12\t21\t2014-06-04 01:02:00.001\n+val1a\t6\t8\t10\t2014-04-04 01:00:00\n+val1a\t6\t8\t10\t2014-04-04 01:02:00.001\n+\n+\n+-- !query 4\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1)\n+SELECT count(distinct(t1a)), t1b, t1c\n+FROM   t1\n+WHERE  t1b IN\n+       (\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 0\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 5\n+              UNION ALL\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              INTERSECT\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1 )\n+GROUP BY t1a, t1b, t1c\n+HAVING t1c IS NOT NULL\n+-- !query 4 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint,t1c:int>\n+-- !query 4 output\n+1\t16\t12\n+1\t6\t8\n+1\t8\t16\n+1\t8\t16\n+\n+\n+-- !query 5\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1c,\n+              t1d,\n+              t1e\n+       FROM   t1)\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1h\n+FROM   t1\n+WHERE  t1c IN\n+       (\n+              SELECT          cte1.t1c\n+              FROM            cte1\n+              JOIN            cte1 cte2\n+              on              cte1.t1b > cte2.t1b\n+              FULL OUTER JOIN cte1 cte3\n+              ON              cte1.t1c = cte3.t1c\n+              LEFT JOIN       cte1 cte4\n+              ON              cte1.t1d = cte4.t1d\n+              INNER JOIN  cte1 cte5\n+              ON              cte1.t1b < cte5.t1b\n+              LEFT OUTER JOIN  cte1 cte6\n+              ON              cte1.t1d > cte6.t1d)\n+-- !query 5 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1h:timestamp>\n+-- !query 5 output\n+val1b\t8\t16\t2014-05-04 01:01:00\n+val1c\t8\t16\t2014-05-04 01:02:00.001\n+val1d\tNULL\t16\t2014-06-04 01:01:00\n+val1d\tNULL\t16\t2014-07-04 01:02:00.001\n+\n+\n+-- !query 6\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1\n+       WHERE  t1b IN\n+              (\n+                         SELECT     t2b\n+                         FROM       t2\n+                         RIGHT JOIN t1\n+                         ON         t1c = t2c\n+                         LEFT JOIN  t3\n+                         ON         t2d = t3d ) AND\n+              t1a = \"val1b\")"
  }, {
    "author": {
      "login": "kevinyu98"
    },
    "body": "sure, I have adjust the style and resubmit. thanks.",
    "commit": "3dd57fd7017e173cb00a53280a41783be634d6fe",
    "createdAt": "2017-02-14T01:31:08Z",
    "diffHunk": "@@ -0,0 +1,368 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view t1 as select * from values\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:00:00.000', date '2014-04-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1a\", 16S, 12, 21L, float(15.0), 20D, 20E2, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),\n+  (\"val1a\", 16S, 12, 10L, float(15.0), 20D, 20E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),\n+  (\"val1d\", null, 16, 22L, float(17.0), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', null),\n+  (\"val1d\", null, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-07-04 01:02:00.001', null),\n+  (\"val1e\", 10S, null, 25L, float(17.0), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),\n+  (\"val1d\", 10S, null, 12L, float(17.0), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')\n+  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view t2 as select * from values\n+  (\"val2a\", 6S, 12, 14L, float(15), 20D, 20E2, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 119L, float(17), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1c\", 12S, 16, 219L, float(17), 25D, 26E2, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),\n+  (\"val1b\", null, 16, 319L, float(17), 25D, 26E2, timestamp '2017-05-04 01:01:00.000', null),\n+  (\"val2e\", 8S, null, 419L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1f\", 19S, null, 519L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 12S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),\n+  (\"val1e\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),\n+  (\"val1f\", 19S, null, 19L, float(17), 25D, 26E2, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', null)\n+  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+create temporary view t3 as select * from values\n+  (\"val3a\", 6S, 12, 110L, float(15), 20D, 20E2, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),\n+  (\"val3a\", 6S, 12, 10L, float(15), 20D, 20E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 219L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 319L, float(17), 25D, 26E2, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),\n+  (\"val3c\", 17S, 16, 519L, float(17), 25D, 26E2, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),\n+  (\"val3c\", 17S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),\n+  (\"val1b\", null, 16, 419L, float(17), 25D, 26E2, timestamp '2014-10-04 01:02:00.000', null),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-11-04 01:02:00.000', null),\n+  (\"val3b\", 8S, null, 719L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val3b\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')\n+  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)\n+-- !query 2 schema\n+struct<>\n+-- !query 2 output\n+\n+\n+\n+-- !query 3\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1a = \"val1a\")\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1d,\n+       t1h\n+FROM   t1\n+WHERE  t1b IN (SELECT cte1.t1b\n+               FROM   cte1\n+               WHERE  cte1.t1b > 0)\n+-- !query 3 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1h:timestamp>\n+-- !query 3 output\n+val1a\t16\t12\t10\t2014-07-04 01:01:00\n+val1a\t16\t12\t21\t2014-06-04 01:02:00.001\n+val1a\t6\t8\t10\t2014-04-04 01:00:00\n+val1a\t6\t8\t10\t2014-04-04 01:02:00.001\n+\n+\n+-- !query 4\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1)\n+SELECT count(distinct(t1a)), t1b, t1c\n+FROM   t1\n+WHERE  t1b IN\n+       (\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 0\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 5\n+              UNION ALL\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              INTERSECT\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1 )\n+GROUP BY t1a, t1b, t1c\n+HAVING t1c IS NOT NULL\n+-- !query 4 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint,t1c:int>\n+-- !query 4 output\n+1\t16\t12\n+1\t6\t8\n+1\t8\t16\n+1\t8\t16\n+\n+\n+-- !query 5\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1c,\n+              t1d,\n+              t1e\n+       FROM   t1)\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1h\n+FROM   t1\n+WHERE  t1c IN\n+       (\n+              SELECT          cte1.t1c\n+              FROM            cte1\n+              JOIN            cte1 cte2\n+              on              cte1.t1b > cte2.t1b\n+              FULL OUTER JOIN cte1 cte3\n+              ON              cte1.t1c = cte3.t1c\n+              LEFT JOIN       cte1 cte4\n+              ON              cte1.t1d = cte4.t1d\n+              INNER JOIN  cte1 cte5\n+              ON              cte1.t1b < cte5.t1b\n+              LEFT OUTER JOIN  cte1 cte6\n+              ON              cte1.t1d > cte6.t1d)\n+-- !query 5 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1h:timestamp>\n+-- !query 5 output\n+val1b\t8\t16\t2014-05-04 01:01:00\n+val1c\t8\t16\t2014-05-04 01:02:00.001\n+val1d\tNULL\t16\t2014-06-04 01:01:00\n+val1d\tNULL\t16\t2014-07-04 01:02:00.001\n+\n+\n+-- !query 6\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1\n+       WHERE  t1b IN\n+              (\n+                         SELECT     t2b\n+                         FROM       t2\n+                         RIGHT JOIN t1\n+                         ON         t1c = t2c\n+                         LEFT JOIN  t3\n+                         ON         t2d = t3d ) AND\n+              t1a = \"val1b\")"
  }],
  "prId": 16915
}, {
  "comments": [{
    "author": {
      "login": "nsyca"
    },
    "body": "All the results are equivalent with the ones from DB2.",
    "commit": "3dd57fd7017e173cb00a53280a41783be634d6fe",
    "createdAt": "2017-02-15T20:27:30Z",
    "diffHunk": "@@ -0,0 +1,364 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view t1 as select * from values\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:00:00.000', date '2014-04-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1a\", 16S, 12, 21L, float(15.0), 20D, 20E2, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),\n+  (\"val1a\", 16S, 12, 10L, float(15.0), 20D, 20E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),\n+  (\"val1d\", null, 16, 22L, float(17.0), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', null),\n+  (\"val1d\", null, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-07-04 01:02:00.001', null),\n+  (\"val1e\", 10S, null, 25L, float(17.0), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),\n+  (\"val1d\", 10S, null, 12L, float(17.0), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1a\", 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),\n+  (\"val1e\", 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')\n+  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view t2 as select * from values\n+  (\"val2a\", 6S, 12, 14L, float(15), 20D, 20E2, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 119L, float(17), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  (\"val1c\", 12S, 16, 219L, float(17), 25D, 26E2, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),\n+  (\"val1b\", null, 16, 319L, float(17), 25D, 26E2, timestamp '2017-05-04 01:01:00.000', null),\n+  (\"val2e\", 8S, null, 419L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1f\", 19S, null, 519L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  (\"val1c\", 12S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),\n+  (\"val1e\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),\n+  (\"val1f\", 19S, null, 19L, float(17), 25D, 26E2, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', null)\n+  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+create temporary view t3 as select * from values\n+  (\"val3a\", 6S, 12, 110L, float(15), 20D, 20E2, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),\n+  (\"val3a\", 6S, 12, 10L, float(15), 20D, 20E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 219L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val1b\", 8S, 16, 319L, float(17), 25D, 26E2, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),\n+  (\"val1b\", 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),\n+  (\"val3c\", 17S, 16, 519L, float(17), 25D, 26E2, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),\n+  (\"val3c\", 17S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),\n+  (\"val1b\", null, 16, 419L, float(17), 25D, 26E2, timestamp '2014-10-04 01:02:00.000', null),\n+  (\"val1b\", null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-11-04 01:02:00.000', null),\n+  (\"val3b\", 8S, null, 719L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  (\"val3b\", 8S, null, 19L, float(17), 25D, 26E2, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')\n+  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)\n+-- !query 2 schema\n+struct<>\n+-- !query 2 output\n+\n+\n+\n+-- !query 3\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1a = \"val1a\")\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1d,\n+       t1h\n+FROM   t1\n+WHERE  t1b IN (SELECT cte1.t1b\n+               FROM   cte1\n+               WHERE  cte1.t1b > 0)\n+-- !query 3 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1h:timestamp>\n+-- !query 3 output\n+val1a\t16\t12\t10\t2014-07-04 01:01:00\n+val1a\t16\t12\t21\t2014-06-04 01:02:00.001\n+val1a\t6\t8\t10\t2014-04-04 01:00:00\n+val1a\t6\t8\t10\t2014-04-04 01:02:00.001\n+\n+\n+-- !query 4\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1)\n+SELECT count(distinct(t1a)), t1b, t1c\n+FROM   t1\n+WHERE  t1b IN\n+       (\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 0\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              WHERE  cte1.t1b > 5\n+              UNION ALL\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              INTERSECT\n+              SELECT cte1.t1b\n+              FROM   cte1\n+              UNION\n+              SELECT cte1.t1b\n+              FROM   cte1 )\n+GROUP BY t1a, t1b, t1c\n+HAVING t1c IS NOT NULL\n+-- !query 4 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint,t1c:int>\n+-- !query 4 output\n+1\t16\t12\n+1\t6\t8\n+1\t8\t16\n+1\t8\t16\n+\n+\n+-- !query 5\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1c,\n+              t1d,\n+              t1e\n+       FROM   t1)\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1h\n+FROM   t1\n+WHERE  t1c IN\n+       (\n+              SELECT          cte1.t1c\n+              FROM            cte1\n+              JOIN            cte1 cte2\n+              on              cte1.t1b > cte2.t1b\n+              FULL OUTER JOIN cte1 cte3\n+              ON              cte1.t1c = cte3.t1c\n+              LEFT JOIN       cte1 cte4\n+              ON              cte1.t1d = cte4.t1d\n+              INNER JOIN  cte1 cte5\n+              ON              cte1.t1b < cte5.t1b\n+              LEFT OUTER JOIN  cte1 cte6\n+              ON              cte1.t1d > cte6.t1d)\n+-- !query 5 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1h:timestamp>\n+-- !query 5 output\n+val1b\t8\t16\t2014-05-04 01:01:00\n+val1c\t8\t16\t2014-05-04 01:02:00.001\n+val1d\tNULL\t16\t2014-06-04 01:01:00\n+val1d\tNULL\t16\t2014-07-04 01:02:00.001\n+\n+\n+-- !query 6\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1b IN (SELECT t2b\n+                        FROM   t2\n+                               RIGHT JOIN t1\n+                                       ON t1c = t2c\n+                               LEFT JOIN t3\n+                                      ON t2d = t3d)\n+                AND t1a = \"val1b\")\n+SELECT *\n+FROM   (SELECT *\n+        FROM   cte1\n+               JOIN cte1 cte2\n+                 ON cte1.t1b > 5\n+                    AND cte1.t1a = cte2.t1a\n+               FULL OUTER JOIN cte1 cte3\n+                            ON cte1.t1a = cte3.t1a\n+               INNER JOIN cte1 cte4\n+                       ON cte1.t1b = cte4.t1b) s\n+-- !query 6 schema\n+struct<t1a:string,t1b:smallint,t1a:string,t1b:smallint,t1a:string,t1b:smallint,t1a:string,t1b:smallint>\n+-- !query 6 output\n+val1b\t8\tval1b\t8\tval1b\t8\tval1b\t8\n+\n+\n+-- !query 7\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1h\n+       FROM   t1\n+       WHERE  t1a IN\n+              (\n+                     SELECT t2a\n+                     FROM   t2\n+                     WHERE  t1b < t2b))\n+SELECT   Count(DISTINCT t1a),\n+         t1b\n+FROM     (\n+                    SELECT     cte1.t1a,\n+                               cte1.t1b\n+                    FROM       cte1\n+                    JOIN       cte1 cte2\n+                    on         cte1.t1h >= cte2.t1h) s\n+WHERE    t1b IN\n+         (\n+                SELECT t1b\n+                FROM   t1)\n+GROUP BY t1b\n+-- !query 7 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint>\n+-- !query 7 output\n+2\t8\n+\n+\n+-- !query 8\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1c\n+       FROM   t1\n+       WHERE  t1b IN\n+              (\n+                     SELECT t2b\n+                     FROM   t2 FULL OUTER JOIN T3 on t2a = t3a\n+                     WHERE  t1c = t2c) AND\n+              t1a = \"val1b\")\n+SELECT *\n+FROM            (\n+                       SELECT *\n+                       FROM   cte1\n+                       INNER JOIN   cte1 cte2 ON cte1.t1a = cte2.t1a\n+                       RIGHT OUTER JOIN cte1 cte3  ON cte1.t1b = cte3.t1b\n+                       LEFT OUTER JOIN cte1 cte4 ON cte1.t1c = cte4.t1c\n+                       ) s\n+-- !query 8 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1a:string,t1b:smallint,t1c:int,t1a:string,t1b:smallint,t1c:int,t1a:string,t1b:smallint,t1c:int>\n+-- !query 8 output\n+val1b\t8\t16\tval1b\t8\t16\tval1b\t8\t16\tval1b\t8\t16\n+\n+\n+-- !query 9\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1b IN (SELECT t2b\n+                        FROM   t2\n+                        WHERE  t1c = t2c))\n+SELECT Count(DISTINCT( s.t1a )),\n+       s.t1b\n+FROM   (SELECT cte1.t1a,\n+               cte1.t1b\n+        FROM   cte1\n+               RIGHT OUTER JOIN cte1 cte2\n+                             ON cte1.t1a = cte2.t1a) s\n+GROUP  BY s.t1b\n+-- !query 9 schema\n+struct<count(DISTINCT t1a):bigint,t1b:smallint>\n+-- !query 9 output\n+2\t8\n+\n+\n+-- !query 10\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b\n+       FROM   t1\n+       WHERE  t1b IN\n+              (\n+                     SELECT t2b\n+                     FROM   t2\n+                     WHERE  t1c = t2c))\n+SELECT DISTINCT(s.t1b)\n+FROM            (\n+                                SELECT          cte1.t1b\n+                                FROM            cte1\n+                                LEFT OUTER JOIN cte1 cte2\n+                                ON              cte1.t1b = cte2.t1b) s\n+WHERE           s.t1b IN\n+                (\n+                       SELECT t1.t1b\n+                       FROM   t1 INNER\n+                       JOIN   cte1\n+                       ON     t1.t1a = cte1.t1a)\n+-- !query 10 schema\n+struct<t1b:smallint>\n+-- !query 10 output\n+8\n+\n+\n+-- !query 11\n+WITH cte1\n+     AS (SELECT t1a,\n+                t1b\n+         FROM   t1\n+         WHERE  t1a = \"val1d\")\n+SELECT t1a,\n+       t1b,\n+       t1c,\n+       t1h\n+FROM   t1\n+WHERE  t1b NOT IN (SELECT cte1.t1b\n+                   FROM   cte1\n+                   WHERE  cte1.t1b < 0) AND\n+       t1c > 10\n+-- !query 11 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1h:timestamp>\n+-- !query 11 output\n+val1a\t16\t12\t2014-06-04 01:02:00.001\n+val1a\t16\t12\t2014-07-04 01:01:00\n+val1b\t8\t16\t2014-05-04 01:01:00\n+val1c\t8\t16\t2014-05-04 01:02:00.001\n+val1d\tNULL\t16\t2014-06-04 01:01:00\n+val1d\tNULL\t16\t2014-07-04 01:02:00.001\n+\n+\n+-- !query 12\n+WITH cte1 AS\n+(\n+       SELECT t1a,\n+              t1b,\n+              t1c,\n+              t1d,\n+              t1h\n+       FROM   t1\n+       WHERE  t1d NOT IN\n+              (\n+                              SELECT          t2d\n+                              FROM            t2\n+                              FULL OUTER JOIN t3 ON t2a = t3a\n+                              JOIN t1 on t1b = t2b))\n+SELECT   t1a,\n+         t1b,\n+         t1c,\n+         t1d,\n+         t1h\n+FROM     t1\n+WHERE    t1b NOT IN\n+         (\n+                    SELECT     cte1.t1b\n+                    FROM       cte1 INNER\n+                    JOIN       cte1 cte2 ON cte1.t1a = cte2.t1a\n+                    RIGHT JOIN cte1 cte3 ON cte1.t1b = cte3.t1b\n+                    JOIN cte1 cte4 ON cte1.t1c = cte4.t1c) AND\n+         t1c IS NOT NULL\n+ORDER BY t1c DESC\n+-- !query 12 schema\n+struct<t1a:string,t1b:smallint,t1c:int,t1d:bigint,t1h:timestamp>\n+-- !query 12 output\n+val1b\t8\t16\t19\t2014-05-04 01:01:00\n+val1c\t8\t16\t19\t2014-05-04 01:02:00.001",
    "line": 364
  }],
  "prId": 16915
}]