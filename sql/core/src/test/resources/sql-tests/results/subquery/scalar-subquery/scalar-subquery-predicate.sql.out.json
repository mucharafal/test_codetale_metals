[{
  "comments": [{
    "author": {
      "login": "dilipbiswal"
    },
    "body": "I have compared the result set matched with the result from DB2.",
    "commit": "044d6a4927f77bb50631d74830a7a999a6d6fd26",
    "createdAt": "2017-02-04T01:43:33Z",
    "diffHunk": "@@ -0,0 +1,407 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 25\n+\n+\n+-- !query 0\n+CREATE OR REPLACE TEMPORARY VIEW p AS VALUES (1, 1) AS T(pk, pv)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+CREATE OR REPLACE TEMPORARY VIEW c AS VALUES (1, 1) AS T(ck, cv)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT pk, cv\n+FROM   p, c\n+WHERE  p.pk = c.ck\n+AND    c.cv = (SELECT avg(c1.cv)\n+               FROM   c c1\n+               WHERE  c1.ck = p.pk)\n+-- !query 2 schema\n+struct<pk:int,cv:int>\n+-- !query 2 output\n+1\t1\n+\n+\n+-- !query 3\n+SELECT pk, cv\n+FROM   p, c\n+WHERE  p.pk = c.ck\n+AND    c.cv = (SELECT max(avg)\n+               FROM   (SELECT   c1.cv, avg(c1.cv) avg\n+                       FROM     c c1\n+                       WHERE    c1.ck = p.pk\n+                       GROUP BY c1.cv))\n+-- !query 3 schema\n+struct<pk:int,cv:int>\n+-- !query 3 output\n+1\t1\n+\n+\n+-- !query 4\n+create temporary view t1 as select * from values\n+  ('val1a', 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 00:00:00.000', date '2014-04-04'),\n+  ('val1b', 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  ('val1a', 16S, 12, 21L, float(15.0), 20D, 20E2, timestamp '2014-06-04 01:02:00.001', date '2014-06-04'),\n+  ('val1a', 16S, 12, 10L, float(15.0), 20D, 20E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  ('val1c', 8S, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:02:00.001', date '2014-05-05'),\n+  ('val1d', null, 16, 22L, float(17.0), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', null),\n+  ('val1d', null, 16, 19L, float(17.0), 25D, 26E2, timestamp '2014-07-04 01:02:00.001', null),\n+  ('val1e', 10S, null, 25L, float(17.0), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-04'),\n+  ('val1e', 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-09-04 01:02:00.001', date '2014-09-04'),\n+  ('val1d', 10S, null, 12L, float(17.0), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  ('val1a', 6S, 8, 10L, float(15.0), 20D, 20E2, timestamp '2014-04-04 01:02:00.001', date '2014-04-04'),\n+  ('val1e', 10S, null, 19L, float(17.0), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04')\n+  as t1(t1a, t1b, t1c, t1d, t1e, t1f, t1g, t1h, t1i)\n+-- !query 4 schema\n+struct<>\n+-- !query 4 output\n+\n+\n+\n+-- !query 5\n+create temporary view t2 as select * from values\n+  ('val2a', 6S, 12, 14L, float(15), 20D, 20E2, timestamp '2014-04-04 01:01:00.000', date '2014-04-04'),\n+  ('val1b', 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  ('val1b', 8S, 16, 119L, float(17), 25D, 26E2, timestamp '2015-05-04 01:01:00.000', date '2015-05-04'),\n+  ('val1c', 12S, 16, 219L, float(17), 25D, 26E2, timestamp '2016-05-04 01:01:00.000', date '2016-05-04'),\n+  ('val1b', null, 16, 319L, float(17), 25D, 26E2, timestamp '2017-05-04 01:01:00.000', null),\n+  ('val2e', 8S, null, 419L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  ('val1f', 19S, null, 519L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', date '2014-05-04'),\n+  ('val1b', 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-06-04 01:01:00.000', date '2014-06-04'),\n+  ('val1b', 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:01:00.000', date '2014-07-04'),\n+  ('val1c', 12S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-08-04 01:01:00.000', date '2014-08-05'),\n+  ('val1e', 8S, null, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:01:00.000', date '2014-09-04'),\n+  ('val1f', 19S, null, 19L, float(17), 25D, 26E2, timestamp '2014-10-04 01:01:00.000', date '2014-10-04'),\n+  ('val1b', null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:01:00.000', null)\n+  as t2(t2a, t2b, t2c, t2d, t2e, t2f, t2g, t2h, t2i)\n+-- !query 5 schema\n+struct<>\n+-- !query 5 output\n+\n+\n+\n+-- !query 6\n+create temporary view t3 as select * from values\n+  ('val3a', 6S, 12, 110L, float(15), 20D, 20E2, timestamp '2014-04-04 01:02:00.000', date '2014-04-04'),\n+  ('val3a', 6S, 12, 10L, float(15), 20D, 20E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  ('val1b', 10S, 12, 219L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  ('val1b', 10S, 12, 19L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  ('val1b', 8S, 16, 319L, float(17), 25D, 26E2, timestamp '2014-06-04 01:02:00.000', date '2014-06-04'),\n+  ('val1b', 8S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-07-04 01:02:00.000', date '2014-07-04'),\n+  ('val3c', 17S, 16, 519L, float(17), 25D, 26E2, timestamp '2014-08-04 01:02:00.000', date '2014-08-04'),\n+  ('val3c', 17S, 16, 19L, float(17), 25D, 26E2, timestamp '2014-09-04 01:02:00.000', date '2014-09-05'),\n+  ('val1b', null, 16, 419L, float(17), 25D, 26E2, timestamp '2014-10-04 01:02:00.000', null),\n+  ('val1b', null, 16, 19L, float(17), 25D, 26E2, timestamp '2014-11-04 01:02:00.000', null),\n+  ('val3b', 8S, null, 719L, float(17), 25D, 26E2, timestamp '2014-05-04 01:02:00.000', date '2014-05-04'),\n+  ('val3b', 8S, null, 19L, float(17), 25D, 26E2, timestamp '2015-05-04 01:02:00.000', date '2015-05-04')\n+  as t3(t3a, t3b, t3c, t3d, t3e, t3f, t3g, t3h, t3i)\n+-- !query 6 schema\n+struct<>\n+-- !query 6 output\n+\n+\n+\n+-- !query 7\n+SELECT t1a, t1b\n+FROM   t1\n+WHERE  t1c = (SELECT max(t2c)\n+              FROM   t2)\n+-- !query 7 schema\n+struct<t1a:string,t1b:smallint>\n+-- !query 7 output\n+val1b\t8\n+val1c\t8\n+val1d\tNULL\n+val1d\tNULL\n+\n+\n+-- !query 8\n+SELECT t1a, t1d, t1f\n+FROM   t1\n+WHERE  t1c = (SELECT max(t2c)\n+              FROM   t2)\n+AND    t1b > (SELECT min(t3b)\n+              FROM   t3)\n+-- !query 8 schema\n+struct<t1a:string,t1d:bigint,t1f:double>\n+-- !query 8 output\n+val1b\t19\t25.0\n+val1c\t19\t25.0\n+\n+\n+-- !query 9\n+SELECT t1a, t1h\n+FROM   t1\n+WHERE  t1c = (SELECT max(t2c)\n+              FROM   t2)\n+OR     t1b = (SELECT min(t3b)\n+              FROM   t3\n+              WHERE  t3b > 10)\n+-- !query 9 schema\n+struct<t1a:string,t1h:timestamp>\n+-- !query 9 output\n+val1b\t2014-05-04 01:01:00\n+val1c\t2014-05-04 01:02:00.001\n+val1d\t2014-06-04 01:01:00\n+val1d\t2014-07-04 01:02:00.001\n+\n+\n+-- !query 10\n+SELECT t1a, t1b, t2d\n+FROM   t1 LEFT JOIN t2\n+       ON t1a = t2a\n+WHERE  t1b = (SELECT min(t3b)\n+              FROM   t3)\n+-- !query 10 schema\n+struct<t1a:string,t1b:smallint,t2d:bigint>\n+-- !query 10 output\n+val1a\t6\tNULL\n+val1a\t6\tNULL\n+\n+\n+-- !query 11\n+SELECT t1a, t1b, t1g\n+FROM   t1\n+WHERE  t1c + 5 = (SELECT max(t2e)\n+                  FROM   t2)\n+-- !query 11 schema\n+struct<t1a:string,t1b:smallint,t1g:decimal(2,-2)>\n+-- !query 11 output\n+val1a\t16\t2000\n+val1a\t16\t2000\n+\n+\n+-- !query 12\n+SELECT t1a, t1h\n+FROM   t1\n+WHERE  date(t1h) = (SELECT min(t2i)\n+                    FROM   t2)\n+-- !query 12 schema\n+struct<t1a:string,t1h:timestamp>\n+-- !query 12 output\n+val1a\t2014-04-04 00:00:00\n+val1a\t2014-04-04 01:02:00.001\n+\n+\n+-- !query 13\n+SELECT t2d, t1a\n+FROM   t1, t2\n+WHERE  t1b = t2b\n+AND    t2c + 1 = (SELECT max(t2c) + 1\n+                  FROM   t2, t1\n+                  WHERE  t2b = t1b)\n+-- !query 13 schema\n+struct<t2d:bigint,t1a:string>\n+-- !query 13 output\n+119\tval1b\n+119\tval1c\n+19\tval1b\n+19\tval1c\n+\n+\n+-- !query 14\n+SELECT DISTINCT t2a, max_t1g\n+FROM   t2, (SELECT   max(t1g) max_t1g, t1a\n+            FROM     t1\n+            GROUP BY t1a) t1\n+WHERE  t2a = t1a\n+AND    max_t1g = (SELECT max(t1g)\n+                  FROM   t1)\n+-- !query 14 schema\n+struct<t2a:string,max_t1g:decimal(2,-2)>\n+-- !query 14 output\n+val1b\t2600\n+val1c\t2600\n+val1e\t2600\n+\n+\n+-- !query 15\n+SELECT t3b, t3c\n+FROM   t3\n+WHERE  (SELECT max(t3c)\n+        FROM   t3\n+        WHERE  t3b > 10) >=\n+       (SELECT min(t3b)\n+        FROM   t3\n+        WHERE  t3c > 0)\n+AND    (t3b is null or t3c is null)\n+-- !query 15 schema\n+struct<t3b:smallint,t3c:int>\n+-- !query 15 output\n+8\tNULL\n+8\tNULL\n+NULL\t16\n+NULL\t16\n+\n+\n+-- !query 16\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a < (SELECT   max(t2a)\n+              FROM     t2\n+              WHERE    t2c = t1c\n+              GROUP BY t2c)\n+-- !query 16 schema\n+struct<t1a:string>\n+-- !query 16 output\n+val1a\n+val1a\n+val1b\n+\n+\n+-- !query 17\n+SELECT t1a, t1c\n+FROM   t1\n+WHERE  (SELECT   max(t2a)\n+        FROM     t2\n+        WHERE    t2c = t1c\n+        GROUP BY t2c) IS NULL\n+-- !query 17 schema\n+struct<t1a:string,t1c:int>\n+-- !query 17 output\n+val1a\t8\n+val1a\t8\n+val1d\tNULL\n+val1e\tNULL\n+val1e\tNULL\n+val1e\tNULL\n+\n+\n+-- !query 18\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a = (SELECT   max(t2a)\n+              FROM     t2\n+              WHERE    t2c = t1c\n+              GROUP BY t2c\n+              HAVING   count(*) >= 0)\n+OR     t1i > '2014-12-31'\n+-- !query 18 schema\n+struct<t1a:string>\n+-- !query 18 output\n+val1c\n+val1d\n+\n+\n+-- !query 19\n+SELECT count(t1a)\n+FROM   t1 RIGHT JOIN t2\n+ON     t1d = t2d\n+WHERE  t1a < (SELECT   max(t2a)\n+              FROM     t2\n+              WHERE    t2c = t1c\n+              GROUP BY t2c)\n+-- !query 19 schema\n+struct<count(t1a):bigint>\n+-- !query 19 output\n+7\n+\n+\n+-- !query 20\n+SELECT t1a\n+FROM   t1\n+WHERE  t1b <= (SELECT   max(t2b)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+AND    t1b >= (SELECT   min(t2b)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+-- !query 20 schema\n+struct<t1a:string>\n+-- !query 20 output\n+val1b\n+val1c\n+\n+\n+-- !query 21\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a <= (SELECT   max(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+INTERSECT\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a >= (SELECT   min(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+-- !query 21 schema\n+struct<t1a:string>\n+-- !query 21 output\n+val1b\n+val1c\n+\n+\n+-- !query 22\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a <= (SELECT   max(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+UNION ALL\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a >= (SELECT   min(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+-- !query 22 schema\n+struct<t1a:string>\n+-- !query 22 output\n+val1a\n+val1a\n+val1b\n+val1b\n+val1c\n+val1c\n+val1d\n+val1d\n+\n+\n+-- !query 23\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a <= (SELECT   max(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+MINUS\n+SELECT t1a\n+FROM   t1\n+WHERE  t1a >= (SELECT   min(t2a)\n+               FROM     t2\n+               WHERE    t2c = t1c\n+               GROUP BY t2c)\n+-- !query 23 schema\n+struct<t1a:string>\n+-- !query 23 output\n+val1a\n+\n+\n+-- !query 24\n+SELECT   t1a\n+FROM     t1\n+GROUP BY t1a, t1c\n+HAVING   max(t1b) <= (SELECT   max(t2b)\n+                      FROM     t2\n+                      WHERE    t2c = t1c\n+                      GROUP BY t2c)\n+-- !query 24 schema\n+struct<t1a:string>\n+-- !query 24 output\n+val1b\n+val1c"
  }],
  "prId": 16798
}]