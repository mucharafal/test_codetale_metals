[{
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "diff?: https://github.com/postgres/postgres/blob/REL_12_STABLE/src/test/regress/expected/window.out#L3787",
    "commit": "3dfa624c8fbc8d3efbf0cfd18dda690585b2f572",
    "createdAt": "2019-10-28T05:22:11Z",
    "diffHunk": "@@ -0,0 +1,507 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 39\n+\n+\n+-- !query 0\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 0 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 0 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 1\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 1 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 1 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 2\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 2 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 2 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 3\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 3 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(6,5)>\n+-- !query 3 output\n+1\t2\n+2\t2.5\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 4\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 4 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 4 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 5\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 5 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 5 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 6\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 6 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 6 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 7\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 7 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(12,1)>\n+-- !query 7 output\n+1\t3.3\n+2\t2.2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 8\n+SELECT SUM(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n)\n+-- !query 8 schema\n+struct<sum(n) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(22,2)>\n+-- !query 8 output\n+3\n+5\n+6.01\n+\n+\n+-- !query 9\n+SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 9 schema\n+struct<i:int,count(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 9 output\n+1\t2\n+2\t1\n+3\t0\n+4\t0\n+\n+\n+-- !query 10\n+SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 10 schema\n+struct<i:int,count(1) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 10 output\n+1\t4\n+2\t3\n+3\t2\n+4\t1\n+\n+\n+-- !query 11\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 11 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 11 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 12\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 12 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 12 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 13\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 13 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 13 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 14\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 14 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 14 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 15\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 15 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 15 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 16\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 16 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 16 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 17\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 17 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 17 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 18\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 18 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 18 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 19\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 19 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 19 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 20\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 20 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 20 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 21\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 21 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 21 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 22\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 22 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 22 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 23\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 23 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 23 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 24\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 24 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 24 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 25\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 25 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 25 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 26\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 26 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 26 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 27\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 27 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 27 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 28\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 28 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 28 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 29\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 29 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 29 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 30\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 30 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 30 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 31\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 31 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 31 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 32\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 32 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 32 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 33\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 33 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 33 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 34\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 34 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 34 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 35\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 35 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\n+-- !query 35 output\n+1\t1\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 36\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 36 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\n+-- !query 36 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 37\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v)\n+-- !query 37 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING):bigint>\n+-- !query 37 output\n+1\t3\n+2\t6\n+3\t9\n+4\t7\n+\n+\n+-- !query 38\n+SELECT a, b,\n+       SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)\n+FROM (VALUES(1,1),(2,2),(3,(cast('nan' as int))),(4,3),(5,4)) t(a,b)\n+-- !query 38 schema\n+struct<a:int,b:int,sum(b) OVER (ORDER BY A ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>",
    "line": 501
  }, {
    "author": {
      "login": "DylanGuedes"
    },
    "body": "@maropu I think that it is related to Spark handling 'NaN' as value zero in sum, such that:\r\n`0+1=1, 1+2=3, 2+'NaN'=2, 3+'NaN'=3, 4+3=7`. Should I JIRA that?\r\n",
    "commit": "3dfa624c8fbc8d3efbf0cfd18dda690585b2f572",
    "createdAt": "2019-10-28T10:20:10Z",
    "diffHunk": "@@ -0,0 +1,507 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 39\n+\n+\n+-- !query 0\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 0 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 0 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 1\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 1 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 1 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 2\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 2 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 2 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 3\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 3 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(6,5)>\n+-- !query 3 output\n+1\t2\n+2\t2.5\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 4\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 4 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 4 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 5\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 5 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 5 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 6\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 6 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 6 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 7\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 7 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(12,1)>\n+-- !query 7 output\n+1\t3.3\n+2\t2.2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 8\n+SELECT SUM(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n)\n+-- !query 8 schema\n+struct<sum(n) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(22,2)>\n+-- !query 8 output\n+3\n+5\n+6.01\n+\n+\n+-- !query 9\n+SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 9 schema\n+struct<i:int,count(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 9 output\n+1\t2\n+2\t1\n+3\t0\n+4\t0\n+\n+\n+-- !query 10\n+SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 10 schema\n+struct<i:int,count(1) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 10 output\n+1\t4\n+2\t3\n+3\t2\n+4\t1\n+\n+\n+-- !query 11\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 11 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 11 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 12\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 12 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 12 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 13\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 13 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 13 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 14\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 14 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 14 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 15\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 15 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 15 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 16\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 16 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 16 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 17\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 17 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 17 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 18\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 18 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 18 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 19\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 19 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 19 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 20\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 20 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 20 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 21\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 21 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 21 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 22\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 22 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 22 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 23\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 23 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 23 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 24\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 24 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 24 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 25\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 25 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 25 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 26\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 26 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 26 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 27\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 27 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 27 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 28\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 28 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 28 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 29\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 29 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 29 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 30\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 30 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 30 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 31\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 31 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 31 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 32\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 32 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 32 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 33\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 33 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 33 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 34\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 34 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 34 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 35\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 35 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\n+-- !query 35 output\n+1\t1\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 36\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 36 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\n+-- !query 36 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 37\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v)\n+-- !query 37 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING):bigint>\n+-- !query 37 output\n+1\t3\n+2\t6\n+3\t9\n+4\t7\n+\n+\n+-- !query 38\n+SELECT a, b,\n+       SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)\n+FROM (VALUES(1,1),(2,2),(3,(cast('nan' as int))),(4,3),(5,4)) t(a,b)\n+-- !query 38 schema\n+struct<a:int,b:int,sum(b) OVER (ORDER BY A ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>",
    "line": 501
  }, {
    "author": {
      "login": "maropu"
    },
    "body": "Ur, I see. I think its worth filing it (Or, we already have any jira for that?) cc: @dongjoon-hyun @HyukjinKwon ",
    "commit": "3dfa624c8fbc8d3efbf0cfd18dda690585b2f572",
    "createdAt": "2019-10-29T05:46:11Z",
    "diffHunk": "@@ -0,0 +1,507 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 39\n+\n+\n+-- !query 0\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 0 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 0 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 1\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 1 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 1 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 2\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 2 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 2 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 3\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 3 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(6,5)>\n+-- !query 3 output\n+1\t2\n+2\t2.5\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 4\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 4 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 4 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 5\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 5 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 5 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 6\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 6 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 6 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 7\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 7 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(12,1)>\n+-- !query 7 output\n+1\t3.3\n+2\t2.2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 8\n+SELECT SUM(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n)\n+-- !query 8 schema\n+struct<sum(n) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(22,2)>\n+-- !query 8 output\n+3\n+5\n+6.01\n+\n+\n+-- !query 9\n+SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 9 schema\n+struct<i:int,count(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 9 output\n+1\t2\n+2\t1\n+3\t0\n+4\t0\n+\n+\n+-- !query 10\n+SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 10 schema\n+struct<i:int,count(1) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 10 output\n+1\t4\n+2\t3\n+3\t2\n+4\t1\n+\n+\n+-- !query 11\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 11 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 11 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 12\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 12 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 12 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 13\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 13 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 13 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 14\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 14 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 14 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 15\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 15 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 15 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 16\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 16 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 16 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 17\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 17 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 17 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 18\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 18 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 18 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 19\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 19 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 19 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 20\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 20 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 20 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 21\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 21 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 21 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 22\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 22 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 22 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 23\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 23 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 23 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 24\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 24 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 24 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 25\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 25 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 25 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 26\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 26 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 26 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 27\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 27 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 27 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 28\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 28 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 28 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 29\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 29 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 29 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 30\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 30 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 30 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 31\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 31 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 31 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 32\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 32 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 32 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 33\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 33 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 33 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 34\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 34 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 34 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 35\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 35 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\n+-- !query 35 output\n+1\t1\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 36\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 36 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\n+-- !query 36 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 37\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v)\n+-- !query 37 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING):bigint>\n+-- !query 37 output\n+1\t3\n+2\t6\n+3\t9\n+4\t7\n+\n+\n+-- !query 38\n+SELECT a, b,\n+       SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)\n+FROM (VALUES(1,1),(2,2),(3,(cast('nan' as int))),(4,3),(5,4)) t(a,b)\n+-- !query 38 schema\n+struct<a:int,b:int,sum(b) OVER (ORDER BY A ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>",
    "line": 501
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Yeah, let's file a JIRA and note. Even if we don't want to fix in Spark, let's better to file a JIRA and reolsve it as `Won't Fix` for trackability.",
    "commit": "3dfa624c8fbc8d3efbf0cfd18dda690585b2f572",
    "createdAt": "2019-10-29T09:32:55Z",
    "diffHunk": "@@ -0,0 +1,507 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 39\n+\n+\n+-- !query 0\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 0 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 0 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 1\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 1 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 1 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 2\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 2 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 2 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 3\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 3 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(6,5)>\n+-- !query 3 output\n+1\t2\n+2\t2.5\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 4\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 4 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 4 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 5\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 5 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 5 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 6\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 6 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 6 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 7\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 7 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(12,1)>\n+-- !query 7 output\n+1\t3.3\n+2\t2.2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 8\n+SELECT SUM(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n)\n+-- !query 8 schema\n+struct<sum(n) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(22,2)>\n+-- !query 8 output\n+3\n+5\n+6.01\n+\n+\n+-- !query 9\n+SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 9 schema\n+struct<i:int,count(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 9 output\n+1\t2\n+2\t1\n+3\t0\n+4\t0\n+\n+\n+-- !query 10\n+SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 10 schema\n+struct<i:int,count(1) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 10 output\n+1\t4\n+2\t3\n+3\t2\n+4\t1\n+\n+\n+-- !query 11\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 11 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 11 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 12\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 12 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 12 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 13\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 13 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 13 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 14\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 14 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 14 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 15\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 15 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 15 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 16\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 16 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 16 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 17\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 17 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 17 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 18\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 18 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 18 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 19\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 19 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 19 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 20\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 20 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 20 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 21\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 21 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 21 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 22\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 22 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 22 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 23\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 23 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 23 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 24\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 24 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 24 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 25\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 25 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 25 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 26\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 26 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 26 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 27\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 27 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 27 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 28\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 28 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 28 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 29\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 29 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 29 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 30\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 30 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 30 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 31\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 31 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 31 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 32\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 32 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 32 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 33\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 33 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 33 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 34\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 34 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 34 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 35\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 35 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\n+-- !query 35 output\n+1\t1\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 36\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 36 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\n+-- !query 36 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 37\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v)\n+-- !query 37 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING):bigint>\n+-- !query 37 output\n+1\t3\n+2\t6\n+3\t9\n+4\t7\n+\n+\n+-- !query 38\n+SELECT a, b,\n+       SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)\n+FROM (VALUES(1,1),(2,2),(3,(cast('nan' as int))),(4,3),(5,4)) t(a,b)\n+-- !query 38 schema\n+struct<a:int,b:int,sum(b) OVER (ORDER BY A ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>",
    "line": 501
  }, {
    "author": {
      "login": "maropu"
    },
    "body": "Yea, I think so. Thanks for the suggestion!",
    "commit": "3dfa624c8fbc8d3efbf0cfd18dda690585b2f572",
    "createdAt": "2019-10-29T10:18:17Z",
    "diffHunk": "@@ -0,0 +1,507 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 39\n+\n+\n+-- !query 0\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 0 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 0 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 1\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 1 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 1 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 2\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 2 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 2 output\n+1\t1.5\n+2\t2.0\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 3\n+SELECT i,AVG(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.5),(2,2.5),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 3 schema\n+struct<i:int,avg(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(6,5)>\n+-- !query 3 output\n+1\t2\n+2\t2.5\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 4\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 4 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 4 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 5\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 5 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 5 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 6\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 6 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 6 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 7\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.1),(2,2.2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 7 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(12,1)>\n+-- !query 7 output\n+1\t3.3\n+2\t2.2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 8\n+SELECT SUM(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1.01),(2,2),(3,3)) v(i,n)\n+-- !query 8 schema\n+struct<sum(n) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):decimal(22,2)>\n+-- !query 8 output\n+3\n+5\n+6.01\n+\n+\n+-- !query 9\n+SELECT i,COUNT(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 9 schema\n+struct<i:int,count(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 9 output\n+1\t2\n+2\t1\n+3\t0\n+4\t0\n+\n+\n+-- !query 10\n+SELECT i,COUNT(*) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 10 schema\n+struct<i:int,count(1) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):bigint>\n+-- !query 10 output\n+1\t4\n+2\t3\n+3\t2\n+4\t1\n+\n+\n+-- !query 11\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 11 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 11 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 12\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 12 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 12 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 13\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 13 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 13 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 14\n+SELECT VAR_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 14 schema\n+struct<var_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 14 output\n+0.0\n+11266.666666666666\n+13868.750000000002\n+21703.999999999996\n+4225.0\n+\n+\n+-- !query 15\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 15 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 15 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 16\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 16 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 16 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 17\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 17 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 17 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 18\n+SELECT VAR_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 18 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 18 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 19\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 19 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 19 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 20\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 20 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 20 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 21\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 21 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 21 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 22\n+SELECT VARIANCE(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 22 schema\n+struct<var_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 22 output\n+16900.0\n+18491.666666666668\n+27129.999999999996\n+8450.0\n+NaN\n+\n+\n+-- !query 23\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 23 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 23 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 24\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 24 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 24 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 25\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 25 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 25 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 26\n+SELECT STDDEV_POP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 26 schema\n+struct<stddev_pop(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 26 output\n+0.0\n+106.14455552060438\n+117.76565713313879\n+147.32277488562315\n+147.32277488562315\n+65.0\n+\n+\n+-- !query 27\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 27 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 27 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 28\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 28 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 28 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 29\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 29 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 29 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 30\n+SELECT STDDEV_SAMP(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(1,NULL),(2,600),(3,470),(4,170),(5,430),(6,300)) r(i,n)\n+-- !query 30 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 30 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 31\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 31 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 31 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 32\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 32 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 32 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 33\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 33 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 33 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 34\n+SELECT STDDEV(n) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n+  FROM (VALUES(0,NULL),(1,600),(2,470),(3,170),(4,430),(5,300)) r(i,n)\n+-- !query 34 schema\n+struct<stddev_samp(CAST(n AS DOUBLE)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):double>\n+-- !query 34 output\n+130.0\n+135.9840676942217\n+164.7118696390761\n+164.7118696390761\n+91.92388155425118\n+NaN\n+\n+\n+-- !query 35\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND CURRENT ROW)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 35 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND CURRENT ROW):bigint>\n+-- !query 35 output\n+1\t1\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 36\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,NULL),(4,NULL)) t(i,v)\n+-- !query 36 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING):bigint>\n+-- !query 36 output\n+1\t3\n+2\t2\n+3\tNULL\n+4\tNULL\n+\n+\n+-- !query 37\n+SELECT i,SUM(v) OVER (ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)\n+  FROM (VALUES(1,1),(2,2),(3,3),(4,4)) t(i,v)\n+-- !query 37 schema\n+struct<i:int,sum(v) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING):bigint>\n+-- !query 37 output\n+1\t3\n+2\t6\n+3\t9\n+4\t7\n+\n+\n+-- !query 38\n+SELECT a, b,\n+       SUM(b) OVER(ORDER BY A ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)\n+FROM (VALUES(1,1),(2,2),(3,(cast('nan' as int))),(4,3),(5,4)) t(a,b)\n+-- !query 38 schema\n+struct<a:int,b:int,sum(b) OVER (ORDER BY A ASC NULLS FIRST ROWS BETWEEN 1 PRECEDING AND CURRENT ROW):bigint>",
    "line": 501
  }],
  "prId": 26238
}]