[{
  "comments": [{
    "author": {
      "login": "rxin"
    },
    "body": "looking at the entirety of the error message, it looks like maybe we don't need to call out sort_array in the error message, since it is already here.\n\ncc @tejasapatil \n",
    "commit": "6ff7c7dc15694ab8f95e2d5f9c1fd30850b83114",
    "createdAt": "2016-10-19T05:56:00Z",
    "diffHunk": "@@ -124,8 +124,23 @@ struct<sort_array(boolean_array, true):array<boolean>,sort_array(tinyint_array,\n -- !query 8 output\n [true]\t[1,2]\t[1,2]\t[1,2]\t[1,2]\t[9223372036854775808,9223372036854775809]\t[1.0,2.0]\t[1.0,2.0]\t[2016-03-13,2016-03-14]\t[2016-11-12 20:54:00.0,2016-11-15 20:54:00.0]\n \n-\n -- !query 9\n+select sort_array(array('b', 'd'), '1')\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve 'sort_array(array('b', 'd'), '1')' due to data type mismatch: Sort order in second argument of sort_array() requires boolean type as non-null, however, it is ''1'' as string type.; line 1 pos 7"
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "FWIW, It seems it does not print it (`prettyName`) in the message (from the expression) as default in `ExpectsInputTypes`/`ImplicitCastInputTypes`.\n\n``` scala\ns\"argument ${idx + 1} requires ${expected.simpleString} type, \" +\n  s\"however, '${child.sql}' is of ${child.dataType.simpleString} type.\"\n```\n",
    "commit": "6ff7c7dc15694ab8f95e2d5f9c1fd30850b83114",
    "createdAt": "2016-10-19T06:08:19Z",
    "diffHunk": "@@ -124,8 +124,23 @@ struct<sort_array(boolean_array, true):array<boolean>,sort_array(tinyint_array,\n -- !query 8 output\n [true]\t[1,2]\t[1,2]\t[1,2]\t[1,2]\t[9223372036854775808,9223372036854775809]\t[1.0,2.0]\t[1.0,2.0]\t[2016-03-13,2016-03-14]\t[2016-11-12 20:54:00.0,2016-11-15 20:54:00.0]\n \n-\n -- !query 9\n+select sort_array(array('b', 'd'), '1')\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve 'sort_array(array('b', 'd'), '1')' due to data type mismatch: Sort order in second argument of sort_array() requires boolean type as non-null, however, it is ''1'' as string type.; line 1 pos 7"
  }, {
    "author": {
      "login": "tejasapatil"
    },
    "body": "Yes. Now that I see the final error message, its fine to omit that.\n",
    "commit": "6ff7c7dc15694ab8f95e2d5f9c1fd30850b83114",
    "createdAt": "2016-10-19T06:27:44Z",
    "diffHunk": "@@ -124,8 +124,23 @@ struct<sort_array(boolean_array, true):array<boolean>,sort_array(tinyint_array,\n -- !query 8 output\n [true]\t[1,2]\t[1,2]\t[1,2]\t[1,2]\t[9223372036854775808,9223372036854775809]\t[1.0,2.0]\t[1.0,2.0]\t[2016-03-13,2016-03-14]\t[2016-11-12 20:54:00.0,2016-11-15 20:54:00.0]\n \n-\n -- !query 9\n+select sort_array(array('b', 'd'), '1')\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve 'sort_array(array('b', 'd'), '1')' due to data type mismatch: Sort order in second argument of sort_array() requires boolean type as non-null, however, it is ''1'' as string type.; line 1 pos 7"
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Thank you for confirming @tejasapatil \n",
    "commit": "6ff7c7dc15694ab8f95e2d5f9c1fd30850b83114",
    "createdAt": "2016-10-19T06:28:26Z",
    "diffHunk": "@@ -124,8 +124,23 @@ struct<sort_array(boolean_array, true):array<boolean>,sort_array(tinyint_array,\n -- !query 8 output\n [true]\t[1,2]\t[1,2]\t[1,2]\t[1,2]\t[9223372036854775808,9223372036854775809]\t[1.0,2.0]\t[1.0,2.0]\t[2016-03-13,2016-03-14]\t[2016-11-12 20:54:00.0,2016-11-15 20:54:00.0]\n \n-\n -- !query 9\n+select sort_array(array('b', 'd'), '1')\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+org.apache.spark.sql.AnalysisException\n+cannot resolve 'sort_array(array('b', 'd'), '1')' due to data type mismatch: Sort order in second argument of sort_array() requires boolean type as non-null, however, it is ''1'' as string type.; line 1 pos 7"
  }],
  "prId": 15532
}]