[{
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Can we match the results?\r\n\r\n```diff\r\n -- !query 4\r\n-SELECT a\r\n-FROM (SELECT 0 a, 0 b\r\n+SELECT udf(a) as a, udf(udf(a)) as a1\r\n+FROM (SELECT udf(0) a, udf(0) b\r\n       UNION ALL\r\n-      SELECT SUM(1) a, CAST(0 AS BIGINT) b\r\n-      UNION ALL SELECT 0 a, 0 b) T\r\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\r\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\r\n -- !query 4 schema\r\n-struct<a:bigint>\r\n+struct<a:bigint,a1:bigint>\r\n -- !query 4 output\r\n-0\r\n-0\r\n-1\r\n+0      0\r\n+0      0\r\n+1      1\r\n```",
    "commit": "7c87cb9d9527415adc28a97afeb4512e71e669bf",
    "createdAt": "2019-07-24T00:52:54Z",
    "diffHunk": "@@ -0,0 +1,166 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 16\n+\n+\n+-- !query 0\n+CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (1, 'a'), (2, 'b') tbl(c1, c2)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+CREATE OR REPLACE TEMPORARY VIEW t2 AS VALUES (1.0, 1), (2.0, 4) tbl(c1, c2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t1)\n+-- !query 2 schema\n+struct<c1:int,c2:string>\n+-- !query 2 output\n+1\ta\n+1\ta\n+2\tb\n+2\tb\n+\n+\n+-- !query 3\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2)\n+-- !query 3 schema\n+struct<c1:decimal(11,1),c2:string>\n+-- !query 3 output\n+1\t1\n+1\t1\n+1\ta\n+2\t4\n+2\t4\n+2\tb\n+\n+\n+-- !query 4\n+SELECT udf(a) as a, udf(udf(a)) as a1\n+FROM (SELECT udf(0) a, udf(0) b\n+      UNION ALL\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\n+-- !query 4 schema\n+struct<a:bigint,a1:bigint>\n+-- !query 4 output\n+0\t0\n+0\t0\n+1\t1"
  }, {
    "author": {
      "login": "yiheng"
    },
    "body": "As your [review comment](https://github.com/apache/spark/pull/25202#discussion_r305656980), I add a udf(udf(a)) to the select fields. So now there're two columns in the output instead of one.",
    "commit": "7c87cb9d9527415adc28a97afeb4512e71e669bf",
    "createdAt": "2019-07-24T02:15:55Z",
    "diffHunk": "@@ -0,0 +1,166 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 16\n+\n+\n+-- !query 0\n+CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (1, 'a'), (2, 'b') tbl(c1, c2)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+CREATE OR REPLACE TEMPORARY VIEW t2 AS VALUES (1.0, 1), (2.0, 4) tbl(c1, c2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t1)\n+-- !query 2 schema\n+struct<c1:int,c2:string>\n+-- !query 2 output\n+1\ta\n+1\ta\n+2\tb\n+2\tb\n+\n+\n+-- !query 3\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2)\n+-- !query 3 schema\n+struct<c1:decimal(11,1),c2:string>\n+-- !query 3 output\n+1\t1\n+1\t1\n+1\ta\n+2\t4\n+2\t4\n+2\tb\n+\n+\n+-- !query 4\n+SELECT udf(a) as a, udf(udf(a)) as a1\n+FROM (SELECT udf(0) a, udf(0) b\n+      UNION ALL\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\n+-- !query 4 schema\n+struct<a:bigint,a1:bigint>\n+-- !query 4 output\n+0\t0\n+0\t0\n+1\t1"
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Ah, I meant to `udf(udf(a)) as a` one column alone. This test cases are being matched with existing `union.sql`. Let's match with this.",
    "commit": "7c87cb9d9527415adc28a97afeb4512e71e669bf",
    "createdAt": "2019-07-24T05:05:53Z",
    "diffHunk": "@@ -0,0 +1,166 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 16\n+\n+\n+-- !query 0\n+CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (1, 'a'), (2, 'b') tbl(c1, c2)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+CREATE OR REPLACE TEMPORARY VIEW t2 AS VALUES (1.0, 1), (2.0, 4) tbl(c1, c2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t1)\n+-- !query 2 schema\n+struct<c1:int,c2:string>\n+-- !query 2 output\n+1\ta\n+1\ta\n+2\tb\n+2\tb\n+\n+\n+-- !query 3\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2)\n+-- !query 3 schema\n+struct<c1:decimal(11,1),c2:string>\n+-- !query 3 output\n+1\t1\n+1\t1\n+1\ta\n+2\t4\n+2\t4\n+2\tb\n+\n+\n+-- !query 4\n+SELECT udf(a) as a, udf(udf(a)) as a1\n+FROM (SELECT udf(0) a, udf(0) b\n+      UNION ALL\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\n+-- !query 4 schema\n+struct<a:bigint,a1:bigint>\n+-- !query 4 output\n+0\t0\n+0\t0\n+1\t1"
  }, {
    "author": {
      "login": "yiheng"
    },
    "body": "got it. Has fixed this",
    "commit": "7c87cb9d9527415adc28a97afeb4512e71e669bf",
    "createdAt": "2019-07-24T09:07:53Z",
    "diffHunk": "@@ -0,0 +1,166 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 16\n+\n+\n+-- !query 0\n+CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (1, 'a'), (2, 'b') tbl(c1, c2)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+CREATE OR REPLACE TEMPORARY VIEW t2 AS VALUES (1.0, 1), (2.0, 4) tbl(c1, c2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t1)\n+-- !query 2 schema\n+struct<c1:int,c2:string>\n+-- !query 2 output\n+1\ta\n+1\ta\n+2\tb\n+2\tb\n+\n+\n+-- !query 3\n+SELECT udf(c1) as c1, udf(c2) as c2\n+FROM   (SELECT udf(c1) as c1, udf(c2) as c2 FROM t1\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2\n+        UNION ALL\n+        SELECT udf(c1) as c1, udf(c2) as c2 FROM t2)\n+-- !query 3 schema\n+struct<c1:decimal(11,1),c2:string>\n+-- !query 3 output\n+1\t1\n+1\t1\n+1\ta\n+2\t4\n+2\t4\n+2\tb\n+\n+\n+-- !query 4\n+SELECT udf(a) as a, udf(udf(a)) as a1\n+FROM (SELECT udf(0) a, udf(0) b\n+      UNION ALL\n+      SELECT udf(SUM(1)) a, udf(CAST(0 AS BIGINT)) b\n+      UNION ALL SELECT udf(0) a, udf(0) b) T\n+-- !query 4 schema\n+struct<a:bigint,a1:bigint>\n+-- !query 4 output\n+0\t0\n+0\t0\n+1\t1"
  }],
  "prId": 25202
}]