[{
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "I submitted #25106 to fix this.",
    "commit": "0dbc98598ce5760c7f801434497a09a0f134fdbd",
    "createdAt": "2019-07-16T04:54:56Z",
    "diffHunk": "@@ -0,0 +1,146 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view nt1 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 2),\n+  (\"three\", 3)\n+  as nt1(k, v1)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view nt2 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 22),\n+  (\"one\", 5)\n+  as nt2(k, v2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT * FROM nt1 cross join nt2\n+-- !query 2 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 2 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+one\t1\ttwo\t22\n+three\t3\tone\t1\n+three\t3\tone\t5\n+three\t3\ttwo\t22\n+two\t2\tone\t1\n+two\t2\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 3\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.k) = udf(nt2.k)\n+-- !query 3 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 3 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 4\n+SELECT * FROM nt1 cross join nt2 on (udf(nt1.k) = udf(nt2.k))\n+-- !query 4 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 4 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 5\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.v1) = \"1\" and udf(nt2.v2) = \"22\"\n+-- !query 5 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 5 output\n+one\t1\ttwo\t22\n+\n+\n+-- !query 6\n+SELECT udf(a.key), udf(b.key) FROM\n+(SELECT udf(k) key FROM nt1 WHERE v1 < 2) a\n+CROSS JOIN\n+(SELECT udf(k) key FROM nt2 WHERE v2 = 22) b\n+-- !query 6 schema\n+struct<udf(key):string,udf(key):string>\n+-- !query 6 output\n+one\ttwo\n+\n+\n+-- !query 7\n+create temporary view A(a, va) as select * from nt1\n+-- !query 7 schema\n+struct<>\n+-- !query 7 output\n+\n+\n+\n+-- !query 8\n+create temporary view B(b, vb) as select * from nt1\n+-- !query 8 schema\n+struct<>\n+-- !query 8 output\n+\n+\n+\n+-- !query 9\n+create temporary view C(c, vc) as select * from nt1\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+\n+\n+\n+-- !query 10\n+create temporary view D(d, vd) as select * from nt1\n+-- !query 10 schema\n+struct<>\n+-- !query 10 output\n+\n+\n+\n+-- !query 11\n+select * from ((A join B on (udf(a) = udf(b))) cross join C) join D on (udf(a) = udf(d))\n+-- !query 11 schema\n+struct<>\n+-- !query 11 output\n+org.apache.spark.sql.AnalysisException\n+Detected implicit cartesian product for INNER join between logical plans"
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "I merged this. should be able to update now :).",
    "commit": "0dbc98598ce5760c7f801434497a09a0f134fdbd",
    "createdAt": "2019-07-16T07:17:13Z",
    "diffHunk": "@@ -0,0 +1,146 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view nt1 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 2),\n+  (\"three\", 3)\n+  as nt1(k, v1)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view nt2 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 22),\n+  (\"one\", 5)\n+  as nt2(k, v2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT * FROM nt1 cross join nt2\n+-- !query 2 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 2 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+one\t1\ttwo\t22\n+three\t3\tone\t1\n+three\t3\tone\t5\n+three\t3\ttwo\t22\n+two\t2\tone\t1\n+two\t2\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 3\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.k) = udf(nt2.k)\n+-- !query 3 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 3 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 4\n+SELECT * FROM nt1 cross join nt2 on (udf(nt1.k) = udf(nt2.k))\n+-- !query 4 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 4 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 5\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.v1) = \"1\" and udf(nt2.v2) = \"22\"\n+-- !query 5 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 5 output\n+one\t1\ttwo\t22\n+\n+\n+-- !query 6\n+SELECT udf(a.key), udf(b.key) FROM\n+(SELECT udf(k) key FROM nt1 WHERE v1 < 2) a\n+CROSS JOIN\n+(SELECT udf(k) key FROM nt2 WHERE v2 = 22) b\n+-- !query 6 schema\n+struct<udf(key):string,udf(key):string>\n+-- !query 6 output\n+one\ttwo\n+\n+\n+-- !query 7\n+create temporary view A(a, va) as select * from nt1\n+-- !query 7 schema\n+struct<>\n+-- !query 7 output\n+\n+\n+\n+-- !query 8\n+create temporary view B(b, vb) as select * from nt1\n+-- !query 8 schema\n+struct<>\n+-- !query 8 output\n+\n+\n+\n+-- !query 9\n+create temporary view C(c, vc) as select * from nt1\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+\n+\n+\n+-- !query 10\n+create temporary view D(d, vd) as select * from nt1\n+-- !query 10 schema\n+struct<>\n+-- !query 10 output\n+\n+\n+\n+-- !query 11\n+select * from ((A join B on (udf(a) = udf(b))) cross join C) join D on (udf(a) = udf(d))\n+-- !query 11 schema\n+struct<>\n+-- !query 11 output\n+org.apache.spark.sql.AnalysisException\n+Detected implicit cartesian product for INNER join between logical plans"
  }, {
    "author": {
      "login": "viirya"
    },
    "body": "Thanks. :)\r\n",
    "commit": "0dbc98598ce5760c7f801434497a09a0f134fdbd",
    "createdAt": "2019-07-16T07:23:52Z",
    "diffHunk": "@@ -0,0 +1,146 @@\n+-- Automatically generated by SQLQueryTestSuite\n+-- Number of queries: 13\n+\n+\n+-- !query 0\n+create temporary view nt1 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 2),\n+  (\"three\", 3)\n+  as nt1(k, v1)\n+-- !query 0 schema\n+struct<>\n+-- !query 0 output\n+\n+\n+\n+-- !query 1\n+create temporary view nt2 as select * from values\n+  (\"one\", 1),\n+  (\"two\", 22),\n+  (\"one\", 5)\n+  as nt2(k, v2)\n+-- !query 1 schema\n+struct<>\n+-- !query 1 output\n+\n+\n+\n+-- !query 2\n+SELECT * FROM nt1 cross join nt2\n+-- !query 2 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 2 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+one\t1\ttwo\t22\n+three\t3\tone\t1\n+three\t3\tone\t5\n+three\t3\ttwo\t22\n+two\t2\tone\t1\n+two\t2\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 3\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.k) = udf(nt2.k)\n+-- !query 3 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 3 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 4\n+SELECT * FROM nt1 cross join nt2 on (udf(nt1.k) = udf(nt2.k))\n+-- !query 4 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 4 output\n+one\t1\tone\t1\n+one\t1\tone\t5\n+two\t2\ttwo\t22\n+\n+\n+-- !query 5\n+SELECT * FROM nt1 cross join nt2 where udf(nt1.v1) = \"1\" and udf(nt2.v2) = \"22\"\n+-- !query 5 schema\n+struct<k:string,v1:int,k:string,v2:int>\n+-- !query 5 output\n+one\t1\ttwo\t22\n+\n+\n+-- !query 6\n+SELECT udf(a.key), udf(b.key) FROM\n+(SELECT udf(k) key FROM nt1 WHERE v1 < 2) a\n+CROSS JOIN\n+(SELECT udf(k) key FROM nt2 WHERE v2 = 22) b\n+-- !query 6 schema\n+struct<udf(key):string,udf(key):string>\n+-- !query 6 output\n+one\ttwo\n+\n+\n+-- !query 7\n+create temporary view A(a, va) as select * from nt1\n+-- !query 7 schema\n+struct<>\n+-- !query 7 output\n+\n+\n+\n+-- !query 8\n+create temporary view B(b, vb) as select * from nt1\n+-- !query 8 schema\n+struct<>\n+-- !query 8 output\n+\n+\n+\n+-- !query 9\n+create temporary view C(c, vc) as select * from nt1\n+-- !query 9 schema\n+struct<>\n+-- !query 9 output\n+\n+\n+\n+-- !query 10\n+create temporary view D(d, vd) as select * from nt1\n+-- !query 10 schema\n+struct<>\n+-- !query 10 output\n+\n+\n+\n+-- !query 11\n+select * from ((A join B on (udf(a) = udf(b))) cross join C) join D on (udf(a) = udf(d))\n+-- !query 11 schema\n+struct<>\n+-- !query 11 output\n+org.apache.spark.sql.AnalysisException\n+Detected implicit cartesian product for INNER join between logical plans"
  }],
  "prId": 25168
}]