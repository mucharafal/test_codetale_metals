[{
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Can we remove `CSVDataSource.checkHeader` and switch to `CSVDataSource.checkHeaderColumnNames`? Looks `CSVDataSource.checkHeader` is an overkill and makes hard to read the code.",
    "commit": "667db3c8ec6249321de10b4c48be545dcd19784a",
    "createdAt": "2018-08-20T03:08:03Z",
    "diffHunk": "@@ -230,7 +232,7 @@ object TextInputCSVDataSource extends CSVDataSource {\n         CSVDataSource.checkHeader("
  }],
  "prId": 22123
}, {
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "Nit: the following code style is preferred.\r\n```\r\nval schema = if (columnPruning) requiredSchema else dataSchema\r\nval columnNames = parser.tokenizer.parseLine(header)\r\nCSVDataSource.checkHeaderColumnNames(\r\n  schema,\r\n  columnNames,\r\n  ...\r\n```",
    "commit": "667db3c8ec6249321de10b4c48be545dcd19784a",
    "createdAt": "2018-08-20T14:32:14Z",
    "diffHunk": "@@ -227,10 +210,9 @@ object TextInputCSVDataSource extends CSVDataSource {\n       // Note: if there are only comments in the first block, the header would probably\n       // be not extracted.\n       CSVUtils.extractHeader(lines, parser.options).foreach { header =>\n-        CSVDataSource.checkHeader(\n-          header,\n-          parser.tokenizer,\n-          dataSchema,\n+        CSVDataSource.checkHeaderColumnNames(\n+          if (columnPruning) requiredSchema else dataSchema,\n+          parser.tokenizer.parseLine(header),"
  }],
  "prId": 22123
}]