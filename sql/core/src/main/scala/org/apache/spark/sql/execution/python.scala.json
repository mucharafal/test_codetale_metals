[{
  "comments": [{
    "author": {
      "login": "yhuai"
    },
    "body": "I am wondering if we should throw `IllegalStateException` because `AssertionError` can be disabled.\n\nAlso, regarding the error message, I wondering if something like `The given row does not have the same number of values required by the schema. ${fields.length} values are expected. But, ${array.length} values are provided` maybe a better one.\n",
    "commit": "ad8efa122c21be675111c1bbaeae607058e5c8fa",
    "createdAt": "2016-01-24T03:24:30Z",
    "diffHunk": "@@ -220,7 +220,12 @@ object EvaluatePython {\n       ArrayBasedMapData(keys, values)\n \n     case (c, StructType(fields)) if c.getClass.isArray =>\n-      new GenericInternalRow(c.asInstanceOf[Array[_]].zip(fields).map {\n+      val array = c.asInstanceOf[Array[_]]\n+      assert(\n+        array.length == fields.length,\n+        s\"Row length ${array.length} and schema length ${fields.length} don't match\"\n+      )"
  }],
  "prId": 10886
}]