[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "This is a good change, but the test case is missing. To ensure this will not be changed by others in the future, could you also add another test case? For example,\r\n```\r\n    checkAnswer(\r\n      Seq[(java.lang.Long, java.lang.Float)]((null, 3.14f), (9123146099426677101L, null),\r\n        (9123146560113991650L, 1.6f), (null, null)).toDF(\"a\", \"b\").na.fill(0.2),\r\n      Row(0, 3.14f) :: Row(9123146099426677101L, 0.2f) :: Row(9123146560113991650L, 1.6f)\r\n        :: Row(0, 0.2f) :: Nil\r\n    )\r\n```",
    "commit": "3fb1a66c84021b4b2cc223aff82e001f4cd7df03",
    "createdAt": "2017-04-09T15:35:21Z",
    "diffHunk": "@@ -407,10 +407,11 @@ final class DataFrameNaFunctions private[sql](df: DataFrame) {\n     val quotedColName = \"`\" + col.name + \"`\"\n     val colValue = col.dataType match {\n       case DoubleType | FloatType =>\n-        nanvl(df.col(quotedColName), lit(null)) // nanvl only supports these types\n+        // nanvl only supports these types\n+        nanvl(df.col(quotedColName), lit(null).cast(col.dataType))",
    "line": 6
  }, {
    "author": {
      "login": "dbtsai"
    },
    "body": "The float one is covered by another test in `fill with map`, but still nice to have them explicitly to avoid being changed unexpectedly. ",
    "commit": "3fb1a66c84021b4b2cc223aff82e001f4cd7df03",
    "createdAt": "2017-04-09T18:24:18Z",
    "diffHunk": "@@ -407,10 +407,11 @@ final class DataFrameNaFunctions private[sql](df: DataFrame) {\n     val quotedColName = \"`\" + col.name + \"`\"\n     val colValue = col.dataType match {\n       case DoubleType | FloatType =>\n-        nanvl(df.col(quotedColName), lit(null)) // nanvl only supports these types\n+        // nanvl only supports these types\n+        nanvl(df.col(quotedColName), lit(null).cast(col.dataType))",
    "line": 6
  }],
  "prId": 17577
}]