[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "unnecessary change?",
    "commit": "118d81f561ffc1837a065cfa5e8f53e5ace7c987",
    "createdAt": "2019-10-02T03:39:47Z",
    "diffHunk": "@@ -82,7 +80,7 @@ case class OverwriteByExpressionExecV1(\n }\n \n /** Some helper interfaces that use V2 write semantics through the V1 writer interface. */\n-sealed trait V1FallbackWriters extends SupportsV1Write {\n+sealed trait V1FallbackWriters extends SupportsV1Write { this: SupportsV1Write =>"
  }],
  "prId": 25990
}, {
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "This is a breaking change. Previously the v1 implementation can get the original query plan but now they can't.\r\n\r\nSince we don't need to create writer factory for v1 write, I don't think we need to pass the physical schema to v1 write.",
    "commit": "118d81f561ffc1837a065cfa5e8f53e5ace7c987",
    "createdAt": "2019-11-15T10:22:27Z",
    "diffHunk": "@@ -98,22 +96,21 @@ sealed trait V1FallbackWriters extends SupportsV1Write {\n   }\n \n   protected def newWriteBuilder(): V1WriteBuilder = {\n-    val writeBuilder = table.newWriteBuilder(writeOptions)\n-      .withInputDataSchema(plan.schema)\n-      .withQueryId(UUID.randomUUID().toString)\n+    val writeInfo = LogicalWriteInfoImpl(\n+      queryId = UUID.randomUUID().toString,\n+      schema = query.schema)\n+    val writeBuilder = table.newWriteBuilder(writeOptions, writeInfo)\n+\n     writeBuilder.asV1Builder\n   }\n }\n \n /**\n  * A trait that allows Tables that use V1 Writer interfaces to append data.\n  */\n-trait SupportsV1Write extends SparkPlan {\n-  // TODO: We should be able to work on SparkPlans at this point.\n-  def plan: LogicalPlan\n-\n+trait SupportsV1Write extends SparkPlan with WriteBase {\n   protected def writeWithV1(relation: InsertableRelation): RDD[InternalRow] = {\n-    relation.insert(Dataset.ofRows(sqlContext.sparkSession, plan), overwrite = false)\n+    relation.insert(sqlContext.internalCreateDataFrame(rdd, query.schema), overwrite = false)"
  }],
  "prId": 25990
}]