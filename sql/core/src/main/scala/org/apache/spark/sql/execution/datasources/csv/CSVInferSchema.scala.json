[{
  "comments": [{
    "author": {
      "login": "xwu0226"
    },
    "body": "This method is used in both `csv.DefaultSource` and `DataFrameReader.csv(ds: Dataset[String])`. So I refactored it here to take care both the default schema type and `inferSchemaFlag=true` cases.\n",
    "commit": "35d11806765a706859fcac8d9ec3af742341a0cc",
    "createdAt": "2016-05-26T05:56:48Z",
    "diffHunk": "@@ -42,16 +42,23 @@ private[csv] object CSVInferSchema {\n       tokenRdd: RDD[Array[String]],\n       header: Array[String],\n       options: CSVOptions): StructType = {\n-    val startType: Array[DataType] = Array.fill[DataType](header.length)(NullType)\n-    val rootTypes: Array[DataType] =\n-      tokenRdd.aggregate(startType)(inferRowType(options), mergeRowTypes)\n+    val structFields = if (options.inferSchemaFlag) {",
    "line": 16
  }],
  "prId": 13300
}]