[{
  "comments": [{
    "author": {
      "login": "srowen"
    },
    "body": "Briefly, why do we need this? I imagine you explained elsewhere and I've missed it.",
    "commit": "3e51b923d76fff7d69386d98b7e0f24dfd0e2390",
    "createdAt": "2019-03-21T15:52:55Z",
    "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.orc\n+\n+import java.sql.Date\n+\n+import org.apache.orc.storage.common.`type`.HiveDecimal\n+import org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch\n+import org.apache.orc.storage.ql.io.sarg.{SearchArgument => OrcSearchArgument}\n+import org.apache.orc.storage.ql.io.sarg.PredicateLeaf.{Operator => OrcOperator}\n+import org.apache.orc.storage.serde2.io.{DateWritable, HiveDecimalWritable}\n+\n+import org.apache.spark.sql.catalyst.expressions.SpecializedGetters\n+import org.apache.spark.sql.types.Decimal\n+\n+/**\n+ * Various utilities for ORC used to upgrade the built-in Hive.\n+ */\n+private[sql] object OrcShimUtils {\n+\n+  class VectorizedRowBatchWrap(val batch: VectorizedRowBatch) {}",
    "line": 36
  }, {
    "author": {
      "login": "wangyum"
    },
    "body": "To reduce code duplication of `OrcColumnarBatchReader`. \r\nBefore this change. We need to copy `OrcColumnarBatchReader` for Hive 2.3.4 because of `org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch` from different packages:\r\n![image](https://user-images.githubusercontent.com/5399861/54798190-70a04a80-4c92-11e9-9959-5821b79d2a92.png)\r\n\r\nAfter this change. We don't need to copy `OrcColumnarBatchReader`. just copy `OrcShimUtils` for Hive 2.3.4:\r\n![image](https://user-images.githubusercontent.com/5399861/54798263-d12f8780-4c92-11e9-9d5d-147dfe77853f.png)\r\n\r\n",
    "commit": "3e51b923d76fff7d69386d98b7e0f24dfd0e2390",
    "createdAt": "2019-03-22T03:17:01Z",
    "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.orc\n+\n+import java.sql.Date\n+\n+import org.apache.orc.storage.common.`type`.HiveDecimal\n+import org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch\n+import org.apache.orc.storage.ql.io.sarg.{SearchArgument => OrcSearchArgument}\n+import org.apache.orc.storage.ql.io.sarg.PredicateLeaf.{Operator => OrcOperator}\n+import org.apache.orc.storage.serde2.io.{DateWritable, HiveDecimalWritable}\n+\n+import org.apache.spark.sql.catalyst.expressions.SpecializedGetters\n+import org.apache.spark.sql.types.Decimal\n+\n+/**\n+ * Various utilities for ORC used to upgrade the built-in Hive.\n+ */\n+private[sql] object OrcShimUtils {\n+\n+  class VectorizedRowBatchWrap(val batch: VectorizedRowBatch) {}",
    "line": 36
  }],
  "prId": 24166
}, {
  "comments": [{
    "author": {
      "login": "wangyum"
    },
    "body": "Add these two type aliases to avoid copying `OrcV1FilterSuite` for Hive 2.3.4.",
    "commit": "3e51b923d76fff7d69386d98b7e0f24dfd0e2390",
    "createdAt": "2019-03-22T03:21:15Z",
    "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.orc\n+\n+import java.sql.Date\n+\n+import org.apache.orc.storage.common.`type`.HiveDecimal\n+import org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch\n+import org.apache.orc.storage.ql.io.sarg.{SearchArgument => OrcSearchArgument}\n+import org.apache.orc.storage.ql.io.sarg.PredicateLeaf.{Operator => OrcOperator}\n+import org.apache.orc.storage.serde2.io.{DateWritable, HiveDecimalWritable}\n+\n+import org.apache.spark.sql.catalyst.expressions.SpecializedGetters\n+import org.apache.spark.sql.types.Decimal\n+\n+/**\n+ * Various utilities for ORC used to upgrade the built-in Hive.\n+ */\n+private[sql] object OrcShimUtils {\n+\n+  class VectorizedRowBatchWrap(val batch: VectorizedRowBatch) {}\n+\n+  private[sql] type Operator = OrcOperator\n+  private[sql] type SearchArgument = OrcSearchArgument",
    "line": 39
  }],
  "prId": 24166
}, {
  "comments": [{
    "author": {
      "login": "wangyum"
    },
    "body": "The below functions to avoid copying  `OrcDeserializer` and `OrcSerializer` for Hive 2.3.4.",
    "commit": "3e51b923d76fff7d69386d98b7e0f24dfd0e2390",
    "createdAt": "2019-03-22T03:22:22Z",
    "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.orc\n+\n+import java.sql.Date\n+\n+import org.apache.orc.storage.common.`type`.HiveDecimal\n+import org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch\n+import org.apache.orc.storage.ql.io.sarg.{SearchArgument => OrcSearchArgument}\n+import org.apache.orc.storage.ql.io.sarg.PredicateLeaf.{Operator => OrcOperator}\n+import org.apache.orc.storage.serde2.io.{DateWritable, HiveDecimalWritable}\n+\n+import org.apache.spark.sql.catalyst.expressions.SpecializedGetters\n+import org.apache.spark.sql.types.Decimal\n+\n+/**\n+ * Various utilities for ORC used to upgrade the built-in Hive.\n+ */\n+private[sql] object OrcShimUtils {\n+\n+  class VectorizedRowBatchWrap(val batch: VectorizedRowBatch) {}\n+\n+  private[sql] type Operator = OrcOperator\n+  private[sql] type SearchArgument = OrcSearchArgument\n+\n+  def getSqlDate(value: Any): Date = value.asInstanceOf[DateWritable].get",
    "line": 41
  }],
  "prId": 24166
}, {
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "not a big deal but just leave a note for the future, `private[sql]` should be removed if that's under `execution` package per SPARK-16964",
    "commit": "3e51b923d76fff7d69386d98b7e0f24dfd0e2390",
    "createdAt": "2019-03-26T00:41:43Z",
    "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.execution.datasources.orc\n+\n+import java.sql.Date\n+\n+import org.apache.orc.storage.common.`type`.HiveDecimal\n+import org.apache.orc.storage.ql.exec.vector.VectorizedRowBatch\n+import org.apache.orc.storage.ql.io.sarg.{SearchArgument => OrcSearchArgument}\n+import org.apache.orc.storage.ql.io.sarg.PredicateLeaf.{Operator => OrcOperator}\n+import org.apache.orc.storage.serde2.io.{DateWritable, HiveDecimalWritable}\n+\n+import org.apache.spark.sql.catalyst.expressions.SpecializedGetters\n+import org.apache.spark.sql.types.Decimal\n+\n+/**\n+ * Various utilities for ORC used to upgrade the built-in Hive.\n+ */\n+private[sql] object OrcShimUtils {",
    "line": 34
  }],
  "prId": 24166
}]