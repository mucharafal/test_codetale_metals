[{
  "comments": [{
    "author": {
      "login": "hvanhovell"
    },
    "body": "This looks very similar to `DefaultSource.inferSchema` why not move the common functionality  into a single method?\n",
    "commit": "7abdfc111166f2bf275fc4318c0ffe8836dcbb70",
    "createdAt": "2016-04-27T13:40:11Z",
    "diffHunk": "@@ -30,22 +30,37 @@ import org.apache.spark.sql.catalyst.util.DateTimeUtils\n import org.apache.spark.sql.types._\n import org.apache.spark.unsafe.types.UTF8String\n \n-private[csv] object CSVInferSchema {\n+private[csv] object InferSchema {\n \n   /**\n    * Similar to the JSON schema inference\n    *     1. Infer type of each row\n    *     2. Merge row types to find common type\n    *     3. Replace any null types with string type\n    */\n-  def infer(\n-      tokenRdd: RDD[Array[String]],\n-      header: Array[String],\n-      nullValue: String = \"\"): StructType = {\n+  def infer(csv: RDD[String], options: CSVOptions): StructType = {"
  }, {
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "Actually, it does call this method in `DefaultSource.inferSchema`. I intentionally made the same structure with `JSONRelation`. JSON data source also have the class with the same name and same method in order to fix issues easily in the future together . (Actually, the main purpose for refactoring this is consistency of structures. They could have almost identical structures).\n",
    "commit": "7abdfc111166f2bf275fc4318c0ffe8836dcbb70",
    "createdAt": "2016-04-28T00:22:16Z",
    "diffHunk": "@@ -30,22 +30,37 @@ import org.apache.spark.sql.catalyst.util.DateTimeUtils\n import org.apache.spark.sql.types._\n import org.apache.spark.unsafe.types.UTF8String\n \n-private[csv] object CSVInferSchema {\n+private[csv] object InferSchema {\n \n   /**\n    * Similar to the JSON schema inference\n    *     1. Infer type of each row\n    *     2. Merge row types to find common type\n    *     3. Replace any null types with string type\n    */\n-  def infer(\n-      tokenRdd: RDD[Array[String]],\n-      header: Array[String],\n-      nullValue: String = \"\"): StructType = {\n+  def infer(csv: RDD[String], options: CSVOptions): StructType = {"
  }],
  "prId": 12268
}]