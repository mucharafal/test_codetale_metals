[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "it's a little different from what it was. Previously we don't set default serde at [parser](https://github.com/apache/spark/pull/16296/files#diff-1bb4f7bd5a2656f48bcd3c857167a11bL1069), but set it during [analysis](https://github.com/apache/spark/pull/16296/files#diff-c4ed9859978dd6ac271b6a40ee945e4bL54). However, this doesn't make sense and I think we should just provide the default serde at the beginning.",
    "commit": "08ec4a7e0d4d25da2e5c40fbf497ce7d067a82c5",
    "createdAt": "2017-01-05T12:32:47Z",
    "diffHunk": "@@ -77,4 +79,16 @@ object HiveSerDe {\n \n     serdeMap.get(key)\n   }\n+\n+  def getDefaultStorage(conf: SQLConf): CatalogStorageFormat = {\n+    val defaultStorageType = conf.getConfString(\"hive.default.fileformat\", \"textfile\")\n+    val defaultHiveSerde = sourceToSerDe(defaultStorageType)\n+    CatalogStorageFormat.empty.copy(\n+      inputFormat = defaultHiveSerde.flatMap(_.inputFormat)\n+        .orElse(Some(\"org.apache.hadoop.mapred.TextInputFormat\")),\n+      outputFormat = defaultHiveSerde.flatMap(_.outputFormat)\n+        .orElse(Some(\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\")),\n+      serde = defaultHiveSerde.flatMap(_.serde)\n+        .orElse(Some(\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\")))",
    "line": 106
  }, {
    "author": {
      "login": "yhuai"
    },
    "body": "Does this version break any test?",
    "commit": "08ec4a7e0d4d25da2e5c40fbf497ce7d067a82c5",
    "createdAt": "2017-01-06T00:58:20Z",
    "diffHunk": "@@ -77,4 +79,16 @@ object HiveSerDe {\n \n     serdeMap.get(key)\n   }\n+\n+  def getDefaultStorage(conf: SQLConf): CatalogStorageFormat = {\n+    val defaultStorageType = conf.getConfString(\"hive.default.fileformat\", \"textfile\")\n+    val defaultHiveSerde = sourceToSerDe(defaultStorageType)\n+    CatalogStorageFormat.empty.copy(\n+      inputFormat = defaultHiveSerde.flatMap(_.inputFormat)\n+        .orElse(Some(\"org.apache.hadoop.mapred.TextInputFormat\")),\n+      outputFormat = defaultHiveSerde.flatMap(_.outputFormat)\n+        .orElse(Some(\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\")),\n+      serde = defaultHiveSerde.flatMap(_.serde)\n+        .orElse(Some(\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\")))",
    "line": 106
  }, {
    "author": {
      "login": "cloud-fan"
    },
    "body": "no, because they are same fundamentally.",
    "commit": "08ec4a7e0d4d25da2e5c40fbf497ce7d067a82c5",
    "createdAt": "2017-01-06T01:02:37Z",
    "diffHunk": "@@ -77,4 +79,16 @@ object HiveSerDe {\n \n     serdeMap.get(key)\n   }\n+\n+  def getDefaultStorage(conf: SQLConf): CatalogStorageFormat = {\n+    val defaultStorageType = conf.getConfString(\"hive.default.fileformat\", \"textfile\")\n+    val defaultHiveSerde = sourceToSerDe(defaultStorageType)\n+    CatalogStorageFormat.empty.copy(\n+      inputFormat = defaultHiveSerde.flatMap(_.inputFormat)\n+        .orElse(Some(\"org.apache.hadoop.mapred.TextInputFormat\")),\n+      outputFormat = defaultHiveSerde.flatMap(_.outputFormat)\n+        .orElse(Some(\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\")),\n+      serde = defaultHiveSerde.flatMap(_.serde)\n+        .orElse(Some(\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\")))",
    "line": 106
  }],
  "prId": 16296
}]