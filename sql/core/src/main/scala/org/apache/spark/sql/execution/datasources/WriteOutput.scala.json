[{
  "comments": [{
    "author": {
      "login": "davies"
    },
    "body": "partitionStr  => partitionPath ?\n",
    "commit": "4d967251ce01794f7cdab9f84b70fa5393d1d1f2",
    "createdAt": "2016-10-27T23:04:48Z",
    "diffHunk": "@@ -386,13 +390,18 @@ object WriteOutput extends Logging {\n           logDebug(s\"Writing partition: $currentKey\")\n \n           currentWriter = newOutputWriter(currentKey, getPartitionString)\n+          val partitionStr = getPartitionString(currentKey).getString(0)"
  }, {
    "author": {
      "login": "ericl"
    },
    "body": "Done\n",
    "commit": "4d967251ce01794f7cdab9f84b70fa5393d1d1f2",
    "createdAt": "2016-10-28T00:53:39Z",
    "diffHunk": "@@ -386,13 +390,18 @@ object WriteOutput extends Logging {\n           logDebug(s\"Writing partition: $currentKey\")\n \n           currentWriter = newOutputWriter(currentKey, getPartitionString)\n+          val partitionStr = getPartitionString(currentKey).getString(0)"
  }],
  "prId": 15633
}, {
  "comments": [{
    "author": {
      "login": "davies"
    },
    "body": "In case of bucketing, There are multiple files (writer) per partition, so partitionPath will have duplicated value, should we use Set[String] here?\n",
    "commit": "4d967251ce01794f7cdab9f84b70fa5393d1d1f2",
    "createdAt": "2016-10-27T23:07:31Z",
    "diffHunk": "@@ -375,6 +378,7 @@ object WriteOutput extends Logging {\n \n       // If anything below fails, we should abort the task.\n       var currentKey: UnsafeRow = null\n+      var updatedPartitions: List[String] = Nil"
  }, {
    "author": {
      "login": "ericl"
    },
    "body": "Done\n",
    "commit": "4d967251ce01794f7cdab9f84b70fa5393d1d1f2",
    "createdAt": "2016-10-28T00:53:37Z",
    "diffHunk": "@@ -375,6 +378,7 @@ object WriteOutput extends Logging {\n \n       // If anything below fails, we should abort the task.\n       var currentKey: UnsafeRow = null\n+      var updatedPartitions: List[String] = Nil"
  }],
  "prId": 15633
}]