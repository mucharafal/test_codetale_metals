[{
  "comments": [{
    "author": {
      "login": "gatorsmile"
    },
    "body": "Could we also add one more check for another API `externalCatalog.getTable(\"db1\", \"hive_tbl\")`? The provider should contain `DDLUtils.HIVE_PROVIDER`",
    "commit": "00bdeff05faf542631d03c939f05842fbe89b71e",
    "createdAt": "2016-12-01T23:19:11Z",
    "diffHunk": "@@ -52,4 +54,18 @@ class HiveExternalCatalogSuite extends ExternalCatalogSuite {\n     assert(selectedPartitions.length == 1)\n     assert(selectedPartitions.head.spec == part1.spec)\n   }\n+\n+  test(\"SPARK-18647: do not put provider in table properties for Hive serde table\") {\n+    val catalog = newBasicCatalog()\n+    val hiveTable = CatalogTable(\n+      identifier = TableIdentifier(\"hive_tbl\", Some(\"db1\")),\n+      tableType = CatalogTableType.MANAGED,\n+      storage = storageFormat,\n+      schema = new StructType().add(\"col1\", \"int\").add(\"col2\", \"string\"),\n+      provider = Some(\"hive\"))\n+    catalog.createTable(hiveTable, ignoreIfExists = false)\n+\n+    val rawTable = externalCatalog.client.getTable(\"db1\", \"hive_tbl\")",
    "line": 27
  }],
  "prId": 16080
}]