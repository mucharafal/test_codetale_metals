[{
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "nit: `${notExistsPath}` -> `$notExistsPath `",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T06:04:00Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "OK, I have adjust it.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T08:20:15Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")"
  }],
  "prId": 23841
}, {
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "ditto",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T06:04:07Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "OK, I have adjust it.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T08:20:27Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'"
  }],
  "prId": 23841
}, {
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "ditto",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T06:04:17Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'\n+           |STORED AS orc\n+           |SELECT * FROM src where key < 10\n+         \"\"\".stripMargin)\n+\n+      // use orc data source to check the data of path is right.\n+      withTempView(\"orc_source\") {\n+        sql(\n+          s\"\"\"\n+             |CREATE TEMPORARY VIEW orc_source\n+             |USING org.apache.spark.sql.hive.orc\n+             |OPTIONS (\n+             |  PATH '${notExistsPath}'"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "OK, I have adjust it.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T08:20:34Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'\n+           |STORED AS orc\n+           |SELECT * FROM src where key < 10\n+         \"\"\".stripMargin)\n+\n+      // use orc data source to check the data of path is right.\n+      withTempView(\"orc_source\") {\n+        sql(\n+          s\"\"\"\n+             |CREATE TEMPORARY VIEW orc_source\n+             |USING org.apache.spark.sql.hive.orc\n+             |OPTIONS (\n+             |  PATH '${notExistsPath}'"
  }],
  "prId": 23841
}, {
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "You should set literals in the expected answer.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T06:06:00Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'\n+           |STORED AS orc\n+           |SELECT * FROM src where key < 10\n+         \"\"\".stripMargin)\n+\n+      // use orc data source to check the data of path is right.\n+      withTempView(\"orc_source\") {\n+        sql(\n+          s\"\"\"\n+             |CREATE TEMPORARY VIEW orc_source\n+             |USING org.apache.spark.sql.hive.orc\n+             |OPTIONS (\n+             |  PATH '${notExistsPath}'\n+             |)\n+           \"\"\".stripMargin)\n+\n+        checkAnswer(\n+          sql(\"select * from orc_source\"),\n+          sql(\"select * from src where key < 10\"))"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "These code refers to the writing of other UT.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T08:22:13Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {\n+    withTempDir { dir =>\n+      val path = dir.toURI.getPath\n+      val notExistsPath = s\"${path}/src/result\"\n+\n+      sql(s\"INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}' SELECT * FROM src where key < 10\")\n+\n+      sql(\n+        s\"\"\"\n+           |INSERT OVERWRITE LOCAL DIRECTORY '${notExistsPath}'\n+           |STORED AS orc\n+           |SELECT * FROM src where key < 10\n+         \"\"\".stripMargin)\n+\n+      // use orc data source to check the data of path is right.\n+      withTempView(\"orc_source\") {\n+        sql(\n+          s\"\"\"\n+             |CREATE TEMPORARY VIEW orc_source\n+             |USING org.apache.spark.sql.hive.orc\n+             |OPTIONS (\n+             |  PATH '${notExistsPath}'\n+             |)\n+           \"\"\".stripMargin)\n+\n+        checkAnswer(\n+          sql(\"select * from orc_source\"),\n+          sql(\"select * from src where key < 10\"))"
  }],
  "prId": 23841
}, {
  "comments": [{
    "author": {
      "login": "maropu"
    },
    "body": "What's the difference from the `\"insert overwrite to not exist local dir\"` test?",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T06:34:32Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "One is used for test result correct or not, another is used for test the not exist path created or not.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T08:23:36Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {"
  }, {
    "author": {
      "login": "maropu"
    },
    "body": "Can you gather into a single test?",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-26T13:20:58Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {"
  }, {
    "author": {
      "login": "beliefer"
    },
    "body": "Yes,I can remove \"insert overwrite to not exist local dir\" test and retain another.",
    "commit": "0913a45ac701b99fc1c8d8e556646a45f30c330f",
    "createdAt": "2019-02-27T01:49:10Z",
    "diffHunk": "@@ -581,6 +581,38 @@ class InsertSuite extends QueryTest with TestHiveSingleton with BeforeAndAfter\n     }\n   }\n \n+  test(\"insert overwrite to not exists dir from hive metastore table\") {"
  }],
  "prId": 23841
}]