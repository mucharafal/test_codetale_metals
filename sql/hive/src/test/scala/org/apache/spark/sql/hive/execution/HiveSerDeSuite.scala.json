[{
  "comments": [{
    "author": {
      "login": "yhuai"
    },
    "body": "drop it in `afterAll`?\n",
    "commit": "0be05f7e83f6e9617b738f307428c12263718c8c",
    "createdAt": "2015-02-26T01:37:30Z",
    "diffHunk": "@@ -25,17 +25,24 @@ import org.apache.spark.sql.hive.test.TestHive\n  * A set of tests that validates support for Hive SerDe.\n  */\n class HiveSerDeSuite extends HiveComparisonTest with BeforeAndAfterAll {\n-\n   override def beforeAll() = {\n+    import TestHive._\n+    import org.apache.hadoop.hive.serde2.RegexSerDe\n     TestHive.cacheTables = false\n+    sql(s\"\"\"CREATE TABLE IF NOT EXISTS sales (key STRING, value INT)\n+       |ROW FORMAT SERDE '${classOf[RegexSerDe].getCanonicalName}'\n+       |WITH SERDEPROPERTIES (\"input.regex\" = \"([^ ]*)\\t([^ ]*)\")\n+       \"\"\".stripMargin)\n+    sql(s\"LOAD DATA LOCAL INPATH '${getHiveFile(\"data/files/sales.txt\")}' INTO TABLE sales\")",
    "line": 15
  }, {
    "author": {
      "login": "chenghao-intel"
    },
    "body": "Thank you @yhuai for noticing this, actually the `createQueryTest` will clean the table by default (as the second argument `reset=true` by default). And that's also why I moved ahead for the test `Read with RegexSerDe`.\n",
    "commit": "0be05f7e83f6e9617b738f307428c12263718c8c",
    "createdAt": "2015-03-08T04:48:51Z",
    "diffHunk": "@@ -25,17 +25,24 @@ import org.apache.spark.sql.hive.test.TestHive\n  * A set of tests that validates support for Hive SerDe.\n  */\n class HiveSerDeSuite extends HiveComparisonTest with BeforeAndAfterAll {\n-\n   override def beforeAll() = {\n+    import TestHive._\n+    import org.apache.hadoop.hive.serde2.RegexSerDe\n     TestHive.cacheTables = false\n+    sql(s\"\"\"CREATE TABLE IF NOT EXISTS sales (key STRING, value INT)\n+       |ROW FORMAT SERDE '${classOf[RegexSerDe].getCanonicalName}'\n+       |WITH SERDEPROPERTIES (\"input.regex\" = \"([^ ]*)\\t([^ ]*)\")\n+       \"\"\".stripMargin)\n+    sql(s\"LOAD DATA LOCAL INPATH '${getHiveFile(\"data/files/sales.txt\")}' INTO TABLE sales\")",
    "line": 15
  }],
  "prId": 4506
}]