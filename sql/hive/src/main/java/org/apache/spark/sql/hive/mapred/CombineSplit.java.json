[{
  "comments": [{
    "author": {
      "login": "chenghao-intel"
    },
    "body": "Can you add a comment says, we only process combination within a single table partition, so all of the class name of the splits should be exactly the identical.\n\nNit: Writing the split class name in the very beginning? Instead of after all of the location info.\n",
    "commit": "085ce5feca2294f81f9ec7a5660635be13c70a4a",
    "createdAt": "2015-10-16T01:04:37Z",
    "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.hive.mapred;\n+\n+import java.io.DataInput;\n+import java.io.DataOutput;\n+import java.io.IOException;\n+\n+import org.apache.hadoop.io.Writable;\n+import org.apache.hadoop.io.WritableFactories;\n+import org.apache.hadoop.mapred.InputSplit;\n+\n+public class CombineSplit implements InputSplit {\n+  private InputSplit[] splits;\n+  private long totalLen;\n+  private String[] locations;\n+\n+  public CombineSplit() {\n+  }\n+\n+  public CombineSplit(InputSplit[] ss, long totalLen, String[] locations) {\n+    splits = ss;\n+    this.totalLen = totalLen;\n+    this.locations = locations;\n+  }\n+\n+  public InputSplit getSplit(int idx) {\n+    return splits[idx];\n+  }\n+\n+  public int getSplitNum() {\n+    return splits.length;\n+  }\n+\n+  @Override\n+  public long getLength() {\n+    return totalLen;\n+  }\n+\n+  @Override\n+  public String[] getLocations() throws IOException {\n+    return locations;\n+  }\n+\n+  @Override\n+  public void write(DataOutput out) throws IOException {\n+    out.writeLong(totalLen);\n+    out.writeInt(locations.length);\n+    for (String location : locations) {\n+      out.writeUTF(location);\n+    }\n+    out.writeInt(splits.length);\n+    out.writeUTF(splits[0].getClass().getCanonicalName());"
  }],
  "prId": 9097
}, {
  "comments": [{
    "author": {
      "login": "liancheng"
    },
    "body": "Please add a comment here to point out which version of Hive/Hadoop this implementation is based on.\n",
    "commit": "085ce5feca2294f81f9ec7a5660635be13c70a4a",
    "createdAt": "2016-02-02T00:16:36Z",
    "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.spark.sql.hive.mapred;\n+\n+import java.io.DataInput;\n+import java.io.DataOutput;\n+import java.io.IOException;\n+\n+import org.apache.hadoop.io.Writable;\n+import org.apache.hadoop.io.WritableFactories;\n+import org.apache.hadoop.mapred.InputSplit;\n+\n+public class CombineSplit implements InputSplit {"
  }],
  "prId": 9097
}]