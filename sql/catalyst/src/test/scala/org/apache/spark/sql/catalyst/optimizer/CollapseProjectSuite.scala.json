[{
  "comments": [{
    "author": {
      "login": "liancheng"
    },
    "body": "Would be nice to add one more test case that contains common non-deterministic fields.\n",
    "commit": "a44b962d440bae4a34f8e45f5f207464b482be3d",
    "createdAt": "2016-03-22T15:04:21Z",
    "diffHunk": "@@ -95,4 +95,17 @@ class CollapseProjectSuite extends PlanTest {\n \n     comparePlans(optimized, correctAnswer)\n   }\n+\n+  test(\"collapse project into aggregate\") {\n+    val query = testRelation\n+      .groupBy('a, 'b)(('a + 1).as('a_plus_1), 'b)\n+      .select('a_plus_1, ('b + 1).as('b_plus_1))\n+\n+    val optimized = Optimize.execute(query.analyze)\n+\n+    val correctAnswer = testRelation\n+      .groupBy('a, 'b)(('a + 1).as('a_plus_1), ('b + 1).as('b_plus_1)).analyze\n+\n+    comparePlans(optimized, correctAnswer)\n+  }",
    "line": 25
  }, {
    "author": {
      "login": "gatorsmile"
    },
    "body": "Sure, will do it. \n",
    "commit": "a44b962d440bae4a34f8e45f5f207464b482be3d",
    "createdAt": "2016-03-22T23:30:13Z",
    "diffHunk": "@@ -95,4 +95,17 @@ class CollapseProjectSuite extends PlanTest {\n \n     comparePlans(optimized, correctAnswer)\n   }\n+\n+  test(\"collapse project into aggregate\") {\n+    val query = testRelation\n+      .groupBy('a, 'b)(('a + 1).as('a_plus_1), 'b)\n+      .select('a_plus_1, ('b + 1).as('b_plus_1))\n+\n+    val optimized = Optimize.execute(query.analyze)\n+\n+    val correctAnswer = testRelation\n+      .groupBy('a, 'b)(('a + 1).as('a_plus_1), ('b + 1).as('b_plus_1)).analyze\n+\n+    comparePlans(optimized, correctAnswer)\n+  }",
    "line": 25
  }],
  "prId": 11427
}]