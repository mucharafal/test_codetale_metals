[{
  "comments": [{
    "author": {
      "login": "HyukjinKwon"
    },
    "body": "@MaxGekk, there's `UnivocityParserSuite`.",
    "commit": "521bd45c95f56d5bff3656d0af018f963c524605",
    "createdAt": "2018-11-11T11:51:34Z",
    "diffHunk": "@@ -226,4 +227,17 @@ class CsvExpressionsSuite extends SparkFunSuite with ExpressionEvalHelper with P\n         InternalRow(17836)) // number of days from 1970-01-01\n     }\n   }\n+\n+  test(\"parse decimals using locale\") {\n+    Seq(\"en-US\", \"ko-KR\", \"ru-RU\", \"de-DE\").foreach { langTag =>\n+      val schema = new StructType().add(\"d\", DecimalType(10, 5))\n+      val options = Map(\"locale\" -> langTag, \"sep\" -> \"|\")\n+      val expected = Decimal(1000.001, 10, 5)\n+      val df = new DecimalFormat(\"\", new DecimalFormatSymbols(Locale.forLanguageTag(langTag)))\n+      val input = df.format(expected.toBigDecimal)\n+      checkEvaluation(\n+        CsvToStructs(schema, options, Literal.create(input), gmtId),\n+        InternalRow(expected))\n+    }\n+  }"
  }],
  "prId": 22979
}]