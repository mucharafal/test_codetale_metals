[{
  "comments": [{
    "author": {
      "login": "cloud-fan"
    },
    "body": "the non-deterministic expression shouldn't be pushed.\n",
    "commit": "71a83173cad945a087626c583496192f9fb482c3",
    "createdAt": "2016-04-13T04:51:48Z",
    "diffHunk": "@@ -681,4 +679,67 @@ class FilterPushdownSuite extends PlanTest {\n \n     comparePlans(optimized, correctAnswer)\n   }\n+\n+  test(\"broadcast hint\") {\n+    val originalQuery = BroadcastHint(testRelation)\n+      .where('a === 2L && 'b + Rand(10).as(\"rnd\") === 3)\n+\n+    val optimized = Optimize.execute(originalQuery.analyze)\n+\n+    val correctAnswer = BroadcastHint(testRelation.where('a === 2L))\n+      .where('b + Rand(10).as(\"rnd\") === 3)\n+      .analyze\n+\n+    comparePlans(optimized, correctAnswer)\n+  }\n+\n+  test(\"union\") {\n+    val testRelation2 = LocalRelation('d.int, 'e.int, 'f.int)\n+\n+    val originalQuery = Union(Seq(testRelation, testRelation2))\n+      .where('a === 2L && 'b + Rand(10).as(\"rnd\") === 3)\n+\n+    val optimized = Optimize.execute(originalQuery.analyze)\n+\n+    val correctAnswer = Union(Seq(\n+      testRelation.where('a === 2L && 'b + Rand(10).as(\"rnd\") === 3),"
  }],
  "prId": 12342
}]