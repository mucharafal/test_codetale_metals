[{
  "comments": [{
    "author": {
      "login": "viirya"
    },
    "body": "Besides unit tests, can you also add the tests on encoding `ScroogeLikeExample` in Dataset?",
    "commit": "04a34c4ee7c43120721659713fb8024e90282a0c",
    "createdAt": "2018-11-18T15:23:53Z",
    "diffHunk": "@@ -410,6 +410,16 @@ class ObjectExpressionsSuite extends SparkFunSuite with ExpressionEvalHelper {\n       dataType = ObjectType(classOf[outerObj.Inner]),\n       outerPointer = Some(() => outerObj))\n     checkObjectExprEvaluation(newInst2, new outerObj.Inner(1))\n+\n+    // SPARK-8288 Test\n+    import org.apache.spark.sql.catalyst.ScroogeLikeExample\n+    val newInst3 = NewInstance(\n+      cls = classOf[ScroogeLikeExample],\n+      arguments = Literal(1) :: Nil,\n+      propagateNull = false,\n+      dataType = ObjectType(classOf[ScroogeLikeExample]),\n+      outerPointer = Some(() => outerObj))\n+    checkObjectExprEvaluation(newInst3, ScroogeLikeExample(1))",
    "line": 20
  }, {
    "author": {
      "login": "drewrobb"
    },
    "body": "Thanks, that is a great tip-- I was looking for the place to place tests like this. Upon starting to add them I uncovered a few more code paths that my ScroogeExample didn't work with (because the trait was missing methods that actual scrooge code had to access member elements), so I fixed that also.",
    "commit": "04a34c4ee7c43120721659713fb8024e90282a0c",
    "createdAt": "2018-11-20T00:09:52Z",
    "diffHunk": "@@ -410,6 +410,16 @@ class ObjectExpressionsSuite extends SparkFunSuite with ExpressionEvalHelper {\n       dataType = ObjectType(classOf[outerObj.Inner]),\n       outerPointer = Some(() => outerObj))\n     checkObjectExprEvaluation(newInst2, new outerObj.Inner(1))\n+\n+    // SPARK-8288 Test\n+    import org.apache.spark.sql.catalyst.ScroogeLikeExample\n+    val newInst3 = NewInstance(\n+      cls = classOf[ScroogeLikeExample],\n+      arguments = Literal(1) :: Nil,\n+      propagateNull = false,\n+      dataType = ObjectType(classOf[ScroogeLikeExample]),\n+      outerPointer = Some(() => outerObj))\n+    checkObjectExprEvaluation(newInst3, ScroogeLikeExample(1))",
    "line": 20
  }],
  "prId": 23062
}]