[{
  "comments": [{
    "author": {
      "login": "marmbrus"
    },
    "body": "`does not support to process` is a little hard to parse.  Maybe `Unable to convert column ${name} of type ${dataType.simpleString} to JSON.`\n",
    "commit": "971d1c0c134bd721f985480aa3274d8bd9b9a72c",
    "createdAt": "2016-10-27T00:40:07Z",
    "diffHunk": "@@ -29,4 +31,28 @@ object JacksonUtils {\n       case x => x != stopOn\n     }\n   }\n+\n+  /**\n+   * Verify if the schema is supported in JSON parsing.\n+   */\n+  def verifySchema(schema: StructType): Unit = {\n+    def verifyType(dataType: DataType): Unit = dataType match {\n+      case NullType | BooleanType | ByteType | ShortType | IntegerType | LongType | FloatType |\n+           DoubleType | StringType | TimestampType | DateType | BinaryType | _: DecimalType =>\n+\n+      case st: StructType => st.map(_.dataType).foreach(verifyType)\n+\n+      case at: ArrayType => verifyType(at.elementType)\n+\n+      case mt: MapType => verifyType(mt.keyType)\n+\n+      case udt: UserDefinedType[_] => verifyType(udt.sqlType)\n+\n+      case _ =>\n+        throw new UnsupportedOperationException(\n+          s\"JSON conversion does not support to process ${dataType.simpleString} type.\")"
  }],
  "prId": 15354
}]